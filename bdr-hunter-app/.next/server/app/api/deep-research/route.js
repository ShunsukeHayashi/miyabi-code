"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/deep-research/route";
exports.ids = ["app/api/deep-research/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdeep-research%2Froute&page=%2Fapi%2Fdeep-research%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdeep-research%2Froute.ts&appDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdeep-research%2Froute&page=%2Fapi%2Fdeep-research%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdeep-research%2Froute.ts&appDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_shunsuke_Dev_01_miyabi_core_miyabi_private_bdr_hunter_app_app_api_deep_research_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/deep-research/route.ts */ \"(rsc)/./app/api/deep-research/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/deep-research/route\",\n        pathname: \"/api/deep-research\",\n        filename: \"route\",\n        bundlePath: \"app/api/deep-research/route\"\n    },\n    resolvedPagePath: \"/Users/shunsuke/Dev/01-miyabi/_core/miyabi-private/bdr-hunter-app/app/api/deep-research/route.ts\",\n    nextConfigOutput,\n    userland: _Users_shunsuke_Dev_01_miyabi_core_miyabi_private_bdr_hunter_app_app_api_deep_research_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/deep-research/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZkZWVwLXJlc2VhcmNoJTJGcm91dGUmcGFnZT0lMkZhcGklMkZkZWVwLXJlc2VhcmNoJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZGVlcC1yZXNlYXJjaCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNodW5zdWtlJTJGRGV2JTJGMDEtbWl5YWJpJTJGX2NvcmUlMkZtaXlhYmktcHJpdmF0ZSUyRmJkci1odW50ZXItYXBwJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnNodW5zdWtlJTJGRGV2JTJGMDEtbWl5YWJpJTJGX2NvcmUlMkZtaXlhYmktcHJpdmF0ZSUyRmJkci1odW50ZXItYXBwJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNnRDtBQUM3SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2Jkci1odW50ZXItYXBwLz83OTlhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9zaHVuc3VrZS9EZXYvMDEtbWl5YWJpL19jb3JlL21peWFiaS1wcml2YXRlL2Jkci1odW50ZXItYXBwL2FwcC9hcGkvZGVlcC1yZXNlYXJjaC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZGVlcC1yZXNlYXJjaC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2RlZXAtcmVzZWFyY2hcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2RlZXAtcmVzZWFyY2gvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvc2h1bnN1a2UvRGV2LzAxLW1peWFiaS9fY29yZS9taXlhYmktcHJpdmF0ZS9iZHItaHVudGVyLWFwcC9hcHAvYXBpL2RlZXAtcmVzZWFyY2gvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2RlZXAtcmVzZWFyY2gvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdeep-research%2Froute&page=%2Fapi%2Fdeep-research%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdeep-research%2Froute.ts&appDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/deep-research/route.ts":
/*!****************************************!*\
  !*** ./app/api/deep-research/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   maxDuration: () => (/* binding */ maxDuration)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_deep_research__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/deep-research */ \"(rsc)/./lib/services/deep-research.ts\");\n/* harmony import */ var _lib_db_prisma__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db/prisma */ \"(rsc)/./lib/db/prisma.ts\");\n/**\n * Deep Research API Endpoint\n *\n * Executes agentic deep research on companies using Gemini's\n * Google Search grounding and multi-phase research workflow.\n */ \n\n\nconst maxDuration = 60; // Allow up to 60 seconds for deep research\nasync function POST(request) {\n    console.log(\"[DEEP_RESEARCH_API] Received request\");\n    try {\n        const body = await request.json();\n        const { companyName, companyUrl, analysisId } = body;\n        if (!companyName) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Company name is required\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(`[DEEP_RESEARCH_API] Starting deep research for: ${companyName}`);\n        // Get the deep research service\n        const deepResearchService = (0,_lib_services_deep_research__WEBPACK_IMPORTED_MODULE_1__.getDeepResearchService)();\n        // Execute deep research\n        const researchResult = await deepResearchService.researchCompany(companyName, companyUrl);\n        console.log(`[DEEP_RESEARCH_API] Research complete with ${researchResult.sources.length} sources`);\n        // If an analysis ID was provided, update the analysis with deep research data\n        if (analysisId) {\n            try {\n                await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.analysis.update({\n                    where: {\n                        id: analysisId\n                    },\n                    data: {\n                        deepResearch: JSON.stringify(researchResult),\n                        status: \"completed\",\n                        updatedAt: new Date()\n                    }\n                });\n                console.log(`[DEEP_RESEARCH_API] Updated analysis ${analysisId} with deep research`);\n            } catch (dbError) {\n                console.error(\"[DEEP_RESEARCH_API] Database update error:\", dbError);\n            // Continue even if DB update fails - return the research result\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: researchResult,\n            metadata: {\n                companyName,\n                companyUrl,\n                researchedAt: new Date().toISOString(),\n                sourcesCount: researchResult.sources.length,\n                iterations: researchResult.researchMetadata.iterations,\n                confidenceScore: researchResult.researchMetadata.confidenceScore\n            }\n        });\n    } catch (error) {\n        console.error(\"[DEEP_RESEARCH_API] Error:\", error);\n        const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Deep research failed\",\n            details: errorMessage\n        }, {\n            status: 500\n        });\n    }\n}\n// GET endpoint to check deep research status or retrieve cached results\nasync function GET(request) {\n    const searchParams = request.nextUrl.searchParams;\n    const analysisId = searchParams.get(\"analysisId\");\n    if (!analysisId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Analysis ID is required\"\n        }, {\n            status: 400\n        });\n    }\n    try {\n        const analysis = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.analysis.findUnique({\n            where: {\n                id: analysisId\n            },\n            select: {\n                id: true,\n                companyName: true,\n                deepResearch: true,\n                status: true,\n                updatedAt: true\n            }\n        });\n        if (!analysis) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Analysis not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Prisma returns Json fields as objects, not strings\n        const deepResearchData = analysis.deepResearch || null;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            analysisId: analysis.id,\n            companyName: analysis.companyName,\n            hasDeepResearch: !!deepResearchData,\n            deepResearch: deepResearchData,\n            status: analysis.status,\n            updatedAt: analysis.updatedAt\n        });\n    } catch (error) {\n        console.error(\"[DEEP_RESEARCH_API] GET error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to retrieve deep research data\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2RlZXAtcmVzZWFyY2gvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7Ozs7O0NBS0MsR0FFdUQ7QUFDbUM7QUFDbEQ7QUFFbEMsTUFBTUcsY0FBYyxHQUFHLENBQUMsMkNBQTJDO0FBUW5FLGVBQWVDLEtBQUtDLE9BQW9CO0lBQzdDQyxRQUFRQyxHQUFHLENBQUM7SUFFWixJQUFJO1FBQ0YsTUFBTUMsT0FBNEIsTUFBTUgsUUFBUUksSUFBSTtRQUNwRCxNQUFNLEVBQUVDLFdBQVcsRUFBRUMsVUFBVSxFQUFFQyxVQUFVLEVBQUUsR0FBR0o7UUFFaEQsSUFBSSxDQUFDRSxhQUFhO1lBQ2hCLE9BQU9WLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO2dCQUFFSSxPQUFPO1lBQTJCLEdBQ3BDO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQVIsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0RBQWdELEVBQUVHLFlBQVksQ0FBQztRQUU1RSxnQ0FBZ0M7UUFDaEMsTUFBTUssc0JBQXNCZCxtRkFBc0JBO1FBRWxELHdCQUF3QjtRQUN4QixNQUFNZSxpQkFBc0MsTUFBTUQsb0JBQW9CRSxlQUFlLENBQ25GUCxhQUNBQztRQUdGTCxRQUFRQyxHQUFHLENBQUMsQ0FBQywyQ0FBMkMsRUFBRVMsZUFBZUUsT0FBTyxDQUFDQyxNQUFNLENBQUMsUUFBUSxDQUFDO1FBRWpHLDhFQUE4RTtRQUM5RSxJQUFJUCxZQUFZO1lBQ2QsSUFBSTtnQkFDRixNQUFNVixrREFBTUEsQ0FBQ2tCLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDO29CQUMzQkMsT0FBTzt3QkFBRUMsSUFBSVg7b0JBQVc7b0JBQ3hCWSxNQUFNO3dCQUNKQyxjQUFjQyxLQUFLQyxTQUFTLENBQUNYO3dCQUM3QkYsUUFBUTt3QkFDUmMsV0FBVyxJQUFJQztvQkFDakI7Z0JBQ0Y7Z0JBQ0F2QixRQUFRQyxHQUFHLENBQUMsQ0FBQyxxQ0FBcUMsRUFBRUssV0FBVyxtQkFBbUIsQ0FBQztZQUNyRixFQUFFLE9BQU9rQixTQUFTO2dCQUNoQnhCLFFBQVFPLEtBQUssQ0FBQyw4Q0FBOENpQjtZQUM1RCxnRUFBZ0U7WUFDbEU7UUFDRjtRQUVBLE9BQU85QixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQ3ZCc0IsU0FBUztZQUNUUCxNQUFNUjtZQUNOZ0IsVUFBVTtnQkFDUnRCO2dCQUNBQztnQkFDQXNCLGNBQWMsSUFBSUosT0FBT0ssV0FBVztnQkFDcENDLGNBQWNuQixlQUFlRSxPQUFPLENBQUNDLE1BQU07Z0JBQzNDaUIsWUFBWXBCLGVBQWVxQixnQkFBZ0IsQ0FBQ0QsVUFBVTtnQkFDdERFLGlCQUFpQnRCLGVBQWVxQixnQkFBZ0IsQ0FBQ0MsZUFBZTtZQUNsRTtRQUNGO0lBRUYsRUFBRSxPQUFPekIsT0FBTztRQUNkUCxRQUFRTyxLQUFLLENBQUMsOEJBQThCQTtRQUU1QyxNQUFNMEIsZUFBZTFCLGlCQUFpQjJCLFFBQVEzQixNQUFNNEIsT0FBTyxHQUFHO1FBRTlELE9BQU96QyxxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtZQUNFc0IsU0FBUztZQUNUbEIsT0FBTztZQUNQNkIsU0FBU0g7UUFDWCxHQUNBO1lBQUV6QixRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLHdFQUF3RTtBQUNqRSxlQUFlNkIsSUFBSXRDLE9BQW9CO0lBQzVDLE1BQU11QyxlQUFldkMsUUFBUXdDLE9BQU8sQ0FBQ0QsWUFBWTtJQUNqRCxNQUFNaEMsYUFBYWdDLGFBQWFFLEdBQUcsQ0FBQztJQUVwQyxJQUFJLENBQUNsQyxZQUFZO1FBQ2YsT0FBT1oscURBQVlBLENBQUNTLElBQUksQ0FDdEI7WUFBRUksT0FBTztRQUEwQixHQUNuQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7SUFFQSxJQUFJO1FBQ0YsTUFBTU0sV0FBVyxNQUFNbEIsa0RBQU1BLENBQUNrQixRQUFRLENBQUMyQixVQUFVLENBQUM7WUFDaER6QixPQUFPO2dCQUFFQyxJQUFJWDtZQUFXO1lBQ3hCb0MsUUFBUTtnQkFDTnpCLElBQUk7Z0JBQ0piLGFBQWE7Z0JBQ2JlLGNBQWM7Z0JBQ2RYLFFBQVE7Z0JBQ1JjLFdBQVc7WUFDYjtRQUNGO1FBRUEsSUFBSSxDQUFDUixVQUFVO1lBQ2IsT0FBT3BCLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO2dCQUFFSSxPQUFPO1lBQXFCLEdBQzlCO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxxREFBcUQ7UUFDckQsTUFBTW1DLG1CQUFtQjdCLFNBQVNLLFlBQVksSUFBSTtRQUVsRCxPQUFPekIscURBQVlBLENBQUNTLElBQUksQ0FBQztZQUN2QnNCLFNBQVM7WUFDVG5CLFlBQVlRLFNBQVNHLEVBQUU7WUFDdkJiLGFBQWFVLFNBQVNWLFdBQVc7WUFDakN3QyxpQkFBaUIsQ0FBQyxDQUFDRDtZQUNuQnhCLGNBQWN3QjtZQUNkbkMsUUFBUU0sU0FBU04sTUFBTTtZQUN2QmMsV0FBV1IsU0FBU1EsU0FBUztRQUMvQjtJQUVGLEVBQUUsT0FBT2YsT0FBTztRQUNkUCxRQUFRTyxLQUFLLENBQUMsa0NBQWtDQTtRQUVoRCxPQUFPYixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtZQUFFSSxPQUFPO1FBQXdDLEdBQ2pEO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmRyLWh1bnRlci1hcHAvLi9hcHAvYXBpL2RlZXAtcmVzZWFyY2gvcm91dGUudHM/NThkNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERlZXAgUmVzZWFyY2ggQVBJIEVuZHBvaW50XG4gKlxuICogRXhlY3V0ZXMgYWdlbnRpYyBkZWVwIHJlc2VhcmNoIG9uIGNvbXBhbmllcyB1c2luZyBHZW1pbmknc1xuICogR29vZ2xlIFNlYXJjaCBncm91bmRpbmcgYW5kIG11bHRpLXBoYXNlIHJlc2VhcmNoIHdvcmtmbG93LlxuICovXG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXREZWVwUmVzZWFyY2hTZXJ2aWNlLCBDb21wYW55RGVlcFJlc2VhcmNoIH0gZnJvbSAnQC9saWIvc2VydmljZXMvZGVlcC1yZXNlYXJjaCc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9kYi9wcmlzbWEnO1xuXG5leHBvcnQgY29uc3QgbWF4RHVyYXRpb24gPSA2MDsgLy8gQWxsb3cgdXAgdG8gNjAgc2Vjb25kcyBmb3IgZGVlcCByZXNlYXJjaFxuXG5pbnRlcmZhY2UgRGVlcFJlc2VhcmNoUmVxdWVzdCB7XG4gIGNvbXBhbnlOYW1lOiBzdHJpbmc7XG4gIGNvbXBhbnlVcmw/OiBzdHJpbmc7XG4gIGFuYWx5c2lzSWQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnNvbGUubG9nKCdbREVFUF9SRVNFQVJDSF9BUEldIFJlY2VpdmVkIHJlcXVlc3QnKTtcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHk6IERlZXBSZXNlYXJjaFJlcXVlc3QgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IGNvbXBhbnlOYW1lLCBjb21wYW55VXJsLCBhbmFseXNpc0lkIH0gPSBib2R5O1xuXG4gICAgaWYgKCFjb21wYW55TmFtZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnQ29tcGFueSBuYW1lIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFtERUVQX1JFU0VBUkNIX0FQSV0gU3RhcnRpbmcgZGVlcCByZXNlYXJjaCBmb3I6ICR7Y29tcGFueU5hbWV9YCk7XG5cbiAgICAvLyBHZXQgdGhlIGRlZXAgcmVzZWFyY2ggc2VydmljZVxuICAgIGNvbnN0IGRlZXBSZXNlYXJjaFNlcnZpY2UgPSBnZXREZWVwUmVzZWFyY2hTZXJ2aWNlKCk7XG5cbiAgICAvLyBFeGVjdXRlIGRlZXAgcmVzZWFyY2hcbiAgICBjb25zdCByZXNlYXJjaFJlc3VsdDogQ29tcGFueURlZXBSZXNlYXJjaCA9IGF3YWl0IGRlZXBSZXNlYXJjaFNlcnZpY2UucmVzZWFyY2hDb21wYW55KFxuICAgICAgY29tcGFueU5hbWUsXG4gICAgICBjb21wYW55VXJsXG4gICAgKTtcblxuICAgIGNvbnNvbGUubG9nKGBbREVFUF9SRVNFQVJDSF9BUEldIFJlc2VhcmNoIGNvbXBsZXRlIHdpdGggJHtyZXNlYXJjaFJlc3VsdC5zb3VyY2VzLmxlbmd0aH0gc291cmNlc2ApO1xuXG4gICAgLy8gSWYgYW4gYW5hbHlzaXMgSUQgd2FzIHByb3ZpZGVkLCB1cGRhdGUgdGhlIGFuYWx5c2lzIHdpdGggZGVlcCByZXNlYXJjaCBkYXRhXG4gICAgaWYgKGFuYWx5c2lzSWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5hbmFseXNpcy51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBhbmFseXNpc0lkIH0sXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZGVlcFJlc2VhcmNoOiBKU09OLnN0cmluZ2lmeShyZXNlYXJjaFJlc3VsdCksXG4gICAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhgW0RFRVBfUkVTRUFSQ0hfQVBJXSBVcGRhdGVkIGFuYWx5c2lzICR7YW5hbHlzaXNJZH0gd2l0aCBkZWVwIHJlc2VhcmNoYCk7XG4gICAgICB9IGNhdGNoIChkYkVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tERUVQX1JFU0VBUkNIX0FQSV0gRGF0YWJhc2UgdXBkYXRlIGVycm9yOicsIGRiRXJyb3IpO1xuICAgICAgICAvLyBDb250aW51ZSBldmVuIGlmIERCIHVwZGF0ZSBmYWlscyAtIHJldHVybiB0aGUgcmVzZWFyY2ggcmVzdWx0XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiByZXNlYXJjaFJlc3VsdCxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIGNvbXBhbnlOYW1lLFxuICAgICAgICBjb21wYW55VXJsLFxuICAgICAgICByZXNlYXJjaGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgc291cmNlc0NvdW50OiByZXNlYXJjaFJlc3VsdC5zb3VyY2VzLmxlbmd0aCxcbiAgICAgICAgaXRlcmF0aW9uczogcmVzZWFyY2hSZXN1bHQucmVzZWFyY2hNZXRhZGF0YS5pdGVyYXRpb25zLFxuICAgICAgICBjb25maWRlbmNlU2NvcmU6IHJlc2VhcmNoUmVzdWx0LnJlc2VhcmNoTWV0YWRhdGEuY29uZmlkZW5jZVNjb3JlLFxuICAgICAgfSxcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tERUVQX1JFU0VBUkNIX0FQSV0gRXJyb3I6JywgZXJyb3IpO1xuXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0RlZXAgcmVzZWFyY2ggZmFpbGVkJyxcbiAgICAgICAgZGV0YWlsczogZXJyb3JNZXNzYWdlLFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuLy8gR0VUIGVuZHBvaW50IHRvIGNoZWNrIGRlZXAgcmVzZWFyY2ggc3RhdHVzIG9yIHJldHJpZXZlIGNhY2hlZCByZXN1bHRzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXM7XG4gIGNvbnN0IGFuYWx5c2lzSWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdhbmFseXNpc0lkJyk7XG5cbiAgaWYgKCFhbmFseXNpc0lkKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0FuYWx5c2lzIElEIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgYW5hbHlzaXMgPSBhd2FpdCBwcmlzbWEuYW5hbHlzaXMuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogYW5hbHlzaXNJZCB9LFxuICAgICAgc2VsZWN0OiB7XG4gICAgICAgIGlkOiB0cnVlLFxuICAgICAgICBjb21wYW55TmFtZTogdHJ1ZSxcbiAgICAgICAgZGVlcFJlc2VhcmNoOiB0cnVlLFxuICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgIHVwZGF0ZWRBdDogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoIWFuYWx5c2lzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdBbmFseXNpcyBub3QgZm91bmQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBQcmlzbWEgcmV0dXJucyBKc29uIGZpZWxkcyBhcyBvYmplY3RzLCBub3Qgc3RyaW5nc1xuICAgIGNvbnN0IGRlZXBSZXNlYXJjaERhdGEgPSBhbmFseXNpcy5kZWVwUmVzZWFyY2ggfHwgbnVsbDtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgYW5hbHlzaXNJZDogYW5hbHlzaXMuaWQsXG4gICAgICBjb21wYW55TmFtZTogYW5hbHlzaXMuY29tcGFueU5hbWUsXG4gICAgICBoYXNEZWVwUmVzZWFyY2g6ICEhZGVlcFJlc2VhcmNoRGF0YSxcbiAgICAgIGRlZXBSZXNlYXJjaDogZGVlcFJlc2VhcmNoRGF0YSxcbiAgICAgIHN0YXR1czogYW5hbHlzaXMuc3RhdHVzLFxuICAgICAgdXBkYXRlZEF0OiBhbmFseXNpcy51cGRhdGVkQXQsXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREVFUF9SRVNFQVJDSF9BUEldIEdFVCBlcnJvcjonLCBlcnJvcik7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIHJldHJpZXZlIGRlZXAgcmVzZWFyY2ggZGF0YScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXREZWVwUmVzZWFyY2hTZXJ2aWNlIiwicHJpc21hIiwibWF4RHVyYXRpb24iLCJQT1NUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJib2R5IiwianNvbiIsImNvbXBhbnlOYW1lIiwiY29tcGFueVVybCIsImFuYWx5c2lzSWQiLCJlcnJvciIsInN0YXR1cyIsImRlZXBSZXNlYXJjaFNlcnZpY2UiLCJyZXNlYXJjaFJlc3VsdCIsInJlc2VhcmNoQ29tcGFueSIsInNvdXJjZXMiLCJsZW5ndGgiLCJhbmFseXNpcyIsInVwZGF0ZSIsIndoZXJlIiwiaWQiLCJkYXRhIiwiZGVlcFJlc2VhcmNoIiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZWRBdCIsIkRhdGUiLCJkYkVycm9yIiwic3VjY2VzcyIsIm1ldGFkYXRhIiwicmVzZWFyY2hlZEF0IiwidG9JU09TdHJpbmciLCJzb3VyY2VzQ291bnQiLCJpdGVyYXRpb25zIiwicmVzZWFyY2hNZXRhZGF0YSIsImNvbmZpZGVuY2VTY29yZSIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsImRldGFpbHMiLCJHRVQiLCJzZWFyY2hQYXJhbXMiLCJuZXh0VXJsIiwiZ2V0IiwiZmluZFVuaXF1ZSIsInNlbGVjdCIsImRlZXBSZXNlYXJjaERhdGEiLCJoYXNEZWVwUmVzZWFyY2giXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/deep-research/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/prisma.ts":
/*!**************************!*\
  !*** ./lib/db/prisma.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\n// Explicitly use BDR Hunter's database URL\nconst BDR_HUNTER_DATABASE_URL = \"postgresql://postgres:postgres@localhost:5433/bdr_hunter?schema=public\";\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    datasources: {\n        db: {\n            url: BDR_HUNTER_DATABASE_URL\n        }\n    }\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QywyQ0FBMkM7QUFDM0MsTUFBTUMsMEJBQTBCO0FBRWhDLE1BQU1DLGtCQUFrQkM7QUFJakIsTUFBTUMsU0FBU0YsZ0JBQWdCRSxNQUFNLElBQUksSUFBSUosd0RBQVlBLENBQUM7SUFDL0RLLGFBQWE7UUFDWEMsSUFBSTtZQUNGQyxLQUFLTjtRQUNQO0lBQ0Y7QUFDRixHQUFFO0FBRUYsSUFBSU8sSUFBeUIsRUFBY04sZ0JBQWdCRSxNQUFNLEdBQUdBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmRyLWh1bnRlci1hcHAvLi9saWIvZGIvcHJpc21hLnRzPzA5NjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbi8vIEV4cGxpY2l0bHkgdXNlIEJEUiBIdW50ZXIncyBkYXRhYmFzZSBVUkxcbmNvbnN0IEJEUl9IVU5URVJfREFUQUJBU0VfVVJMID0gXCJwb3N0Z3Jlc3FsOi8vcG9zdGdyZXM6cG9zdGdyZXNAbG9jYWxob3N0OjU0MzMvYmRyX2h1bnRlcj9zY2hlbWE9cHVibGljXCJcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGRhdGFzb3VyY2VzOiB7XG4gICAgZGI6IHtcbiAgICAgIHVybDogQkRSX0hVTlRFUl9EQVRBQkFTRV9VUkwsXG4gICAgfSxcbiAgfSxcbn0pXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiQkRSX0hVTlRFUl9EQVRBQkFTRV9VUkwiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwiZGF0YXNvdXJjZXMiLCJkYiIsInVybCIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/deep-research.ts":
/*!***************************************!*\
  !*** ./lib/services/deep-research.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DeepResearchService: () => (/* binding */ DeepResearchService),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getDeepResearchService: () => (/* binding */ getDeepResearchService)\n/* harmony export */ });\n/**\n * Deep Research Service - Agentic AI Research System\n *\n * Features:\n * - Multi-stage research with iterative refinement\n * - Google Search grounding for real-time information\n * - Thinking/reasoning capabilities (Gemini 2.5 Pro)\n * - Structured output with citations\n * - Agentic workflow with self-correction\n *\n * References:\n * - https://ai.google.dev/gemini-api/docs/google-search\n * - https://blog.google/technology/google-deepmind/gemini-model-thinking-updates-march-2025/\n */ /**\n * Deep Research Service with Agentic Behavior\n */ class DeepResearchService {\n    constructor(config){\n        this.baseUrl = \"https://generativelanguage.googleapis.com/v1beta/models\";\n        this.apiKey = config.apiKey;\n        this.model = config.model || \"gemini-2.5-flash\";\n        this.thinkingLevel = config.thinkingLevel || \"medium\";\n        this.maxIterations = config.maxIterations || 3;\n    }\n    /**\n   * Execute a grounded search query with thinking\n   */ async groundedSearch(prompt, options) {\n        const request = {\n            contents: [\n                {\n                    role: \"user\",\n                    parts: [\n                        {\n                            text: prompt\n                        }\n                    ]\n                }\n            ],\n            generationConfig: {\n                temperature: options?.temperature || 0.3,\n                maxOutputTokens: 8192,\n                topK: 40,\n                topP: 0.95\n            },\n            tools: [\n                {\n                    googleSearch: {}\n                }\n            ]\n        };\n        const url = `${this.baseUrl}/${this.model}:generateContent?key=${this.apiKey}`;\n        try {\n            const response = await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(request)\n            });\n            if (!response.ok) {\n                const error = await response.json();\n                throw new Error(`Gemini API error: ${error.error?.message || \"Unknown error\"}`);\n            }\n            const data = await response.json();\n            if (!data.candidates || data.candidates.length === 0) {\n                throw new Error(\"No response from Gemini API\");\n            }\n            const candidate = data.candidates[0];\n            const text = candidate.content?.parts?.[0]?.text || \"\";\n            const groundingMetadata = candidate.groundingMetadata || {};\n            // Extract sources from grounding metadata\n            const sources = (groundingMetadata.groundingChunks || []).map((chunk, index)=>({\n                    title: chunk.web?.title || `Source ${index + 1}`,\n                    url: chunk.web?.uri || \"\",\n                    snippet: \"\",\n                    relevance: 1.0 - index * 0.1\n                }));\n            const searchQueries = groundingMetadata.webSearchQueries || [];\n            return {\n                text,\n                sources,\n                searchQueries\n            };\n        } catch (error) {\n            console.error(\"[DEEP_RESEARCH] Grounded search error:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Extract JSON from response text\n   */ extractJSON(text) {\n        if (!text) {\n            throw new Error(\"Empty response\");\n        }\n        // Remove markdown code blocks\n        const codeBlockMatch = text.match(/```(?:json)?\\s*([\\s\\S]*?)\\s*```/);\n        if (codeBlockMatch) {\n            return JSON.parse(codeBlockMatch[1].trim());\n        }\n        // Try to find JSON object or array\n        const jsonMatch = text.match(/(\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])/);\n        if (jsonMatch) {\n            return JSON.parse(jsonMatch[1].trim());\n        }\n        return JSON.parse(text.trim());\n    }\n    /**\n   * Research Phase 1: Initial Discovery\n   */ async discoveryPhase(companyName, companyUrl) {\n        console.log(`[DEEP_RESEARCH] Phase 1: Discovery for ${companyName}`);\n        const prompt = `あなたは企業調査アナリストです。「${companyName}」${companyUrl ? `（ウェブサイト: ${companyUrl}）` : \"\"}について調査してください。\n\n以下の情報を検索・収集してください：\n1. 正式な会社名・法人名\n2. 業界・サブ業界の分類\n3. 設立年と沿革\n4. 本社所在地\n5. 従業員数（概算）\n6. 売上高・資金調達情報\n7. 主要な製品・サービス\n8. 経営幹部（CEO、CTO、CFO）\n9. 最近の主要ニュース\n10. 株式銘柄コード（上場している場合）\n\n**重要: すべてのテキストは日本語で出力してください。**\n\n以下のJSON形式で回答してください：\n{\n  \"companyProfile\": {\n    \"name\": \"通称\",\n    \"officialName\": \"正式名称\",\n    \"description\": \"2-3文の企業説明（日本語）\",\n    \"industry\": \"業界\",\n    \"subIndustry\": \"サブ業界\",\n    \"founded\": \"設立年\",\n    \"headquarters\": \"所在地\",\n    \"employees\": \"従業員数\",\n    \"revenue\": \"売上規模\",\n    \"stockSymbol\": \"銘柄コードまたはnull\",\n    \"website\": \"URL\"\n  },\n  \"leadership\": [\n    {\"name\": \"氏名\", \"title\": \"役職\", \"background\": \"経歴概要（日本語）\"}\n  ],\n  \"recentDevelopments\": [\"最新ニュース1\", \"最新ニュース2\"]\n}\n\nJSONのみを返してください。他のテキストは不要です。`;\n        const result = await this.groundedSearch(prompt);\n        const basicInfo = this.extractJSON(result.text);\n        return {\n            basicInfo,\n            sources: result.sources,\n            queries: result.searchQueries\n        };\n    }\n    /**\n   * Research Phase 2: Business Deep Dive\n   */ async businessDeepDive(companyName, basicInfo) {\n        console.log(`[DEEP_RESEARCH] Phase 2: Business Deep Dive for ${companyName}`);\n        const prompt = `あなたはビジネスアナリストです。「${companyName}」（${basicInfo.industry || \"テクノロジー\"}企業）について深掘り分析してください。\n\n以下の項目を調査してください：\n1. ビジネスモデルと収益源\n2. ターゲット市場と顧客セグメント\n3. 競争優位性とモート\n4. 技術スタックとエンジニアリング手法\n5. 主要製品・サービスの市場ポジション\n6. 最近の製品ローンチや事業転換\n\n**重要: すべてのテキストは日本語で出力してください。**\n\n以下のJSON形式で回答してください：\n{\n  \"businessModel\": {\n    \"description\": \"収益モデルの説明（日本語）\",\n    \"revenueStreams\": [\"収益源1\", \"収益源2\"],\n    \"targetMarket\": \"主要な顧客セグメント（日本語）\",\n    \"competitiveAdvantage\": [\"競争優位性1\", \"競争優位性2\"]\n  },\n  \"techStack\": [\n    {\"category\": \"バックエンド\", \"technologies\": [\"技術1\", \"技術2\"]},\n    {\"category\": \"フロントエンド\", \"technologies\": [\"技術1\", \"技術2\"]},\n    {\"category\": \"インフラ\", \"technologies\": [\"技術1\", \"技術2\"]}\n  ],\n  \"products\": [\n    {\"name\": \"製品名\", \"description\": \"概要（日本語）\", \"marketPosition\": \"リーダー/チャレンジャー等\"}\n  ]\n}\n\nJSONのみを返してください。他のテキストは不要です。`;\n        const result = await this.groundedSearch(prompt);\n        const data = this.extractJSON(result.text);\n        return {\n            businessModel: data.businessModel || {},\n            techStack: data.techStack || [],\n            sources: result.sources,\n            queries: result.searchQueries\n        };\n    }\n    /**\n   * Research Phase 3: Challenges & Opportunities Analysis\n   */ async challengesAnalysis(companyName, basicInfo, businessModel) {\n        console.log(`[DEEP_RESEARCH] Phase 3: Challenges & Opportunities for ${companyName}`);\n        const prompt = `あなたは戦略アナリストです。「${companyName}」の課題と機会を分析してください。\n\n企業コンテキスト：\n- 業界: ${basicInfo.industry || \"テクノロジー\"}\n- 規模: ${basicInfo.employees || \"不明\"}人\n- ビジネス: ${businessModel?.description || \"不明\"}\n\n以下を調査・特定してください：\n1. 現在のビジネス課題（ニュース、レポート、業界トレンドから）\n2. 市場での課題\n3. 技術的な課題\n4. 成長機会\n5. 市場拡大の機会\n6. 戦略的パートナーシップの機会\n\n**重要: すべてのテキストは日本語で出力してください。**\n\n以下のJSON形式で回答してください：\n{\n  \"challenges\": [\n    {\"challenge\": \"課題の説明（日本語）\", \"severity\": \"high|medium|low\", \"evidence\": \"根拠・情報源（日本語）\"}\n  ],\n  \"opportunities\": [\n    {\"opportunity\": \"機会の説明（日本語）\", \"relevance\": \"high|medium|low\", \"rationale\": \"BDRアウトリーチとの関連性（日本語）\"}\n  ]\n}\n\nB2B営業アウトリーチに関連する課題と機会に焦点を当ててください。JSONのみを返してください。`;\n        const result = await this.groundedSearch(prompt, {\n            temperature: 0.5\n        });\n        const data = this.extractJSON(result.text);\n        return {\n            challenges: data.challenges || [],\n            opportunities: data.opportunities || [],\n            sources: result.sources,\n            queries: result.searchQueries\n        };\n    }\n    /**\n   * Research Phase 4: Recent News & Events\n   */ async newsResearch(companyName) {\n        console.log(`[DEEP_RESEARCH] Phase 4: Recent News for ${companyName}`);\n        const prompt = `あなたはニュースリサーチャーです。「${companyName}」に関する最新ニュースを検索してください。\n\n以下を検索してください：\n1. 最近の企業発表\n2. 製品のローンチ・アップデート\n3. 経営陣の変更\n4. 資金調達・財務ニュース\n5. パートナーシップ・買収\n6. 業界での受賞・認知\n7. 課題や問題\n\n**重要: すべてのテキストは日本語で出力してください。**\n\n以下のJSON形式で回答してください：\n{\n  \"news\": [\n    {\n      \"title\": \"ニュースの見出し（日本語）\",\n      \"date\": \"YYYY-MM または概算日付\",\n      \"summary\": \"2-3文の要約（日本語）\",\n      \"source\": \"メディア名\",\n      \"url\": \"URLがあれば\",\n      \"relevance\": \"営業アウトリーチとの関連性（日本語）\"\n    }\n  ]\n}\n\n過去12ヶ月のニュースに焦点を当ててください。JSONのみを返してください。`;\n        const result = await this.groundedSearch(prompt);\n        const data = this.extractJSON(result.text);\n        return {\n            news: data.news || [],\n            sources: result.sources,\n            queries: result.searchQueries\n        };\n    }\n    /**\n   * Execute Full Deep Research\n   */ async researchCompany(companyName, companyUrl) {\n        console.log(`[DEEP_RESEARCH] Starting deep research for: ${companyName}`);\n        const startTime = Date.now();\n        const allSources = [];\n        const allQueries = [];\n        try {\n            // Phase 1: Discovery\n            const discovery = await this.discoveryPhase(companyName, companyUrl);\n            allSources.push(...discovery.sources);\n            allQueries.push(...discovery.queries);\n            // Phase 2: Business Deep Dive\n            const business = await this.businessDeepDive(companyName, discovery.basicInfo);\n            allSources.push(...business.sources);\n            allQueries.push(...business.queries);\n            // Phase 3: Challenges & Opportunities\n            const analysis = await this.challengesAnalysis(companyName, discovery.basicInfo, business.businessModel);\n            allSources.push(...analysis.sources);\n            allQueries.push(...analysis.queries);\n            // Phase 4: Recent News\n            const news = await this.newsResearch(companyName);\n            allSources.push(...news.sources);\n            allQueries.push(...news.queries);\n            // Deduplicate sources\n            const uniqueSources = this.deduplicateSources(allSources);\n            // Calculate confidence score based on source count and diversity\n            const confidenceScore = Math.min(0.95, 0.5 + uniqueSources.length * 0.05);\n            const duration = (Date.now() - startTime) / 1000;\n            console.log(`[DEEP_RESEARCH] Completed in ${duration.toFixed(1)}s with ${uniqueSources.length} sources`);\n            return {\n                companyProfile: {\n                    ...discovery.basicInfo.companyProfile,\n                    website: companyUrl || discovery.basicInfo.companyProfile?.website || \"\"\n                },\n                businessModel: business.businessModel,\n                recentNews: news.news.slice(0, 5),\n                leadership: discovery.basicInfo.leadership || [],\n                techStack: business.techStack,\n                challenges: analysis.challenges.slice(0, 5),\n                opportunities: analysis.opportunities.slice(0, 5),\n                sources: uniqueSources,\n                researchMetadata: {\n                    iterations: 4,\n                    searchQueries: [\n                        ...new Set(allQueries)\n                    ],\n                    confidenceScore,\n                    completedAt: new Date().toISOString()\n                }\n            };\n        } catch (error) {\n            console.error(\"[DEEP_RESEARCH] Error:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Deduplicate sources by URL\n   */ deduplicateSources(sources) {\n        const seen = new Set();\n        return sources.filter((source)=>{\n            if (!source.url || seen.has(source.url)) {\n                return false;\n            }\n            seen.add(source.url);\n            return true;\n        });\n    }\n}\n// Singleton instance\nlet deepResearchService = null;\nfunction getDeepResearchService() {\n    if (!deepResearchService) {\n        const apiKey = process.env.GEMINI_API_KEY;\n        if (!apiKey) {\n            throw new Error(\"GEMINI_API_KEY environment variable is not set\");\n        }\n        deepResearchService = new DeepResearchService({\n            apiKey,\n            model: \"gemini-2.5-flash\",\n            thinkingLevel: \"medium\",\n            maxIterations: 3\n        });\n    }\n    return deepResearchService;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (DeepResearchService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNabEQsZUFBZTsyQkFBSSxJQUFJbUQsSUFBSW5CO3FCQUFZO29CQUN2Q087b0JBQ0FhLGFBQWEsSUFBSXZCLE9BQU93QixXQUFXO2dCQUNyQztZQUNGO1FBQ0YsRUFBRSxPQUFPekUsT0FBTztZQUNkc0IsUUFBUXRCLEtBQUssQ0FBQywwQkFBMEJBO1lBQ3hDLE1BQU1BO1FBQ1I7SUFDRjtJQUVBOztHQUVDLEdBQ0QsbUJBQTJCVSxPQUF5QixFQUFvQjtRQUN0RSxNQUFNZ0UsT0FBTyxJQUFJSDtRQUNqQixPQUFPN0QsUUFBUWlFLE1BQU0sQ0FBQ0MsQ0FBQUE7WUFDcEIsSUFBSSxDQUFDQSxPQUFPckYsR0FBRyxJQUFJbUYsS0FBS0csR0FBRyxDQUFDRCxPQUFPckYsR0FBRyxHQUFHO2dCQUN2QyxPQUFPO1lBQ1Q7WUFDQW1GLEtBQUtJLEdBQUcsQ0FBQ0YsT0FBT3JGLEdBQUc7WUFDbkIsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVBLHFCQUFxQjtBQUNyQixJQUFJd0Ysc0JBQWtEO0FBRS9DLFNBQVNDO0lBQ2QsSUFBSSxDQUFDRCxxQkFBcUI7UUFDeEIsTUFBTTNHLFNBQVM2RyxRQUFRQyxHQUFHLENBQUNDLGNBQWM7UUFFekMsSUFBSSxDQUFDL0csUUFBUTtZQUNYLE1BQU0sSUFBSThCLE1BQU07UUFDbEI7UUFFQTZFLHNCQUFzQixJQUFJL0csb0JBQW9CO1lBQzVDSTtZQUNBQyxPQUFPO1lBQ1BDLGVBQWU7WUFDZkMsZUFBZTtRQUNqQjtJQUNGO0lBRUEsT0FBT3dHO0FBQ1Q7QUFFQSxpRUFBZS9HLG1CQUFtQkEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2Jkci1odW50ZXItYXBwLy4vbGliL3NlcnZpY2VzL2RlZXAtcmVzZWFyY2gudHM/NmJhYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERlZXAgUmVzZWFyY2ggU2VydmljZSAtIEFnZW50aWMgQUkgUmVzZWFyY2ggU3lzdGVtXG4gKlxuICogRmVhdHVyZXM6XG4gKiAtIE11bHRpLXN0YWdlIHJlc2VhcmNoIHdpdGggaXRlcmF0aXZlIHJlZmluZW1lbnRcbiAqIC0gR29vZ2xlIFNlYXJjaCBncm91bmRpbmcgZm9yIHJlYWwtdGltZSBpbmZvcm1hdGlvblxuICogLSBUaGlua2luZy9yZWFzb25pbmcgY2FwYWJpbGl0aWVzIChHZW1pbmkgMi41IFBybylcbiAqIC0gU3RydWN0dXJlZCBvdXRwdXQgd2l0aCBjaXRhdGlvbnNcbiAqIC0gQWdlbnRpYyB3b3JrZmxvdyB3aXRoIHNlbGYtY29ycmVjdGlvblxuICpcbiAqIFJlZmVyZW5jZXM6XG4gKiAtIGh0dHBzOi8vYWkuZ29vZ2xlLmRldi9nZW1pbmktYXBpL2RvY3MvZ29vZ2xlLXNlYXJjaFxuICogLSBodHRwczovL2Jsb2cuZ29vZ2xlL3RlY2hub2xvZ3kvZ29vZ2xlLWRlZXBtaW5kL2dlbWluaS1tb2RlbC10aGlua2luZy11cGRhdGVzLW1hcmNoLTIwMjUvXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBEZWVwUmVzZWFyY2hDb25maWcge1xuICBhcGlLZXk6IHN0cmluZztcbiAgbW9kZWw/OiAnZ2VtaW5pLTIuNS1wcm8nIHwgJ2dlbWluaS0yLjUtZmxhc2gnIHwgJ2dlbWluaS0yLjAtZmxhc2gnO1xuICB0aGlua2luZ0xldmVsPzogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJztcbiAgbWF4SXRlcmF0aW9ucz86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXNlYXJjaFJlc3VsdCB7XG4gIHN1bW1hcnk6IHN0cmluZztcbiAgc2VjdGlvbnM6IFJlc2VhcmNoU2VjdGlvbltdO1xuICBzb3VyY2VzOiBSZXNlYXJjaFNvdXJjZVtdO1xuICBjb25maWRlbmNlOiBudW1iZXI7XG4gIGl0ZXJhdGlvbnM6IG51bWJlcjtcbiAgdGhpbmtpbmdQcm9jZXNzPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlc2VhcmNoU2VjdGlvbiB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgc291cmNlczogc3RyaW5nW107XG4gIGNvbmZpZGVuY2U6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXNlYXJjaFNvdXJjZSB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBzbmlwcGV0Pzogc3RyaW5nO1xuICByZWxldmFuY2U6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wYW55RGVlcFJlc2VhcmNoIHtcbiAgY29tcGFueVByb2ZpbGU6IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgb2ZmaWNpYWxOYW1lOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBpbmR1c3RyeTogc3RyaW5nO1xuICAgIHN1YkluZHVzdHJ5OiBzdHJpbmc7XG4gICAgZm91bmRlZDogc3RyaW5nO1xuICAgIGhlYWRxdWFydGVyczogc3RyaW5nO1xuICAgIGVtcGxveWVlczogc3RyaW5nO1xuICAgIHJldmVudWU6IHN0cmluZztcbiAgICBzdG9ja1N5bWJvbD86IHN0cmluZztcbiAgICB3ZWJzaXRlOiBzdHJpbmc7XG4gIH07XG4gIGJ1c2luZXNzTW9kZWw6IHtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHJldmVudWVTdHJlYW1zOiBzdHJpbmdbXTtcbiAgICB0YXJnZXRNYXJrZXQ6IHN0cmluZztcbiAgICBjb21wZXRpdGl2ZUFkdmFudGFnZTogc3RyaW5nW107XG4gIH07XG4gIHJlY2VudE5ld3M6IHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRhdGU6IHN0cmluZztcbiAgICBzdW1tYXJ5OiBzdHJpbmc7XG4gICAgc291cmNlOiBzdHJpbmc7XG4gICAgdXJsOiBzdHJpbmc7XG4gIH1bXTtcbiAgbGVhZGVyc2hpcDoge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGJhY2tncm91bmQ6IHN0cmluZztcbiAgICBsaW5rZWRpblVybD86IHN0cmluZztcbiAgfVtdO1xuICB0ZWNoU3RhY2s6IHtcbiAgICBjYXRlZ29yeTogc3RyaW5nO1xuICAgIHRlY2hub2xvZ2llczogc3RyaW5nW107XG4gIH1bXTtcbiAgY2hhbGxlbmdlczoge1xuICAgIGNoYWxsZW5nZTogc3RyaW5nO1xuICAgIHNldmVyaXR5OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICAgIGV2aWRlbmNlOiBzdHJpbmc7XG4gIH1bXTtcbiAgb3Bwb3J0dW5pdGllczoge1xuICAgIG9wcG9ydHVuaXR5OiBzdHJpbmc7XG4gICAgcmVsZXZhbmNlOiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICAgIHJhdGlvbmFsZTogc3RyaW5nO1xuICB9W107XG4gIHNvdXJjZXM6IFJlc2VhcmNoU291cmNlW107XG4gIHJlc2VhcmNoTWV0YWRhdGE6IHtcbiAgICBpdGVyYXRpb25zOiBudW1iZXI7XG4gICAgc2VhcmNoUXVlcmllczogc3RyaW5nW107XG4gICAgY29uZmlkZW5jZVNjb3JlOiBudW1iZXI7XG4gICAgY29tcGxldGVkQXQ6IHN0cmluZztcbiAgfTtcbn1cblxuLyoqXG4gKiBEZWVwIFJlc2VhcmNoIFNlcnZpY2Ugd2l0aCBBZ2VudGljIEJlaGF2aW9yXG4gKi9cbmV4cG9ydCBjbGFzcyBEZWVwUmVzZWFyY2hTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBhcGlLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBtb2RlbDogc3RyaW5nO1xuICBwcml2YXRlIHRoaW5raW5nTGV2ZWw6IHN0cmluZztcbiAgcHJpdmF0ZSBtYXhJdGVyYXRpb25zOiBudW1iZXI7XG4gIHByaXZhdGUgYmFzZVVybDogc3RyaW5nID0gJ2h0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMnO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogRGVlcFJlc2VhcmNoQ29uZmlnKSB7XG4gICAgdGhpcy5hcGlLZXkgPSBjb25maWcuYXBpS2V5O1xuICAgIHRoaXMubW9kZWwgPSBjb25maWcubW9kZWwgfHwgJ2dlbWluaS0yLjUtZmxhc2gnO1xuICAgIHRoaXMudGhpbmtpbmdMZXZlbCA9IGNvbmZpZy50aGlua2luZ0xldmVsIHx8ICdtZWRpdW0nO1xuICAgIHRoaXMubWF4SXRlcmF0aW9ucyA9IGNvbmZpZy5tYXhJdGVyYXRpb25zIHx8IDM7XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSBhIGdyb3VuZGVkIHNlYXJjaCBxdWVyeSB3aXRoIHRoaW5raW5nXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdyb3VuZGVkU2VhcmNoKFxuICAgIHByb21wdDogc3RyaW5nLFxuICAgIG9wdGlvbnM/OiB7IHRlbXBlcmF0dXJlPzogbnVtYmVyOyBzdHJ1Y3R1cmVkPzogYm9vbGVhbiB9XG4gICk6IFByb21pc2U8eyB0ZXh0OiBzdHJpbmc7IHNvdXJjZXM6IFJlc2VhcmNoU291cmNlW107IHNlYXJjaFF1ZXJpZXM6IHN0cmluZ1tdIH0+IHtcbiAgICBjb25zdCByZXF1ZXN0OiBhbnkgPSB7XG4gICAgICBjb250ZW50czogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiBwcm9tcHQgfV0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgMC4zLFxuICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDgxOTIsXG4gICAgICAgIHRvcEs6IDQwLFxuICAgICAgICB0b3BQOiAwLjk1LFxuICAgICAgfSxcbiAgICAgIHRvb2xzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBnb29nbGVTZWFyY2g6IHt9LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9O1xuXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVXJsfS8ke3RoaXMubW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmFwaUtleX1gO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdCksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBHZW1pbmkgQVBJIGVycm9yOiAke2Vycm9yLmVycm9yPy5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgaWYgKCFkYXRhLmNhbmRpZGF0ZXMgfHwgZGF0YS5jYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHJlc3BvbnNlIGZyb20gR2VtaW5pIEFQSScpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjYW5kaWRhdGUgPSBkYXRhLmNhbmRpZGF0ZXNbMF07XG4gICAgICBjb25zdCB0ZXh0ID0gY2FuZGlkYXRlLmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQgfHwgJyc7XG4gICAgICBjb25zdCBncm91bmRpbmdNZXRhZGF0YSA9IGNhbmRpZGF0ZS5ncm91bmRpbmdNZXRhZGF0YSB8fCB7fTtcblxuICAgICAgLy8gRXh0cmFjdCBzb3VyY2VzIGZyb20gZ3JvdW5kaW5nIG1ldGFkYXRhXG4gICAgICBjb25zdCBzb3VyY2VzOiBSZXNlYXJjaFNvdXJjZVtdID0gKGdyb3VuZGluZ01ldGFkYXRhLmdyb3VuZGluZ0NodW5rcyB8fCBbXSkubWFwKChjaHVuazogYW55LCBpbmRleDogbnVtYmVyKSA9PiAoe1xuICAgICAgICB0aXRsZTogY2h1bmsud2ViPy50aXRsZSB8fCBgU291cmNlICR7aW5kZXggKyAxfWAsXG4gICAgICAgIHVybDogY2h1bmsud2ViPy51cmkgfHwgJycsXG4gICAgICAgIHNuaXBwZXQ6ICcnLFxuICAgICAgICByZWxldmFuY2U6IDEuMCAtIChpbmRleCAqIDAuMSksXG4gICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IHNlYXJjaFF1ZXJpZXMgPSBncm91bmRpbmdNZXRhZGF0YS53ZWJTZWFyY2hRdWVyaWVzIHx8IFtdO1xuXG4gICAgICByZXR1cm4geyB0ZXh0LCBzb3VyY2VzLCBzZWFyY2hRdWVyaWVzIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tERUVQX1JFU0VBUkNIXSBHcm91bmRlZCBzZWFyY2ggZXJyb3I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgSlNPTiBmcm9tIHJlc3BvbnNlIHRleHRcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdEpTT04odGV4dDogc3RyaW5nKTogYW55IHtcbiAgICBpZiAoIXRleHQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRW1wdHkgcmVzcG9uc2UnKTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgbWFya2Rvd24gY29kZSBibG9ja3NcbiAgICBjb25zdCBjb2RlQmxvY2tNYXRjaCA9IHRleHQubWF0Y2goL2BgYCg/Ompzb24pP1xccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgaWYgKGNvZGVCbG9ja01hdGNoKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShjb2RlQmxvY2tNYXRjaFsxXS50cmltKCkpO1xuICAgIH1cblxuICAgIC8vIFRyeSB0byBmaW5kIEpTT04gb2JqZWN0IG9yIGFycmF5XG4gICAgY29uc3QganNvbk1hdGNoID0gdGV4dC5tYXRjaCgvKFxce1tcXHNcXFNdKlxcfXxcXFtbXFxzXFxTXSpcXF0pLyk7XG4gICAgaWYgKGpzb25NYXRjaCkge1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdLnRyaW0oKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIEpTT04ucGFyc2UodGV4dC50cmltKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2VhcmNoIFBoYXNlIDE6IEluaXRpYWwgRGlzY292ZXJ5XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRpc2NvdmVyeVBoYXNlKGNvbXBhbnlOYW1lOiBzdHJpbmcsIGNvbXBhbnlVcmw/OiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICBiYXNpY0luZm86IGFueTtcbiAgICBzb3VyY2VzOiBSZXNlYXJjaFNvdXJjZVtdO1xuICAgIHF1ZXJpZXM6IHN0cmluZ1tdO1xuICB9PiB7XG4gICAgY29uc29sZS5sb2coYFtERUVQX1JFU0VBUkNIXSBQaGFzZSAxOiBEaXNjb3ZlcnkgZm9yICR7Y29tcGFueU5hbWV9YCk7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBg44GC44Gq44Gf44Gv5LyB5qWt6Kq/5p+744Ki44OK44Oq44K544OI44Gn44GZ44CC44CMJHtjb21wYW55TmFtZX3jgI0ke2NvbXBhbnlVcmwgPyBg77yI44Km44Kn44OW44K144Kk44OIOiAke2NvbXBhbnlVcmx977yJYCA6ICcnfeOBq+OBpOOBhOOBpuiqv+afu+OBl+OBpuOBj+OBoOOBleOBhOOAglxuXG7ku6XkuIvjga7mg4XloLHjgpLmpJzntKLjg7vlj47pm4bjgZfjgabjgY/jgaDjgZXjgYTvvJpcbjEuIOato+W8j+OBquS8muekvuWQjeODu+azleS6uuWQjVxuMi4g5qWt55WM44O744K144OW5qWt55WM44Gu5YiG6aGeXG4zLiDoqK3nq4vlubTjgajmsr/pnalcbjQuIOacrOekvuaJgOWcqOWcsFxuNS4g5b6T5qWt5ZOh5pWw77yI5qaC566X77yJXG42LiDlo7LkuIrpq5jjg7vos4fph5Hoqr/pgZTmg4XloLFcbjcuIOS4u+imgeOBquijveWTgeODu+OCteODvOODk+OCuVxuOC4g57WM5Za25bm56YOo77yIQ0VP44CBQ1RP44CBQ0ZP77yJXG45LiDmnIDov5Hjga7kuLvopoHjg4vjg6Xjg7zjgrlcbjEwLiDmoKrlvI/pipjmn4TjgrPjg7zjg4nvvIjkuIrloLTjgZfjgabjgYTjgovloLTlkIjvvIlcblxuKirph43opoE6IOOBmeOBueOBpuOBruODhuOCreOCueODiOOBr+aXpeacrOiqnuOBp+WHuuWKm+OBl+OBpuOBj+OBoOOBleOBhOOAgioqXG5cbuS7peS4i+OBrkpTT07lvaLlvI/jgaflm57nrZTjgZfjgabjgY/jgaDjgZXjgYTvvJpcbntcbiAgXCJjb21wYW55UHJvZmlsZVwiOiB7XG4gICAgXCJuYW1lXCI6IFwi6YCa56ewXCIsXG4gICAgXCJvZmZpY2lhbE5hbWVcIjogXCLmraPlvI/lkI3np7BcIixcbiAgICBcImRlc2NyaXB0aW9uXCI6IFwiMi0z5paH44Gu5LyB5qWt6Kqs5piO77yI5pel5pys6Kqe77yJXCIsXG4gICAgXCJpbmR1c3RyeVwiOiBcIualreeVjFwiLFxuICAgIFwic3ViSW5kdXN0cnlcIjogXCLjgrXjg5bmpa3nlYxcIixcbiAgICBcImZvdW5kZWRcIjogXCLoqK3nq4vlubRcIixcbiAgICBcImhlYWRxdWFydGVyc1wiOiBcIuaJgOWcqOWcsFwiLFxuICAgIFwiZW1wbG95ZWVzXCI6IFwi5b6T5qWt5ZOh5pWwXCIsXG4gICAgXCJyZXZlbnVlXCI6IFwi5aOy5LiK6KaP5qihXCIsXG4gICAgXCJzdG9ja1N5bWJvbFwiOiBcIumKmOafhOOCs+ODvOODieOBvuOBn+OBr251bGxcIixcbiAgICBcIndlYnNpdGVcIjogXCJVUkxcIlxuICB9LFxuICBcImxlYWRlcnNoaXBcIjogW1xuICAgIHtcIm5hbWVcIjogXCLmsI/lkI1cIiwgXCJ0aXRsZVwiOiBcIuW9ueiBt1wiLCBcImJhY2tncm91bmRcIjogXCLntYzmrbTmpoLopoHvvIjml6XmnKzoqp7vvIlcIn1cbiAgXSxcbiAgXCJyZWNlbnREZXZlbG9wbWVudHNcIjogW1wi5pyA5paw44OL44Ol44O844K5MVwiLCBcIuacgOaWsOODi+ODpeODvOOCuTJcIl1cbn1cblxuSlNPTuOBruOBv+OCkui/lOOBl+OBpuOBj+OBoOOBleOBhOOAguS7luOBruODhuOCreOCueODiOOBr+S4jeimgeOBp+OBmeOAgmA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmdyb3VuZGVkU2VhcmNoKHByb21wdCk7XG4gICAgY29uc3QgYmFzaWNJbmZvID0gdGhpcy5leHRyYWN0SlNPTihyZXN1bHQudGV4dCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgYmFzaWNJbmZvLFxuICAgICAgc291cmNlczogcmVzdWx0LnNvdXJjZXMsXG4gICAgICBxdWVyaWVzOiByZXN1bHQuc2VhcmNoUXVlcmllcyxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2VhcmNoIFBoYXNlIDI6IEJ1c2luZXNzIERlZXAgRGl2ZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBidXNpbmVzc0RlZXBEaXZlKGNvbXBhbnlOYW1lOiBzdHJpbmcsIGJhc2ljSW5mbzogYW55KTogUHJvbWlzZTx7XG4gICAgYnVzaW5lc3NNb2RlbDogYW55O1xuICAgIHRlY2hTdGFjazogYW55W107XG4gICAgc291cmNlczogUmVzZWFyY2hTb3VyY2VbXTtcbiAgICBxdWVyaWVzOiBzdHJpbmdbXTtcbiAgfT4ge1xuICAgIGNvbnNvbGUubG9nKGBbREVFUF9SRVNFQVJDSF0gUGhhc2UgMjogQnVzaW5lc3MgRGVlcCBEaXZlIGZvciAke2NvbXBhbnlOYW1lfWApO1xuXG4gICAgY29uc3QgcHJvbXB0ID0gYOOBguOBquOBn+OBr+ODk+OCuOODjeOCueOCouODiuODquOCueODiOOBp+OBmeOAguOAjCR7Y29tcGFueU5hbWV944CN77yIJHtiYXNpY0luZm8uaW5kdXN0cnkgfHwgJ+ODhuOCr+ODjuODreOCuOODvCd95LyB5qWt77yJ44Gr44Gk44GE44Gm5rex5o6Y44KK5YiG5p6Q44GX44Gm44GP44Gg44GV44GE44CCXG5cbuS7peS4i+OBrumgheebruOCkuiqv+afu+OBl+OBpuOBj+OBoOOBleOBhO+8mlxuMS4g44OT44K444ON44K544Oi44OH44Or44Go5Y+O55uK5rqQXG4yLiDjgr/jg7zjgrLjg4Pjg4jluILloLTjgajpoaflrqLjgrvjgrDjg6Hjg7Pjg4hcbjMuIOertuS6ieWEquS9jeaAp+OBqOODouODvOODiFxuNC4g5oqA6KGT44K544K/44OD44Kv44Go44Ko44Oz44K444OL44Ki44Oq44Oz44Kw5omL5rOVXG41LiDkuLvopoHoo73lk4Hjg7vjgrXjg7zjg5Pjgrnjga7luILloLTjg53jgrjjgrfjg6fjg7NcbjYuIOacgOi/keOBruijveWTgeODreODvOODs+ODgeOChOS6i+alrei7ouaPm1xuXG4qKumHjeimgTog44GZ44G544Gm44Gu44OG44Kt44K544OI44Gv5pel5pys6Kqe44Gn5Ye65Yqb44GX44Gm44GP44Gg44GV44GE44CCKipcblxu5Lul5LiL44GuSlNPTuW9ouW8j+OBp+WbnuetlOOBl+OBpuOBj+OBoOOBleOBhO+8mlxue1xuICBcImJ1c2luZXNzTW9kZWxcIjoge1xuICAgIFwiZGVzY3JpcHRpb25cIjogXCLlj47nm4rjg6Ljg4fjg6vjga7oqqzmmI7vvIjml6XmnKzoqp7vvIlcIixcbiAgICBcInJldmVudWVTdHJlYW1zXCI6IFtcIuWPjuebiua6kDFcIiwgXCLlj47nm4rmupAyXCJdLFxuICAgIFwidGFyZ2V0TWFya2V0XCI6IFwi5Li76KaB44Gq6aGn5a6i44K744Kw44Oh44Oz44OI77yI5pel5pys6Kqe77yJXCIsXG4gICAgXCJjb21wZXRpdGl2ZUFkdmFudGFnZVwiOiBbXCLnq7bkuonlhKrkvY3mgKcxXCIsIFwi56u25LqJ5YSq5L2N5oCnMlwiXVxuICB9LFxuICBcInRlY2hTdGFja1wiOiBbXG4gICAge1wiY2F0ZWdvcnlcIjogXCLjg5Djg4Pjgq/jgqjjg7Pjg4lcIiwgXCJ0ZWNobm9sb2dpZXNcIjogW1wi5oqA6KGTMVwiLCBcIuaKgOihkzJcIl19LFxuICAgIHtcImNhdGVnb3J5XCI6IFwi44OV44Ot44Oz44OI44Ko44Oz44OJXCIsIFwidGVjaG5vbG9naWVzXCI6IFtcIuaKgOihkzFcIiwgXCLmioDooZMyXCJdfSxcbiAgICB7XCJjYXRlZ29yeVwiOiBcIuOCpOODs+ODleODqVwiLCBcInRlY2hub2xvZ2llc1wiOiBbXCLmioDooZMxXCIsIFwi5oqA6KGTMlwiXX1cbiAgXSxcbiAgXCJwcm9kdWN0c1wiOiBbXG4gICAge1wibmFtZVwiOiBcIuijveWTgeWQjVwiLCBcImRlc2NyaXB0aW9uXCI6IFwi5qaC6KaB77yI5pel5pys6Kqe77yJXCIsIFwibWFya2V0UG9zaXRpb25cIjogXCLjg6rjg7zjg4Djg7wv44OB44Oj44Os44Oz44K444Oj44O8562JXCJ9XG4gIF1cbn1cblxuSlNPTuOBruOBv+OCkui/lOOBl+OBpuOBj+OBoOOBleOBhOOAguS7luOBruODhuOCreOCueODiOOBr+S4jeimgeOBp+OBmeOAgmA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmdyb3VuZGVkU2VhcmNoKHByb21wdCk7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZXh0cmFjdEpTT04ocmVzdWx0LnRleHQpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGJ1c2luZXNzTW9kZWw6IGRhdGEuYnVzaW5lc3NNb2RlbCB8fCB7fSxcbiAgICAgIHRlY2hTdGFjazogZGF0YS50ZWNoU3RhY2sgfHwgW10sXG4gICAgICBzb3VyY2VzOiByZXN1bHQuc291cmNlcyxcbiAgICAgIHF1ZXJpZXM6IHJlc3VsdC5zZWFyY2hRdWVyaWVzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVzZWFyY2ggUGhhc2UgMzogQ2hhbGxlbmdlcyAmIE9wcG9ydHVuaXRpZXMgQW5hbHlzaXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2hhbGxlbmdlc0FuYWx5c2lzKGNvbXBhbnlOYW1lOiBzdHJpbmcsIGJhc2ljSW5mbzogYW55LCBidXNpbmVzc01vZGVsOiBhbnkpOiBQcm9taXNlPHtcbiAgICBjaGFsbGVuZ2VzOiBhbnlbXTtcbiAgICBvcHBvcnR1bml0aWVzOiBhbnlbXTtcbiAgICBzb3VyY2VzOiBSZXNlYXJjaFNvdXJjZVtdO1xuICAgIHF1ZXJpZXM6IHN0cmluZ1tdO1xuICB9PiB7XG4gICAgY29uc29sZS5sb2coYFtERUVQX1JFU0VBUkNIXSBQaGFzZSAzOiBDaGFsbGVuZ2VzICYgT3Bwb3J0dW5pdGllcyBmb3IgJHtjb21wYW55TmFtZX1gKTtcblxuICAgIGNvbnN0IHByb21wdCA9IGDjgYLjgarjgZ/jga/miKbnlaXjgqLjg4rjg6rjgrnjg4jjgafjgZnjgILjgIwke2NvbXBhbnlOYW1lfeOAjeOBruiqsumhjOOBqOapn+S8muOCkuWIhuaekOOBl+OBpuOBj+OBoOOBleOBhOOAglxuXG7kvIHmpa3jgrPjg7Pjg4bjgq3jgrnjg4jvvJpcbi0g5qWt55WMOiAke2Jhc2ljSW5mby5pbmR1c3RyeSB8fCAn44OG44Kv44OO44Ot44K444O8J31cbi0g6KaP5qihOiAke2Jhc2ljSW5mby5lbXBsb3llZXMgfHwgJ+S4jeaYjid95Lq6XG4tIOODk+OCuOODjeOCuTogJHtidXNpbmVzc01vZGVsPy5kZXNjcmlwdGlvbiB8fCAn5LiN5piOJ31cblxu5Lul5LiL44KS6Kq/5p+744O754m55a6a44GX44Gm44GP44Gg44GV44GE77yaXG4xLiDnj77lnKjjga7jg5Pjgrjjg43jgrnoqrLpoYzvvIjjg4vjg6Xjg7zjgrnjgIHjg6zjg53jg7zjg4jjgIHmpa3nlYzjg4jjg6zjg7Pjg4njgYvjgonvvIlcbjIuIOW4guWgtOOBp+OBruiqsumhjFxuMy4g5oqA6KGT55qE44Gq6Kqy6aGMXG40LiDmiJDplbfmqZ/kvJpcbjUuIOW4guWgtOaLoeWkp+OBruapn+S8mlxuNi4g5oim55Wl55qE44OR44O844OI44OK44O844K344OD44OX44Gu5qmf5LyaXG5cbioq6YeN6KaBOiDjgZnjgbnjgabjga7jg4bjgq3jgrnjg4jjga/ml6XmnKzoqp7jgaflh7rlipvjgZfjgabjgY/jgaDjgZXjgYTjgIIqKlxuXG7ku6XkuIvjga5KU09O5b2i5byP44Gn5Zue562U44GX44Gm44GP44Gg44GV44GE77yaXG57XG4gIFwiY2hhbGxlbmdlc1wiOiBbXG4gICAge1wiY2hhbGxlbmdlXCI6IFwi6Kqy6aGM44Gu6Kqs5piO77yI5pel5pys6Kqe77yJXCIsIFwic2V2ZXJpdHlcIjogXCJoaWdofG1lZGl1bXxsb3dcIiwgXCJldmlkZW5jZVwiOiBcIuagueaLoOODu+aDheWgsea6kO+8iOaXpeacrOiqnu+8iVwifVxuICBdLFxuICBcIm9wcG9ydHVuaXRpZXNcIjogW1xuICAgIHtcIm9wcG9ydHVuaXR5XCI6IFwi5qmf5Lya44Gu6Kqs5piO77yI5pel5pys6Kqe77yJXCIsIFwicmVsZXZhbmNlXCI6IFwiaGlnaHxtZWRpdW18bG93XCIsIFwicmF0aW9uYWxlXCI6IFwiQkRS44Ki44Km44OI44Oq44O844OB44Go44Gu6Zai6YCj5oCn77yI5pel5pys6Kqe77yJXCJ9XG4gIF1cbn1cblxuQjJC5Za25qWt44Ki44Km44OI44Oq44O844OB44Gr6Zai6YCj44GZ44KL6Kqy6aGM44Go5qmf5Lya44Gr54Sm54K544KS5b2T44Gm44Gm44GP44Gg44GV44GE44CCSlNPTuOBruOBv+OCkui/lOOBl+OBpuOBj+OBoOOBleOBhOOAgmA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmdyb3VuZGVkU2VhcmNoKHByb21wdCwgeyB0ZW1wZXJhdHVyZTogMC41IH0pO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmV4dHJhY3RKU09OKHJlc3VsdC50ZXh0KTtcblxuICAgIHJldHVybiB7XG4gICAgICBjaGFsbGVuZ2VzOiBkYXRhLmNoYWxsZW5nZXMgfHwgW10sXG4gICAgICBvcHBvcnR1bml0aWVzOiBkYXRhLm9wcG9ydHVuaXRpZXMgfHwgW10sXG4gICAgICBzb3VyY2VzOiByZXN1bHQuc291cmNlcyxcbiAgICAgIHF1ZXJpZXM6IHJlc3VsdC5zZWFyY2hRdWVyaWVzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVzZWFyY2ggUGhhc2UgNDogUmVjZW50IE5ld3MgJiBFdmVudHNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgbmV3c1Jlc2VhcmNoKGNvbXBhbnlOYW1lOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICBuZXdzOiBhbnlbXTtcbiAgICBzb3VyY2VzOiBSZXNlYXJjaFNvdXJjZVtdO1xuICAgIHF1ZXJpZXM6IHN0cmluZ1tdO1xuICB9PiB7XG4gICAgY29uc29sZS5sb2coYFtERUVQX1JFU0VBUkNIXSBQaGFzZSA0OiBSZWNlbnQgTmV3cyBmb3IgJHtjb21wYW55TmFtZX1gKTtcblxuICAgIGNvbnN0IHByb21wdCA9IGDjgYLjgarjgZ/jga/jg4vjg6Xjg7zjgrnjg6rjgrXjg7zjg4Hjg6Pjg7zjgafjgZnjgILjgIwke2NvbXBhbnlOYW1lfeOAjeOBq+mWouOBmeOCi+acgOaWsOODi+ODpeODvOOCueOCkuaknOe0ouOBl+OBpuOBj+OBoOOBleOBhOOAglxuXG7ku6XkuIvjgpLmpJzntKLjgZfjgabjgY/jgaDjgZXjgYTvvJpcbjEuIOacgOi/keOBruS8gealreeZuuihqFxuMi4g6KO95ZOB44Gu44Ot44O844Oz44OB44O744Ki44OD44OX44OH44O844OIXG4zLiDntYzllrbpmaPjga7lpInmm7RcbjQuIOizh+mHkeiqv+mBlOODu+iyoeWLmeODi+ODpeODvOOCuVxuNS4g44OR44O844OI44OK44O844K344OD44OX44O76LK35Y+OXG42LiDmpa3nlYzjgafjga7lj5fos57jg7voqo3nn6VcbjcuIOiqsumhjOOChOWVj+mhjFxuXG4qKumHjeimgTog44GZ44G544Gm44Gu44OG44Kt44K544OI44Gv5pel5pys6Kqe44Gn5Ye65Yqb44GX44Gm44GP44Gg44GV44GE44CCKipcblxu5Lul5LiL44GuSlNPTuW9ouW8j+OBp+WbnuetlOOBl+OBpuOBj+OBoOOBleOBhO+8mlxue1xuICBcIm5ld3NcIjogW1xuICAgIHtcbiAgICAgIFwidGl0bGVcIjogXCLjg4vjg6Xjg7zjgrnjga7opovlh7rjgZfvvIjml6XmnKzoqp7vvIlcIixcbiAgICAgIFwiZGF0ZVwiOiBcIllZWVktTU0g44G+44Gf44Gv5qaC566X5pel5LuYXCIsXG4gICAgICBcInN1bW1hcnlcIjogXCIyLTPmlofjga7opoHntITvvIjml6XmnKzoqp7vvIlcIixcbiAgICAgIFwic291cmNlXCI6IFwi44Oh44OH44Kj44Ki5ZCNXCIsXG4gICAgICBcInVybFwiOiBcIlVSTOOBjOOBguOCjOOBsFwiLFxuICAgICAgXCJyZWxldmFuY2VcIjogXCLllrbmpa3jgqLjgqbjg4jjg6rjg7zjg4Hjgajjga7plqLpgKPmgKfvvIjml6XmnKzoqp7vvIlcIlxuICAgIH1cbiAgXVxufVxuXG7pgY7ljrsxMuODtuaciOOBruODi+ODpeODvOOCueOBq+eEpueCueOCkuW9k+OBpuOBpuOBj+OBoOOBleOBhOOAgkpTT07jga7jgb/jgpLov5TjgZfjgabjgY/jgaDjgZXjgYTjgIJgO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5ncm91bmRlZFNlYXJjaChwcm9tcHQpO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmV4dHJhY3RKU09OKHJlc3VsdC50ZXh0KTtcblxuICAgIHJldHVybiB7XG4gICAgICBuZXdzOiBkYXRhLm5ld3MgfHwgW10sXG4gICAgICBzb3VyY2VzOiByZXN1bHQuc291cmNlcyxcbiAgICAgIHF1ZXJpZXM6IHJlc3VsdC5zZWFyY2hRdWVyaWVzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSBGdWxsIERlZXAgUmVzZWFyY2hcbiAgICovXG4gIGFzeW5jIHJlc2VhcmNoQ29tcGFueShjb21wYW55TmFtZTogc3RyaW5nLCBjb21wYW55VXJsPzogc3RyaW5nKTogUHJvbWlzZTxDb21wYW55RGVlcFJlc2VhcmNoPiB7XG4gICAgY29uc29sZS5sb2coYFtERUVQX1JFU0VBUkNIXSBTdGFydGluZyBkZWVwIHJlc2VhcmNoIGZvcjogJHtjb21wYW55TmFtZX1gKTtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGFsbFNvdXJjZXM6IFJlc2VhcmNoU291cmNlW10gPSBbXTtcbiAgICBjb25zdCBhbGxRdWVyaWVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFBoYXNlIDE6IERpc2NvdmVyeVxuICAgICAgY29uc3QgZGlzY292ZXJ5ID0gYXdhaXQgdGhpcy5kaXNjb3ZlcnlQaGFzZShjb21wYW55TmFtZSwgY29tcGFueVVybCk7XG4gICAgICBhbGxTb3VyY2VzLnB1c2goLi4uZGlzY292ZXJ5LnNvdXJjZXMpO1xuICAgICAgYWxsUXVlcmllcy5wdXNoKC4uLmRpc2NvdmVyeS5xdWVyaWVzKTtcblxuICAgICAgLy8gUGhhc2UgMjogQnVzaW5lc3MgRGVlcCBEaXZlXG4gICAgICBjb25zdCBidXNpbmVzcyA9IGF3YWl0IHRoaXMuYnVzaW5lc3NEZWVwRGl2ZShjb21wYW55TmFtZSwgZGlzY292ZXJ5LmJhc2ljSW5mbyk7XG4gICAgICBhbGxTb3VyY2VzLnB1c2goLi4uYnVzaW5lc3Muc291cmNlcyk7XG4gICAgICBhbGxRdWVyaWVzLnB1c2goLi4uYnVzaW5lc3MucXVlcmllcyk7XG5cbiAgICAgIC8vIFBoYXNlIDM6IENoYWxsZW5nZXMgJiBPcHBvcnR1bml0aWVzXG4gICAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHRoaXMuY2hhbGxlbmdlc0FuYWx5c2lzKFxuICAgICAgICBjb21wYW55TmFtZSxcbiAgICAgICAgZGlzY292ZXJ5LmJhc2ljSW5mbyxcbiAgICAgICAgYnVzaW5lc3MuYnVzaW5lc3NNb2RlbFxuICAgICAgKTtcbiAgICAgIGFsbFNvdXJjZXMucHVzaCguLi5hbmFseXNpcy5zb3VyY2VzKTtcbiAgICAgIGFsbFF1ZXJpZXMucHVzaCguLi5hbmFseXNpcy5xdWVyaWVzKTtcblxuICAgICAgLy8gUGhhc2UgNDogUmVjZW50IE5ld3NcbiAgICAgIGNvbnN0IG5ld3MgPSBhd2FpdCB0aGlzLm5ld3NSZXNlYXJjaChjb21wYW55TmFtZSk7XG4gICAgICBhbGxTb3VyY2VzLnB1c2goLi4ubmV3cy5zb3VyY2VzKTtcbiAgICAgIGFsbFF1ZXJpZXMucHVzaCguLi5uZXdzLnF1ZXJpZXMpO1xuXG4gICAgICAvLyBEZWR1cGxpY2F0ZSBzb3VyY2VzXG4gICAgICBjb25zdCB1bmlxdWVTb3VyY2VzID0gdGhpcy5kZWR1cGxpY2F0ZVNvdXJjZXMoYWxsU291cmNlcyk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjb25maWRlbmNlIHNjb3JlIGJhc2VkIG9uIHNvdXJjZSBjb3VudCBhbmQgZGl2ZXJzaXR5XG4gICAgICBjb25zdCBjb25maWRlbmNlU2NvcmUgPSBNYXRoLm1pbigwLjk1LCAwLjUgKyAodW5pcXVlU291cmNlcy5sZW5ndGggKiAwLjA1KSk7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gKERhdGUubm93KCkgLSBzdGFydFRpbWUpIC8gMTAwMDtcbiAgICAgIGNvbnNvbGUubG9nKGBbREVFUF9SRVNFQVJDSF0gQ29tcGxldGVkIGluICR7ZHVyYXRpb24udG9GaXhlZCgxKX1zIHdpdGggJHt1bmlxdWVTb3VyY2VzLmxlbmd0aH0gc291cmNlc2ApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb21wYW55UHJvZmlsZToge1xuICAgICAgICAgIC4uLmRpc2NvdmVyeS5iYXNpY0luZm8uY29tcGFueVByb2ZpbGUsXG4gICAgICAgICAgd2Vic2l0ZTogY29tcGFueVVybCB8fCBkaXNjb3ZlcnkuYmFzaWNJbmZvLmNvbXBhbnlQcm9maWxlPy53ZWJzaXRlIHx8ICcnLFxuICAgICAgICB9LFxuICAgICAgICBidXNpbmVzc01vZGVsOiBidXNpbmVzcy5idXNpbmVzc01vZGVsLFxuICAgICAgICByZWNlbnROZXdzOiBuZXdzLm5ld3Muc2xpY2UoMCwgNSksXG4gICAgICAgIGxlYWRlcnNoaXA6IGRpc2NvdmVyeS5iYXNpY0luZm8ubGVhZGVyc2hpcCB8fCBbXSxcbiAgICAgICAgdGVjaFN0YWNrOiBidXNpbmVzcy50ZWNoU3RhY2ssXG4gICAgICAgIGNoYWxsZW5nZXM6IGFuYWx5c2lzLmNoYWxsZW5nZXMuc2xpY2UoMCwgNSksXG4gICAgICAgIG9wcG9ydHVuaXRpZXM6IGFuYWx5c2lzLm9wcG9ydHVuaXRpZXMuc2xpY2UoMCwgNSksXG4gICAgICAgIHNvdXJjZXM6IHVuaXF1ZVNvdXJjZXMsXG4gICAgICAgIHJlc2VhcmNoTWV0YWRhdGE6IHtcbiAgICAgICAgICBpdGVyYXRpb25zOiA0LFxuICAgICAgICAgIHNlYXJjaFF1ZXJpZXM6IFsuLi5uZXcgU2V0KGFsbFF1ZXJpZXMpXSxcbiAgICAgICAgICBjb25maWRlbmNlU2NvcmUsXG4gICAgICAgICAgY29tcGxldGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tERUVQX1JFU0VBUkNIXSBFcnJvcjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVkdXBsaWNhdGUgc291cmNlcyBieSBVUkxcbiAgICovXG4gIHByaXZhdGUgZGVkdXBsaWNhdGVTb3VyY2VzKHNvdXJjZXM6IFJlc2VhcmNoU291cmNlW10pOiBSZXNlYXJjaFNvdXJjZVtdIHtcbiAgICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgcmV0dXJuIHNvdXJjZXMuZmlsdGVyKHNvdXJjZSA9PiB7XG4gICAgICBpZiAoIXNvdXJjZS51cmwgfHwgc2Vlbi5oYXMoc291cmNlLnVybCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgc2Vlbi5hZGQoc291cmNlLnVybCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgfVxufVxuXG4vLyBTaW5nbGV0b24gaW5zdGFuY2VcbmxldCBkZWVwUmVzZWFyY2hTZXJ2aWNlOiBEZWVwUmVzZWFyY2hTZXJ2aWNlIHwgbnVsbCA9IG51bGw7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWVwUmVzZWFyY2hTZXJ2aWNlKCk6IERlZXBSZXNlYXJjaFNlcnZpY2Uge1xuICBpZiAoIWRlZXBSZXNlYXJjaFNlcnZpY2UpIHtcbiAgICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWTtcblxuICAgIGlmICghYXBpS2V5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dFTUlOSV9BUElfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG5vdCBzZXQnKTtcbiAgICB9XG5cbiAgICBkZWVwUmVzZWFyY2hTZXJ2aWNlID0gbmV3IERlZXBSZXNlYXJjaFNlcnZpY2Uoe1xuICAgICAgYXBpS2V5LFxuICAgICAgbW9kZWw6ICdnZW1pbmktMi41LWZsYXNoJywgLy8gQmVzdCBiYWxhbmNlIG9mIHNwZWVkIGFuZCBjYXBhYmlsaXR5XG4gICAgICB0aGlua2luZ0xldmVsOiAnbWVkaXVtJyxcbiAgICAgIG1heEl0ZXJhdGlvbnM6IDMsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gZGVlcFJlc2VhcmNoU2VydmljZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgRGVlcFJlc2VhcmNoU2VydmljZTtcbiJdLCJuYW1lcyI6WyJEZWVwUmVzZWFyY2hTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJiYXNlVXJsIiwiYXBpS2V5IiwibW9kZWwiLCJ0aGlua2luZ0xldmVsIiwibWF4SXRlcmF0aW9ucyIsImdyb3VuZGVkU2VhcmNoIiwicHJvbXB0Iiwib3B0aW9ucyIsInJlcXVlc3QiLCJjb250ZW50cyIsInJvbGUiLCJwYXJ0cyIsInRleHQiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJtYXhPdXRwdXRUb2tlbnMiLCJ0b3BLIiwidG9wUCIsInRvb2xzIiwiZ29vZ2xlU2VhcmNoIiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm9rIiwiZXJyb3IiLCJqc29uIiwiRXJyb3IiLCJtZXNzYWdlIiwiZGF0YSIsImNhbmRpZGF0ZXMiLCJsZW5ndGgiLCJjYW5kaWRhdGUiLCJjb250ZW50IiwiZ3JvdW5kaW5nTWV0YWRhdGEiLCJzb3VyY2VzIiwiZ3JvdW5kaW5nQ2h1bmtzIiwibWFwIiwiY2h1bmsiLCJpbmRleCIsInRpdGxlIiwid2ViIiwidXJpIiwic25pcHBldCIsInJlbGV2YW5jZSIsInNlYXJjaFF1ZXJpZXMiLCJ3ZWJTZWFyY2hRdWVyaWVzIiwiY29uc29sZSIsImV4dHJhY3RKU09OIiwiY29kZUJsb2NrTWF0Y2giLCJtYXRjaCIsInBhcnNlIiwidHJpbSIsImpzb25NYXRjaCIsImRpc2NvdmVyeVBoYXNlIiwiY29tcGFueU5hbWUiLCJjb21wYW55VXJsIiwibG9nIiwicmVzdWx0IiwiYmFzaWNJbmZvIiwicXVlcmllcyIsImJ1c2luZXNzRGVlcERpdmUiLCJpbmR1c3RyeSIsImJ1c2luZXNzTW9kZWwiLCJ0ZWNoU3RhY2siLCJjaGFsbGVuZ2VzQW5hbHlzaXMiLCJlbXBsb3llZXMiLCJkZXNjcmlwdGlvbiIsImNoYWxsZW5nZXMiLCJvcHBvcnR1bml0aWVzIiwibmV3c1Jlc2VhcmNoIiwibmV3cyIsInJlc2VhcmNoQ29tcGFueSIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJhbGxTb3VyY2VzIiwiYWxsUXVlcmllcyIsImRpc2NvdmVyeSIsInB1c2giLCJidXNpbmVzcyIsImFuYWx5c2lzIiwidW5pcXVlU291cmNlcyIsImRlZHVwbGljYXRlU291cmNlcyIsImNvbmZpZGVuY2VTY29yZSIsIk1hdGgiLCJtaW4iLCJkdXJhdGlvbiIsInRvRml4ZWQiLCJjb21wYW55UHJvZmlsZSIsIndlYnNpdGUiLCJyZWNlbnROZXdzIiwic2xpY2UiLCJsZWFkZXJzaGlwIiwicmVzZWFyY2hNZXRhZGF0YSIsIml0ZXJhdGlvbnMiLCJTZXQiLCJjb21wbGV0ZWRBdCIsInRvSVNPU3RyaW5nIiwic2VlbiIsImZpbHRlciIsInNvdXJjZSIsImhhcyIsImFkZCIsImRlZXBSZXNlYXJjaFNlcnZpY2UiLCJnZXREZWVwUmVzZWFyY2hTZXJ2aWNlIiwicHJvY2VzcyIsImVudiIsIkdFTUlOSV9BUElfS0VZIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/deep-research.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdeep-research%2Froute&page=%2Fapi%2Fdeep-research%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdeep-research%2Froute.ts&appDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshunsuke%2FDev%2F01-miyabi%2F_core%2Fmiyabi-private%2Fbdr-hunter-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();