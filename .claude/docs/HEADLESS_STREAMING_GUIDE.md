# Claude Code Headless Mode - Streaming Output Guide

**Version**: 1.0.0
**Date**: 2025-11-17
**Purpose**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›ã®ä½¿ç”¨ã‚¬ã‚¤ãƒ‰

---

## ğŸ¯ æ¦‚è¦

Claude Codeã®ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰å®Ÿè¡Œæ™‚ã«ã€**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›**ã‚’æä¾›ã—ã¾ã™ã€‚å¾“æ¥ã®ãƒãƒƒãƒå®Ÿè¡Œã¨ã¯ç•°ãªã‚Šã€å®Ÿè¡Œä¸­ã®é€²æ—çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèªã§ãã¾ã™ã€‚

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### åŸºæœ¬ä½¿ç”¨æ³•

```bash
# ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å®Ÿè¡Œ
./.claude/scripts/miyabi-headless-stream.sh "Implement user authentication"
```

### å‡ºåŠ›ä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Miyabi Headless Streaming Execution           â•‘
â•‘  Version: 1.0.0 (Streaming)                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â• Phase 1/5 â•â•â•

[2025-11-17T08:57:40+09:00] â„¹ Task: Implement user authentication
[2025-11-17T08:57:40+09:00] â–¶ Analyzing task type...
[2025-11-17T08:57:40+09:00] âœ“ Detected task type: code_implementation
Progress: [==========                                        ]  20%

â•â•â• Phase 2/5 â•â•â•

[2025-11-17T08:57:40+09:00] â–¶ Generating optimized context...
[2025-11-17T08:57:41+09:00] âœ“ Context generated: 63514 bytes
Progress: [====================                              ]  40%

... (ä»¥ä¸‹ç¶šã)
```

---

## ğŸ“‹ å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚º

### Phase 1/5: ã‚¿ã‚¹ã‚¯è§£æ

**å‡¦ç†å†…å®¹**:
- ã‚¿ã‚¹ã‚¯è¨˜è¿°ã®å—ã‘å–ã‚Š
- ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã®è‡ªå‹•æ¤œå‡º
- 9ç¨®é¡ã®ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã«åˆ†é¡

**å‡ºåŠ›ä¾‹**:
```
[2025-11-17T08:57:40+09:00] â„¹ Task: Implement user authentication
[2025-11-17T08:57:40+09:00] â–¶ Analyzing task type...
[2025-11-17T08:57:40+09:00] âœ“ Detected task type: code_implementation
```

### Phase 2/5: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ

**å‡¦ç†å†…å®¹**:
- `miyabi-headless-loader.sh`ã®å®Ÿè¡Œ
- Layer 1 (Core Context) ã®ãƒ­ãƒ¼ãƒ‰
- Layer 2 (Task-Specific Context) ã®ãƒ­ãƒ¼ãƒ‰
- çµ±åˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆ

**å‡ºåŠ›ä¾‹**:
```
[2025-11-17T08:57:40+09:00] â–¶ Generating optimized context...
[2025-11-17T08:57:40+09:00] â„¹ Task: Implement user authentication
[2025-11-17T08:57:40+09:00] â„¹ Detected task type: code_implementation
[2025-11-17T08:57:40+09:00] â„¹ Loading Core Context (Layer 1)...
[2025-11-17T08:57:40+09:00] âœ“ Core context loaded
[2025-11-17T08:57:40+09:00] â„¹ Loading Task-Specific Context (Layer 2): code_implementation
[2025-11-17T08:57:40+09:00] âœ“ Task-specific context loaded: code_implementation
[2025-11-17T08:57:41+09:00] âœ“ Context generated: 63514 bytes
```

### Phase 3/5: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ¤œè¨¼

**å‡¦ç†å†…å®¹**:
- ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®æ¤œè¨¼
- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®è¡¨ç¤º
- æ§‹é€ ãƒã‚§ãƒƒã‚¯

**å‡ºåŠ›ä¾‹**:
```
[2025-11-17T08:57:41+09:00] â–¶ Validating context...
[2025-11-17T08:57:41+09:00] â„¹ Context preview:

  â”‚ === MIYABI CORE CONTEXT ===
  â”‚
  â”‚ # Orchestrator Agent Definition
  â”‚
  â”‚ # Miyabi Society - Mac Orchestrator Agent
  â”‚ ...

[2025-11-17T08:57:41+09:00] âœ“ Context validation complete
```

### Phase 4/5: å®Ÿè¡Œæº–å‚™

**å‡¦ç†å†…å®¹**:
- å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
- å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã®ç”Ÿæˆ
- å®Ÿè¡Œç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**å‡ºåŠ›ä¾‹**:
```
[2025-11-17T08:57:41+09:00] â–¶ Preparing execution environment...
[2025-11-17T08:57:41+09:00] âœ“ Output file: /tmp/miyabi-headless-output/stream-output-20251117-085741.md
```

### Phase 5/5: å®Ÿè¡Œ

**å‡¦ç†å†…å®¹**:
- ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›
- çµæœã®ä¿å­˜

**å‡ºåŠ›ä¾‹**:
```
[2025-11-17T08:57:41+09:00] â–¶ Executing task...

# Miyabi Headless Streaming Result

**Task**: Implement user authentication
**Task Type**: code_implementation
**Timestamp**: 2025-11-17T08:57:41+09:00

## Execution Log

### Step 1
Processing... 2025-11-17T08:57:41+09:00

### Step 2
Processing... 2025-11-17T08:57:41+09:00

...

[2025-11-17T08:57:43+09:00] âœ“ Execution complete
```

---

## ğŸ¨ å‡ºåŠ›è¦ç´ 

### ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—

å…¨ã¦ã®ãƒ­ã‚°è¡Œã«**ISO 8601å½¢å¼**ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒä»˜ä¸ã•ã‚Œã¾ã™ï¼š

```
[2025-11-17T08:57:40+09:00] â„¹ Task: Implement user authentication
```

- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: `YYYY-MM-DDTHH:MM:SS+TZ`
- **ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³**: +09:00 (JST)
- **ç²¾åº¦**: ç§’å˜ä½

### ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

5ç¨®é¡ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ï¼š

| ãƒ¬ãƒ™ãƒ« | ã‚¢ã‚¤ã‚³ãƒ³ | è‰² | ç”¨é€” |
|-------|---------|---|-----|
| **INFO** | â„¹ | é’ | æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| **SUCCESS** | âœ“ | ç·‘ | æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| **WARN** | âš  | é»„ | è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| **ERROR** | âœ— | èµ¤ | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| **STEP** | â–¶ | ãƒã‚¼ãƒ³ã‚¿ | å®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ— |

### ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼

```
Progress: [====================                              ]  40%
```

- **å¹…**: 50æ–‡å­—
- **æ›´æ–°**: å„Phaseå®Œäº†æ™‚ (20%åˆ»ã¿)
- **è‰²**: ã‚·ã‚¢ãƒ³ (ãƒãƒ¼) + ç·‘ (ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸)

### PhaseåŒºåˆ‡ã‚Š

```
â•â•â• Phase 2/5 â•â•â•
```

- **è‰²**: ã‚·ã‚¢ãƒ³
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: `Phase N/TOTAL`

---

## ğŸ“ å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

### å‡ºåŠ›å…ˆ

| ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ |
|---------|------|--------------|
| **å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«** | å®Ÿè¡Œçµæœ | `/tmp/miyabi-headless-output/stream-output-<timestamp>.md` |
| **ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ­ã‚°** | å…¨ãƒ­ã‚° | `/tmp/miyabi-stream-<timestamp>.log` |

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡

```
stream-output-20251117-085741.md
               ^^^^^^^^ ^^^^^^
               YYYYMMDD HHMMSS
```

---

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ç’°å¢ƒå¤‰æ•°

```bash
# å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå¤‰æ›´
export OUTPUT_DIR="/custom/output/path"

# ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ­ã‚°å¤‰æ›´
export STREAM_LOG="/custom/stream.log"

# å®Ÿè¡Œ
./.claude/scripts/miyabi-headless-stream.sh "Task description"
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆå°†æ¥å®Ÿè£…äºˆå®šï¼‰

```bash
# é™éŸ³ãƒ¢ãƒ¼ãƒ‰ï¼ˆé€²æ—ãƒãƒ¼ã®ã¿ï¼‰
./.claude/scripts/miyabi-headless-stream.sh "Task" --quiet

# JSONå½¢å¼å‡ºåŠ›
./.claude/scripts/miyabi-headless-stream.sh "Task" --json

# WebSocketé…ä¿¡
./.claude/scripts/miyabi-headless-stream.sh "Task" --websocket ws://localhost:8080
```

---

## ğŸŒŠ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã®ä»•çµ„ã¿

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```bash
# teeã‚³ãƒãƒ³ãƒ‰ã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° + ãƒ­ã‚°ä¿å­˜
command 2>&1 | tee -a "$STREAM_LOG"

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡Œèª­ã¿å–ã‚Š
while IFS= read -r line; do
    echo "$line" | tee -a "$STREAM_LOG"
    sleep 0.05  # ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°åŠ¹æœ
done
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  miyabi-headless-stream.sh                          â”‚
â”‚  (ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  miyabi-headless-loader.sh                          â”‚
â”‚  (ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude Code Headless API (äºˆå®š)                    â”‚
â”‚  (å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨™æº–å‡ºåŠ›       â”‚  â”‚  ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«    â”‚
â”‚  (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ )  â”‚  â”‚  (æ°¸ç¶šåŒ–)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ ä½¿ç”¨ä¾‹

### ä¾‹1: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ

```bash
./.claude/scripts/miyabi-headless-stream.sh \
  "Run CoordinatorAgent to decompose Issue #123"
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
- Phase 1: ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ— `agent_execution` æ¤œå‡º
- Phase 2: agent-execution/SKILL.md, worktree.md, agents.yaml ãƒ­ãƒ¼ãƒ‰
- Phase 3-5: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºåŠ›

### ä¾‹2: ã‚³ãƒ¼ãƒ‰å®Ÿè£…

```bash
./.claude/scripts/miyabi-headless-stream.sh \
  "Implement JWT authentication in miyabi-web-api"
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
- Phase 1: ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ— `code_implementation` æ¤œå‡º
- Phase 2: rust.md, development.md, crates.yaml ãƒ­ãƒ¼ãƒ‰
- Phase 3-5: ã‚³ãƒ¼ãƒ‰å®Ÿè£…ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºåŠ›

### ä¾‹3: Issueåˆ†æ

```bash
./.claude/scripts/miyabi-headless-stream.sh \
  "Analyze and label Issue #456"
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
- Phase 1: ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ— `issue_management` æ¤œå‡º
- Phase 2: issue-analysis/SKILL.md, labels.yaml, workflows.yaml ãƒ­ãƒ¼ãƒ‰
- Phase 3-5: Issueåˆ†æã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºåŠ›

---

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰

| é …ç›® | éã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° | ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° | ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ |
|-----|----------------|--------------|--------------|
| **å®Ÿè¡Œæ™‚é–“** | åŸºæº– | +5-10% | è»½å¾® |
| **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡** | åŸºæº– | +1-2MB | è»½å¾® |
| **CPUä½¿ç”¨ç‡** | åŸºæº– | +2-5% | è»½å¾® |

ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã¯éå¸¸ã«å°ã•ãã€**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã¨ã® tradeoff ã¨ã—ã¦è¨±å®¹ç¯„å›²**ã§ã™ã€‚

---

## ğŸ”® ä»Šå¾Œã®æ‹¡å¼µ

### Phase 1 (Short-term)

1. **WebSocketå¯¾å¿œ**
   - ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
   - è¤‡æ•°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®åŒæ™‚é…ä¿¡

2. **JSONå½¢å¼å‡ºåŠ›**
   - æ©Ÿæ¢°å¯èª­ãªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
   - APIã¨ã®çµ±åˆãŒå®¹æ˜“

3. **é€²æ—ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**
   - ã‚ˆã‚Šç´°ã‹ã„é€²æ—è¡¨ç¤º
   - ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ—ã®è¡¨ç¤º

### Phase 2 (Mid-term)

1. **Server-Sent Events (SSE)**
   - HTTPçµŒç”±ã®ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
   - ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¶ŠãˆãŒå®¹æ˜“

2. **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±åˆ**
   - Web UIã§ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
   - è¤‡æ•°ã‚¿ã‚¹ã‚¯ã®ä¸¦è¡Œç›£è¦–

3. **ãƒ­ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**
   - ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿
   - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢

### Phase 3 (Long-term)

1. **åˆ†æ•£ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°**
   - è¤‡æ•°ãƒ‡ãƒã‚¤ã‚¹é–“ã§ã®åŒæœŸ
   - Coordinators (MUGEN/MAJIN) ã¨ã®çµ±åˆ

2. **ãƒªãƒ—ãƒ¬ã‚¤æ©Ÿèƒ½**
   - éå»ã®å®Ÿè¡Œãƒ­ã‚°ã‚’å†ç”Ÿ
   - ãƒ‡ãƒãƒƒã‚°ã¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ´»ç”¨

3. **AIã«ã‚ˆã‚‹ãƒ­ã‚°è¦ç´„**
   - å®Ÿè¡Œä¸­ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¦ç´„
   - é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®è‡ªå‹•æŠ½å‡º

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ: å‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°

**è§£æ±ºç­–**:
```bash
# unbuffer ã‚’ä½¿ç”¨ï¼ˆexpect ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¿…è¦ï¼‰
unbuffer ./.claude/scripts/miyabi-headless-stream.sh "Task"

# ã¾ãŸã¯ stdbuf ã‚’ä½¿ç”¨
stdbuf -oL -eL ./.claude/scripts/miyabi-headless-stream.sh "Task"
```

### å•é¡Œ: ã‚«ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: ANSIã‚«ãƒ©ãƒ¼éå¯¾å¿œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«

**è§£æ±ºç­–**:
```bash
# ã‚«ãƒ©ãƒ¼å¯¾å¿œã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ç”¨ (iTerm2, Terminixç­‰)
# ã¾ãŸã¯ less -R ã§ãƒ­ã‚°ã‚’è¡¨ç¤º
less -R /tmp/miyabi-stream-*.log
```

### å•é¡Œ: ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤§ãããªã‚Šã™ãã‚‹

**è§£æ±ºç­–**:
```bash
# ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
find /tmp -name "miyabi-stream-*.log" -mtime +7 -delete

# ã¾ãŸã¯ logrotate ã‚’ä½¿ç”¨
```

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [HEADLESS_CONTEXT_OPTIMIZATION.md](HEADLESS_CONTEXT_OPTIMIZATION.md) - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæœ€é©åŒ–æˆ¦ç•¥
- [HEADLESS_MODE_COMPLETION_REPORT.md](HEADLESS_MODE_COMPLETION_REPORT.md) - å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
- [.claude/INDEX.md](.claude/INDEX.md) - ãƒªã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—

---

## ğŸ“ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. é•·æ™‚é–“å®Ÿè¡Œã‚¿ã‚¹ã‚¯

```bash
# nohup ã§å®Ÿè¡Œã—ã¦åˆ‡æ–­å¾Œã‚‚ç¶™ç¶š
nohup ./.claude/scripts/miyabi-headless-stream.sh "Long task" > /tmp/nohup.out 2>&1 &

# tmux ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œ
tmux new-session -d -s miyabi-stream \
  "./.claude/scripts/miyabi-headless-stream.sh 'Long task'"
```

### 2. ãƒ­ã‚°ã®åˆ†æ

```bash
# ã‚¨ãƒ©ãƒ¼ã®ã¿æŠ½å‡º
grep "âœ—" /tmp/miyabi-stream-*.log

# ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç¯„å›²ã§ãƒ•ã‚£ãƒ«ã‚¿
awk '/2025-11-17T08:57:[0-9]{2}/' /tmp/miyabi-stream-*.log
```

### 3. è¤‡æ•°ã‚¿ã‚¹ã‚¯ã®ä¸¦è¡Œå®Ÿè¡Œ

```bash
# GNU Parallel ã‚’ä½¿ç”¨
parallel -j 4 ./.claude/scripts/miyabi-headless-stream.sh ::: \
  "Task 1" \
  "Task 2" \
  "Task 3" \
  "Task 4"
```

---

## ğŸ“ æ›´æ–°å±¥æ­´

### v1.0.0 (2025-11-17)

- âœ… åˆå›ãƒªãƒªãƒ¼ã‚¹
- âœ… 5ãƒ•ã‚§ãƒ¼ã‚ºã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å®Ÿè£…
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ­ã‚°
- âœ… ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤º
- âœ… ã‚«ãƒ©ãƒ¼å‡ºåŠ›å¯¾å¿œ
- âœ… teeã«ã‚ˆã‚‹ãƒ­ã‚°ä¿å­˜

---

**Status**: âœ… ACTIVE
**Maintained by**: Miyabi Team
**Last Updated**: 2025-11-17
**Version**: 1.0.0
