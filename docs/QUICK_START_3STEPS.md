# Miyabi Orchestra - 3ã‚¹ãƒ†ãƒƒãƒ—ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

**ãŸã£ãŸ3ã‚¹ãƒ†ãƒƒãƒ—ã§21ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å‹•ã‹ã™**

---

## ğŸ“‹ å‰ææ¡ä»¶

- âœ… tmux 2.6ä»¥ä¸Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- âœ… Claude Code ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- âœ… Miyabiãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ­ãƒ¼ãƒ³æ¸ˆã¿ï¼ˆ`/Users/shunsuke/Dev/miyabi-private`ï¼‰

---

## ğŸ“– Miyabi Entity-Relation Model

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§æ‰±ã†Entity:
- **E3 (Agent)**: è‡ªå¾‹å®Ÿè¡ŒAgentï¼ˆã‚«ã‚¨ãƒ‡ã€ã‚µã‚¯ãƒ©ã€ãƒ„ãƒã‚­ã€ãƒœã‚¿ãƒ³ï¼‰
- **E7 (Command)**: Claude Codeã‚³ãƒãƒ³ãƒ‰ï¼ˆ`tmux send-keys`çµŒç”±ã§å®Ÿè¡Œï¼‰
- **E12 (Worktree)**: Git Worktreeï¼ˆä¸¦åˆ—å®Ÿè¡Œç’°å¢ƒï¼‰

ä¸»è¦Relationship:
- **R15**: Command invoked-by Agentï¼ˆã‚³ãƒãƒ³ãƒ‰ãŒAgentã‚’èµ·å‹•ï¼‰
- **R8**: Task runs-in Worktreeï¼ˆã‚¿ã‚¹ã‚¯ãŒWorktreeå†…ã§å®Ÿè¡Œï¼‰

è©³ç´°: [ENTITY_RELATION_MODEL.md](../docs/architecture/ENTITY_RELATION_MODEL.md)

---

## ğŸš€ æœ€é€Ÿã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆ3åˆ†ï¼‰

### Step 1: ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ

```bash
cd /Users/shunsuke/Dev/miyabi-private
./scripts/miyabi-orchestra-interactive.sh
```

### Step 2: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠ

```
é¸æŠã—ã¦ãã ã•ã„ [1/2/3/q]: 1  â† åˆã‚ã¦ã®æ–¹ã¯ã€Œ1ã€
```

### Step 3: Agentã‚’èµ·å‹•

```
é¸æŠ [y/n]: y  â† ã€Œyã€ã§è‡ªå‹•èµ·å‹•
é¸æŠ [1/2]: 1  â† å®‰å…¨ãƒ¢ãƒ¼ãƒ‰æ¨å¥¨
```

**å®Œäº†ï¼** ğŸ‰

---

## ğŸ“‹ ç”»é¢ã‚¤ãƒ¡ãƒ¼ã‚¸

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                              â•‘
â•‘           ğŸ­  Miyabi Parallel Orchestra  ğŸ­                  â•‘
â•‘                                                              â•‘
â•‘         21ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå¥ã§ã‚‹é›…ãªã‚‹ä¸¦åˆ—å®Ÿè¡Œ                 â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Step 1/3: ç’°å¢ƒãƒã‚§ãƒƒã‚¯

  âœ“ tmux session detected
  âœ“ Claude Code available
  âœ“ Kamui tmux detected (prefix: Ctrl-a)

  ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã«åˆæ ¼ã—ã¾ã—ãŸï¼

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Step 2/3: Ensembleã‚¿ã‚¤ãƒ—ã‚’é¸æŠ

  1) Coding Ensemble (æ¨å¥¨ - åˆå¿ƒè€…å‘ã‘)
     â†’ Conductor + 4 Coding Agents
     â†’ ç”¨é€”: Issueå®Ÿè£…ãƒ»ãƒã‚°ä¿®æ­£ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
     â†’ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: ã‚«ã‚¨ãƒ‡ãƒ»ã‚µã‚¯ãƒ©ãƒ»ãƒ„ãƒã‚­ãƒ»ãƒœã‚¿ãƒ³

  2) Hybrid Ensemble (ä¸Šç´šè€…å‘ã‘)
     â†’ Conductor + 3 Coding + 3 Business Agents
     â†’ ç”¨é€”: æŠ€è¡“å®Ÿè£… + ãƒ“ã‚¸ãƒã‚¹æˆ¦ç•¥åŒæ™‚å±•é–‹
     â†’ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: Coding 3å + Business 3å

  3) Quick Demo (3åˆ†ã§ãŠè©¦ã—)
     â†’ æœ€å°æ§‹æˆã§å‹•ä½œç¢ºèª
     â†’ Conductor + 1 Agent ã®ã¿

  q) çµ‚äº†

é¸æŠã—ã¦ãã ã•ã„ [1/2/3/q]: _
```

---

## ğŸ¯ å®Ÿè¡Œå¾Œã®æ“ä½œ

### ãƒ‘ã‚¿ãƒ¼ãƒ³A: ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆï¼ˆæ¨å¥¨ï¼‰

ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Œäº†å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹**ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆExample**ã‚’ã‚³ãƒ”ãƒšï¼š

```bash
# ã‚«ã‚¨ãƒ‡ï¼ˆAgent 1ï¼‰ã«ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯
tmux send-keys -t %2 "ã‚ãªãŸã¯ã€Œã‚«ã‚¨ãƒ‡ã€ã§ã™ã€‚è‡ªå·±ç´¹ä»‹ã‚’ã—ã¦ã€tmux send-keys -t %1 '[ã‚«ã‚¨ãƒ‡] æº–å‚™OK!' && sleep 0.1 && tmux send-keys -t %1 Enter ã§å ±å‘Šã—ã¦ãã ã•ã„" Enter
```

â†’ æ•°ç§’å¾Œã€Conductor paneï¼ˆã‚ãªãŸï¼‰ã«ã€Œ[ã‚«ã‚¨ãƒ‡] æº–å‚™OK!ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹

### ãƒ‘ã‚¿ãƒ¼ãƒ³B: å®Ÿè·µã‚¿ã‚¹ã‚¯

```bash
# ã‚«ã‚¨ãƒ‡ã«Issueå®Ÿè£…ã‚’ä¾é ¼
tmux send-keys -t %2 "Issue #270ã®ã‚³ãƒ¼ãƒ‰å®Ÿè£…ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚agent-executionã‚¹ã‚­ãƒ«ä½¿ç”¨ã€‚å®Œäº†å¾Œã¯[ã‚«ã‚¨ãƒ‡]ã§å ±å‘Šã—ã¦ãã ã•ã„" Enter
```

---

## ğŸ¨ paneæ“ä½œï¼ˆKamuiç‰ˆï¼‰

| æ“ä½œ | ã‚³ãƒãƒ³ãƒ‰ |
|------|---------|
| paneç§»å‹• | `Ctrl-a + çŸ¢å°ã‚­ãƒ¼` |
| paneç•ªå·è¡¨ç¤º | `Ctrl-a + q` |
| paneãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ | `Ctrl-a + z` |
| paneå‰Šé™¤ | `Ctrl-a + x` |

---

## ğŸ’¡ ã‚ˆãã‚ã‚‹è³ªå•

### Q1: ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸ

**ç—‡çŠ¶**: `tmux session not found`

**è§£æ±º**:
```bash
tmux
# ãã®å¾Œã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†å®Ÿè¡Œ
```

---

### Q2: AgentãŒåå¿œã—ãªã„

**ç¢ºèªæ–¹æ³•**:
```bash
# Agent paneã®çŠ¶æ…‹ã‚’ç¢ºèª
tmux capture-pane -t %2 -p | tail -10

# ã¾ãŸã¯ã€Ctrl-a + 2 ã§è©²å½“paneã«ç§»å‹•ã—ã¦ç›´æ¥ç¢ºèª
```

**å¯¾å‡¦**:
```bash
# Agentã®è¨˜æ†¶ã‚’ãƒªã‚»ãƒƒãƒˆ
tmux send-keys -t %2 "/clear" Enter

# å†åº¦ã‚¿ã‚¹ã‚¯ã‚’é€ä¿¡
```

---

### Q3: pane IDãŒåˆ†ã‹ã‚‰ãªã„

```bash
# å…¨paneä¸€è¦§è¡¨ç¤º
tmux list-panes -F "#{pane_index}: #{pane_id}"

# å‡ºåŠ›ä¾‹:
# 1: %1  â† Conductor (ã‚ãªãŸ)
# 2: %2  â† Agent 1 (ã‚«ã‚¨ãƒ‡)
# 3: %5  â† Agent 2 (ã‚µã‚¯ãƒ©)
```

---

### Q4: æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ãŸã„

```bash
# ç¾åœ¨ã®windowã‚’çµ‚äº†
Ctrl-a + &

# ã€Œyã€ã§ç¢ºèª

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†å®Ÿè¡Œ
./scripts/miyabi-orchestra-interactive.sh
```

---

## ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Level 1: åŸºç¤ï¼ˆå®Œäº†æ¸ˆã¿âœ“ï¼‰
- âœ… ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
- âœ… Agentèµ·å‹•
- âœ… ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯é€ä¿¡

### Level 2: å®Ÿè·µï¼ˆæ¬¡ã¯ã“ã‚Œï¼ï¼‰
```bash
# å®Ÿéš›ã®Issueå‡¦ç†
tmux send-keys -t %2 "Issue #270ã‚’å‡¦ç†ã—ã¦ãã ã•ã„" Enter

# è¤‡æ•°Agentã®é€£æº
tmux send-keys -t %2 "ã‚«ã‚¨ãƒ‡: Issue #270å®Ÿè£…" Enter
tmux send-keys -t %5 "ã‚µã‚¯ãƒ©: ã‚«ã‚¨ãƒ‡å®Œäº†å¾Œãƒ¬ãƒ“ãƒ¥ãƒ¼" Enter
tmux send-keys -t %3 "ãƒ„ãƒã‚­: ã‚µã‚¯ãƒ©å®Œäº†å¾ŒPRä½œæˆ" Enter
```

### Level 3: å¿œç”¨
- [MIYABI_PARALLEL_ORCHESTRA.md](../.claude/MIYABI_PARALLEL_ORCHESTRA.md) - å“²å­¦ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³
- [TMUX_OPERATIONS.md](../.claude/TMUX_OPERATIONS.md) - æŠ€è¡“è©³ç´°

---

## ğŸ­ ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ

### ã‚³ãƒãƒ³ãƒ‰æ—©è¦‹è¡¨

```bash
# AgentçŠ¶æ…‹ç¢ºèª
tmux capture-pane -t %2 -p | tail -10

# Agentã«ã‚¿ã‚¹ã‚¯é€ä¿¡
tmux send-keys -t %2 "[ã‚¿ã‚¹ã‚¯å†…å®¹]" Enter

# Agentè¨˜æ†¶ãƒªã‚»ãƒƒãƒˆ
tmux send-keys -t %2 "/clear" Enter

# paneä¸€è¦§
tmux list-panes -F "#{pane_index}: #{pane_id}"

# paneç§»å‹•ï¼ˆKamuiï¼‰
Ctrl-a + çŸ¢å°ã‚­ãƒ¼
```

### å ±å‘Šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

Agentã‹ã‚‰ã®å ±å‘Šã‚’å—ã‘ã‚‹ã«ã¯ã€ã‚¿ã‚¹ã‚¯æŒ‡ç¤ºã®æœ€å¾Œã«è¿½åŠ ï¼š

```bash
tmux send-keys -t %2 "\
ã‚ãªãŸã¯ã€Œã‚«ã‚¨ãƒ‡ã€ã§ã™ã€‚
Issue #270ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚
å®Œäº†å¾Œã¯ä»¥ä¸‹ã§å ±å‘Šï¼š

tmux send-keys -t %1 '[ã‚«ã‚¨ãƒ‡] Issue #270å®Œäº†' && sleep 0.1 && tmux send-keys -t %1 Enter
" Enter
```

---

## ğŸŒ¸ Miyabiã®ç¾å­¦

```
ä¸€äººã®ãƒã‚¹ã‚¿ãƒ¼ãŒå…¨ã¦ã‚’çµ±ã¹ã‚‹ã®ã§ã¯ãªãã€
å°‚é–€æ€§ã‚’æŒã¤21ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã€
ãã‚Œãã‚Œã®ç¾å­¦ã§æœ€å–„ã‚’å°½ãã—ã€
å…¨ä½“ã¨ã—ã¦èª¿å’Œã®ã¨ã‚ŒãŸæˆæœã‚’ç”Ÿã¿å‡ºã™ã€‚

ã“ã‚Œã“ããŒã€Œé›…ï¼ˆã¿ã‚„ã³ï¼‰ã€ãªã‚‹ä¸¦åˆ—å®Ÿè¡Œã€‚
```

---

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `./scripts/miyabi-orchestra-interactive.sh`
- **å“²å­¦ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³**: [MIYABI_PARALLEL_ORCHESTRA.md](../.claude/MIYABI_PARALLEL_ORCHESTRA.md)
- **æŠ€è¡“è©³ç´°**: [TMUX_OPERATIONS.md](../.claude/TMUX_OPERATIONS.md)
- **ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: [TMUX_LAYOUTS.md](./TMUX_LAYOUTS.md)

---

**ğŸ­ 3ã‚¹ãƒ†ãƒƒãƒ—ã§å§‹ã‚ã‚‹é›…ãªã‚‹ä¸¦åˆ—å®Ÿè¡Œ - Miyabi Orchestra**
