<mxfile host="app.diagrams.net" modified="2025-11-26T04:30:00.000Z" agent="Claude Code" version="24.0.0">
  <diagram name="Miyabi Society Backend Infrastructure" id="miyabi-infra">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Miyabi Society Backend Infrastructure - AWS Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="280" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- Client Layer -->
        <mxCell id="client" value="Users / Clients" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="440" y="80" width="280" height="60" as="geometry" />
        </mxCell>

        <!-- Internet Gateway -->
        <mxCell id="internet" value="Internet" style="ellipse;shape=cloud;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="490" y="160" width="180" height="80" as="geometry" />
        </mxCell>

        <!-- API Gateway -->
        <mxCell id="apigw" value="API Gateway HTTP API&lt;br&gt;ID: 2zdtm81iyl&lt;br&gt;Region: us-east-1&lt;br&gt;Endpoint: https://2zdtm81iyl.execute-api.us-east-1.amazonaws.com" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="270" width="360" height="90" as="geometry" />
        </mxCell>

        <!-- Lambda Function -->
        <mxCell id="lambda" value="AWS Lambda Function&lt;br&gt;Name: miyabi-api-production&lt;br&gt;Runtime: provided.al2 (Rust)&lt;br&gt;Memory: 512MB | Timeout: 30s&lt;br&gt;Package: 4.8MB (bootstrap.zip)&lt;br&gt;Status: âš ï¸ HTTP 500 (Debugging)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="380" y="400" width="400" height="120" as="geometry" />
        </mxCell>

        <!-- IAM Role -->
        <mxCell id="iam" value="IAM Role&lt;br&gt;miyabi-lambda-execution-role&lt;br&gt;Policy: AWSLambdaBasicExecutionRole" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="820" y="400" width="240" height="80" as="geometry" />
        </mxCell>

        <!-- CloudWatch Logs -->
        <mxCell id="cloudwatch" value="CloudWatch Logs&lt;br&gt;Log Group: /aws/lambda/miyabi-api-production&lt;br&gt;Status: âš ï¸ No logs (investigating)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="820" y="500" width="240" height="80" as="geometry" />
        </mxCell>

        <!-- RDS PostgreSQL -->
        <mxCell id="rds" value="Amazon RDS PostgreSQL 15.15&lt;br&gt;Instance ID: miyabi-postgres-prod&lt;br&gt;Endpoint: miyabi-postgres-prod.cileaca4iesh.us-east-1.rds.amazonaws.com&lt;br&gt;Class: db.t3.small | Storage: 20GB GP3&lt;br&gt;Multi-AZ: No | SSL: Required&lt;br&gt;Status: âœ… Available (7 migrations applied)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="330" y="580" width="500" height="120" as="geometry" />
        </mxCell>

        <!-- Security Group -->
        <mxCell id="sg" value="Security Group&lt;br&gt;sg-065ba77c858a02964&lt;br&gt;PostgreSQL Port: 5432&lt;br&gt;SSL/TLS Required" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="860" y="600" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- Build Server (MUGEN) -->
        <mxCell id="mugen" value="Build Server (MUGEN)&lt;br&gt;MacBook @ 44.250.27.197&lt;br&gt;Cargo Build: 3m 41s&lt;br&gt;Binary: 11MB â†’ 4.8MB (compressed)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="80" y="420" width="240" height="90" as="geometry" />
        </mxCell>

        <!-- Arrows -->
        <mxCell id="arrow1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#6C8EBF;" edge="1" parent="1" source="client" target="internet">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow2" value="HTTPS" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#6C8EBF;fontSize=10" edge="1" parent="1" source="internet" target="apigw">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow3" value="Lambda Proxy" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#D79B00;fontSize=10" edge="1" parent="1" source="apigw" target="lambda">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow4" value="Assume Role" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#B85450;fontSize=10;dashed=1" edge="1" parent="1" source="lambda" target="iam">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow5" value="Write Logs" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#9673A6;fontSize=10;dashed=1" edge="1" parent="1" source="lambda" target="cloudwatch">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow6" value="PostgreSQL&lt;br&gt;SSL/TLS" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#82B366;fontSize=10" edge="1" parent="1" source="lambda" target="rds">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow7" value="Protects" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#B85450;fontSize=10;dashed=1" edge="1" parent="1" source="sg" target="rds">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow8" value="Deploy&lt;br&gt;bootstrap.zip" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#D6B656;fontSize=10;dashed=1" edge="1" parent="1" source="mugen" target="lambda">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Cost Information -->
        <mxCell id="cost" value="ðŸ’° Estimated Monthly Cost&lt;br&gt;Lambda (1M requests): $0-5&lt;br&gt;API Gateway: $1&lt;br&gt;RDS db.t3.small: $25-30&lt;br&gt;Total: ~$26-36/month" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;align=left" vertex="1" parent="1">
          <mxGeometry x="80" y="560" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- Status Legend -->
        <mxCell id="legend" value="ðŸ“Š Status Legend&lt;br&gt;âœ… Operational&lt;br&gt;âš ï¸ Investigating&lt;br&gt;ðŸ”„ In Progress&lt;br&gt;âŒ Failed" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left" vertex="1" parent="1">
          <mxGeometry x="80" y="270" width="200" height="100" as="geometry" />
        </mxCell>

        <!-- Deployment Info -->
        <mxCell id="deploy-info" value="ðŸš€ Deployment Details&lt;br&gt;Region: us-east-1&lt;br&gt;Account: 211234825975&lt;br&gt;Date: 2025-11-26&lt;br&gt;Build Time: 3m 41s&lt;br&gt;Migrations: 7/7 âœ…" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;align=left" vertex="1" parent="1">
          <mxGeometry x="1100" y="270" width="200" height="130" as="geometry" />
        </mxCell>

        <!-- Issue Tracker -->
        <mxCell id="issues" value="âš ï¸ Current Issues&lt;br&gt;1. Lambda HTTP 500 errors&lt;br&gt;2. No CloudWatch logs&lt;br&gt;3. App initialization timeout?&lt;br&gt;4. DB connection from Lambda?&lt;br&gt;&lt;br&gt;Next Steps:&lt;br&gt;- Check Lambda logs&lt;br&gt;- Verify DB connectivity&lt;br&gt;- Test DATABASE_URL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;align=left" vertex="1" parent="1">
          <mxGeometry x="1100" y="430" width="200" height="200" as="geometry" />
        </mxCell>

        <!-- Progress Indicator -->
        <mxCell id="progress" value="ðŸ“ˆ Progress: 85% Complete&lt;br&gt;âœ… 11/13 tasks completed&lt;br&gt;&lt;br&gt;Completed:&lt;br&gt;â€¢ RDS provisioned&lt;br&gt;â€¢ Migrations applied&lt;br&gt;â€¢ Lambda deployed&lt;br&gt;â€¢ API Gateway configured&lt;br&gt;&lt;br&gt;In Progress:&lt;br&gt;â€¢ Lambda debugging&lt;br&gt;&lt;br&gt;Pending:&lt;br&gt;â€¢ CloudFront update" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left" vertex="1" parent="1">
          <mxGeometry x="1100" y="660" width="200" height="200" as="geometry" />
        </mxCell>

        <!-- Footer -->
        <mxCell id="footer" value="Miyabi Society Backend - Phase 0 Infrastructure | Generated: 2025-11-26 | AWS Architecture Diagram" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="280" y="730" width="600" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
