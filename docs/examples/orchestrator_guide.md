# Miyabi Multi-Agent Orchestrator ã‚¬ã‚¤ãƒ‰

> CCG (Claude Code) + CG (Codex) ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ğŸ¯ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã¯

Miyabiã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€**Claude Codeï¼ˆCCGï¼‰** ã¨ **OpenAI Codexï¼ˆCGï¼‰** ã®ä¸¡æ–¹ã®AIã‚·ã‚¹ãƒ†ãƒ ã‚’çµ±ä¸€çš„ã«èª¿æ•´ã—ã€ãã‚Œãã‚Œã®å¼·ã¿ã‚’æœ€å¤§é™ã«æ´»ç”¨ã™ã‚‹ãŸã‚ã®ä¸­æ ¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Miyabi ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ (A2Aã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤)  â”‚
â”‚  - ã‚¿ã‚¹ã‚¯åˆ†è§£                                 â”‚
â”‚  - ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°                               â”‚
â”‚  - çµæœé›†ç´„                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
       â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚CCGã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼â”‚  â”‚CGã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ â”‚
â”‚(Claude Code) â”‚  â”‚  (Codex)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”        â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   â†“       â†“        â†“       â†“
 è¨ˆç”»   æ¢ç´¢      é–‹ç™º    ãƒ†ã‚¹ãƒˆ
```

## ğŸ“‹ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå½¹å‰²åˆ†æ‹…

| å½¹å‰² | ã‚·ã‚¹ãƒ†ãƒ  | ãƒ¢ãƒ‡ãƒ« | è²¬å‹™ | å¼·ã¿ |
|------|---------|--------|------|------|
| **ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼** | CCG | Opus | ã‚¿ã‚¹ã‚¯åˆ†è§£ã€DAGä½œæˆ | é•·ã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ200kï¼‰ã€æ·±ã„æ¨è«– |
| **ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼** | CCG | Opus | ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ | è¨ˆç”»ãƒ¢ãƒ¼ãƒ‰ã€å…¨ä½“ä¿¯ç° |
| **ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼** | CCG | Haiku | ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹åˆ†æ | é«˜é€Ÿæ¤œç´¢ã€ã‚³ã‚¹ãƒˆåŠ¹ç‡ï¼ˆSonnetã®1/3ï¼‰ |
| **ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼** | CG | GPT-5 | ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ | å‰µé€ çš„ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã€æ§‹é€ åŒ–å‡ºåŠ› |
| **ãƒ†ã‚¹ã‚¿ãƒ¼** | CG | GPT-5 | ãƒ†ã‚¹ãƒˆä½œæˆ | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆã€ç¶²ç¾…çš„ãƒ†ã‚¹ãƒˆ |
| **ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼** | CCG | Opus | å“è³ªä¿è¨¼ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | æ·±ã„åˆ†æã€ãƒªã‚¹ã‚¯è©•ä¾¡ |

## ğŸ”‘ ç´”ç²‹ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

### 3ã¤ã®é‰„å‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨     â”‚
â”‚                                                 â”‚
â”‚  1. ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã                                â”‚
â”‚  2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥èª­ã‚€                          â”‚
â”‚  3. ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹                            â”‚
â”‚  4. ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã                      â”‚
â”‚                                                 â”‚
â”‚  â†’ ã“ã‚Œã‚‰ã¯å…¨ã¦å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å§”è­²ï¼        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã®å”¯ä¸€ã®è²¬å‹™              â”‚
â”‚                                                 â”‚
â”‚  1. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªè¨ˆç”»ã‚’ä¿æŒ                      â”‚
â”‚  2. å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®ã‚¿ã‚¹ã‚¯å§”è­²              â”‚
â”‚  3. çµæœã®é›†ç´„ã¨èª¿æ•´                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šBAD vs GOOD

#### âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```python
class BadOrchestrator:
    async def implement_feature(self, requirement):
        # ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼è‡ªèº«ãŒã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ã‚‹ï¼
        code = f"""
        def authenticate(user):
            # å®Ÿè£…...
        """
        return code  # âŒ ãƒ€ãƒ¡ï¼
```

#### âœ… æ­£ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³

```python
class GoodOrchestrator:
    async def implement_feature(self, requirement):
        # 1. æ¢ç´¢ï¼ˆCCG Haikuã«å§”è­²ï¼‰
        context = await self.ccg_explorer.query(
            "èªè¨¼é–¢é€£ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦æ¤œç´¢"
        )

        # 2. è¨ˆç”»ï¼ˆCCG Opusã«å§”è­²ï¼‰
        plan = await self.ccg_planner.query(
            f"ä»¥ä¸‹ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å®Ÿè£…è¨ˆç”»ã‚’ç«‹æ¡ˆ:\n{context}"
        )

        # 3. å®Ÿè£…ï¼ˆCG GPT-5ã«å§”è­²ï¼‰- ä¸¦åˆ—å®Ÿè¡Œ
        results = await asyncio.gather(
            self.cg_developer.query(plan.backend_spec),
            self.cg_developer.query(plan.frontend_spec),
            self.cg_tester.query(plan.test_spec)
        )

        # 4. ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆCCG Opusã«å§”è­²ï¼‰
        review = await self.ccg_reviewer.query(
            f"å®Ÿè£…ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼:\n{results}"
        )

        return review  # âœ… æ­£ã—ã„ï¼
```

## ğŸ¨ å”èª¿ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãƒãƒ³ãƒ‰ã‚ªãƒ•

```
CCG Explorer â†’ CCG Planner â†’ CG Developer â†’ CCG Reviewer
(æ¢ç´¢)        (è¨ˆç”»)         (å®Ÿè£…)         (ãƒ¬ãƒ“ãƒ¥ãƒ¼)
```

**ç”¨é€”**: æ®µéšçš„ã«å“è³ªã‚’ç©ã¿ä¸Šã’ã‚‹é–‹ç™ºãƒ•ãƒ­ãƒ¼

```python
# ãƒ•ã‚§ãƒ¼ã‚º1: CCGæ¢ç´¢
context = await ccg_explorer.query("èªè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œç´¢")

# ãƒ•ã‚§ãƒ¼ã‚º2: CCGè¨ˆç”»
plan = await ccg_planner.query(f"å®Ÿè£…è¨ˆç”»: {context}")

# ãƒ•ã‚§ãƒ¼ã‚º3: CGå®Ÿè£…
impl = await cg_developer.query(f"å®Ÿè£…: {plan}")

# ãƒ•ã‚§ãƒ¼ã‚º4: CCGãƒ¬ãƒ“ãƒ¥ãƒ¼
review = await ccg_reviewer.query(f"ãƒ¬ãƒ“ãƒ¥ãƒ¼: {impl}")
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ä¸¦åˆ—å®Ÿè¡Œ

```
         Orchestrator
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“         â†“         â†“
CCG Explore  CG Dev  CCG Security
(èª¿æŸ»)       (å®Ÿè£…)  (ç›£æŸ»)
    â”‚         â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
        çµæœçµ±åˆ
```

**ç”¨é€”**: ç‹¬ç«‹ã—ãŸã‚¿ã‚¹ã‚¯ã‚’é«˜é€Ÿå‡¦ç†

```python
# ç‹¬ç«‹ã‚¿ã‚¹ã‚¯ã‚’ä¸¦åˆ—å®Ÿè¡Œ
results = await asyncio.gather(
    ccg_explorer.query("èªè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œç´¢"),
    cg_developer.query("ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ"),
    ccg_security.query("ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼")
)

# çµæœã‚’çµ±åˆ
synthesis = await ccg_coordinator.query(
    f"èª¿æŸ»çµæœã‚’çµ±åˆ: {results}"
)
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ç«¶åˆæ¤œè¨¼

```
CG Developer (å®Ÿè£…A)  â”€â”€â”
                       â”œâ†’ CCG Reviewer â†’ æœ€è‰¯ã‚’é¸æŠ
CCG Developer (å®Ÿè£…B) â”€â”€â”˜
```

**ç”¨é€”**: é‡è¦ãªå®Ÿè£…ã§è¤‡æ•°æ¡ˆã‚’æ¯”è¼ƒ

```python
# 2ã¤ã®ã‚·ã‚¹ãƒ†ãƒ ã§ç‹¬ç«‹ã«å®Ÿè£…
impl_cg = await cg_developer.query("èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…")
impl_ccg = await ccg_developer.query("èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…")

# CCGã§ã‚¯ãƒ­ã‚¹ãƒ¬ãƒ“ãƒ¥ãƒ¼
review_a = await ccg_reviewer.query(f"ãƒ¬ãƒ“ãƒ¥ãƒ¼: {impl_cg}")
review_b = await ccg_reviewer.query(f"ãƒ¬ãƒ“ãƒ¥ãƒ¼: {impl_ccg}")

# æœ€è‰¯ã®å®Ÿè£…ã‚’é¸æŠ
best = select_best_implementation(review_a, review_b)
```

## ğŸ“Š ã‚¿ã‚¹ã‚¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ— | æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ  | ç†ç”± | ä»£æ›¿ |
|------------|------------|------|------|
| ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ | CCG (Opus) | æ·±ã„æ¨è«–ã€é•·ã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ | â€” |
| ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹æ¢ç´¢ | CCG (Haiku) | é«˜é€Ÿã€ã‚³ã‚¹ãƒˆåŠ¹ç‡ï¼ˆSonnetã®1/3ï¼‰ | CCG (Sonnet) |
| æ–°æ©Ÿèƒ½å®Ÿè£… | CG (GPT-5) | å‰µé€ çš„ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ | CCG (Sonnet) |
| ãƒã‚°ä¿®æ­£ | CCG (Sonnet) | åˆ†æåŠ›ã¨å®Ÿè£…ã®ãƒãƒ©ãƒ³ã‚¹ | CG |
| ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° | CCG (Opus) | åºƒç¯„ãªå½±éŸ¿åˆ†æ | â€” |
| ãƒ†ã‚¹ãƒˆä½œæˆ | CG | æ§‹é€ åŒ–å‡ºåŠ›ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | CCG (Sonnet) |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ» | CCG (Opus) | æ·±ã„åˆ†æã€ãƒªã‚¹ã‚¯è©•ä¾¡ | â€” |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | CCG | é•·æ–‡ç”Ÿæˆã€ä¸€è²«æ€§ | CG |

### å‹•çš„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯

```python
class TaskRouter:
    def route(self, task: Task) -> Agent:
        # è¤‡é›‘æ€§ã«åŸºã¥ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
        if task.complexity > 0.8:
            return self.ccg_opus  # æœ€é«˜ã®æ¨è«–åŠ›

        # ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã«åŸºã¥ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
        if task.type == "exploration":
            return self.ccg_haiku  # é«˜é€Ÿæ¢ç´¢
        elif task.type == "code_generation":
            if task.requires_creativity:
                return self.cg_gpt5  # å‰µé€ çš„ç”Ÿæˆ
            return self.ccg_sonnet  # ãƒãƒ©ãƒ³ã‚¹å‹
        elif task.type == "security_review":
            return self.ccg_opus  # å¸¸ã«Opus

        # ã‚³ã‚¹ãƒˆæœ€é©åŒ–
        if task.budget_constrained:
            return self.ccg_haiku

        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
        return self.ccg_sonnet
```

## ğŸš€ å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### Step 1: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆæœŸåŒ–

```python
from miyabi_orchestrator import MultiAgentOrchestrator

# CCGã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
ccg_agents = {
    'explorer': Agent(model='claude-haiku-4.5', tools=['Read', 'Grep', 'Glob']),
    'planner': Agent(model='claude-opus-4.5', mode='plan'),
    'reviewer': Agent(model='claude-opus-4.5', tools=['Read', 'Bash'])
}

# CGã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
cg_agents = {
    'developer': Agent(model='gpt-5', mcp_servers=['codex-mcp']),
    'tester': Agent(model='gpt-5', output_format='structured')
}

# ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼åˆæœŸåŒ–
orchestrator = MultiAgentOrchestrator(
    ccg_agents=ccg_agents,
    cg_agents=cg_agents
)
```

### Step 2: ã‚¿ã‚¹ã‚¯å®šç¾©ã¨è¿½åŠ 

```python
from miyabi_orchestrator import Task, TaskType

# Explore-Plan-Code-Commitãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
tasks = [
    Task(
        task_id="T001",
        task_type=TaskType.EXPLORATION,
        description="èªè¨¼é–¢é€£ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦æ¤œç´¢ã—ã€ç¾çŠ¶ã‚’æŠŠæ¡"
    ),
    Task(
        task_id="T002",
        task_type=TaskType.PLANNING,
        description="OAuth2.0èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…è¨ˆç”»ã‚’ç«‹æ¡ˆ"
    ),
    Task(
        task_id="T003",
        task_type=TaskType.CODE_GENERATION,
        description="èªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…"
    ),
    Task(
        task_id="T004",
        task_type=TaskType.TESTING,
        description="èªè¨¼ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆä½œæˆ"
    ),
    Task(
        task_id="T005",
        task_type=TaskType.REVIEW,
        description="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½"
    )
]

for task in tasks:
    orchestrator.add_task(task)
```

### Step 3: ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼å‡¦ç†

```python
# ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼å‡¦ç†ï¼ˆä¸¦åˆ—å®Ÿè¡Œæœ€é©åŒ–ï¼‰
results = await orchestrator.process_queue()

# çµ±è¨ˆæƒ…å ±
stats = orchestrator.get_statistics()
print(f"æˆåŠŸç‡: {stats['success_rate']:.1%}")
print(f"ç·ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡: {stats['total_tokens']:,}")
print(f"ç·ã‚³ã‚¹ãƒˆ: ${stats['total_cost']:.2f}")
```

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. Explore-Plan-Code-Commit ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¢ç´¢      â”‚ â†’  â”‚  è¨ˆç”»    â”‚ â†’  â”‚  å®Ÿè£…      â”‚ â†’  â”‚  ã‚³ãƒŸãƒƒãƒˆâ”‚
â”‚ CCG Haiku  â”‚    â”‚ CCG Opus â”‚    â”‚ CG GPT-5   â”‚    â”‚CCGãƒ¬ãƒ“ãƒ¥ãƒ¼â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãªãœé‡è¦ï¼Ÿ**
- æ—©æœŸã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’é˜²æ­¢
- ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®è³ªãŒå‘ä¸Š
- è¤‡é›‘ãªå•é¡Œã®æˆåŠŸç‡ãŒå¤§å¹…æ”¹å–„

### 2. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†

#### CLAUDE.mdæ´»ç”¨ã§32.3%ãƒˆãƒ¼ã‚¯ãƒ³å‰Šæ¸›

```markdown
# CLAUDE.md

## ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰
- `cargo build` - ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰
- `cargo test` - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

## ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«
- ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ: 2ã‚¹ãƒšãƒ¼ã‚¹
- å‘½åè¦å‰‡: snake_case (Rust)

## ç¦æ­¢äº‹é …
- æœ¬ç•ªDBã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
- ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸèªè¨¼æƒ…å ±
```

#### é¸æŠçš„æƒ…å ±ä¼é”

```python
# âŒ BAD: å…¨å±¥æ­´ã‚’æ¸¡ã™
await spawn_subagent(
    task=task,
    context=parent.full_conversation_history  # âŒ
)

# âœ… GOOD: å¿…è¦ãªæƒ…å ±ã®ã¿
await spawn_subagent(
    task=task,
    context={
        "current_file": current_file,
        "specific_requirements": requirements
    }
)
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```python
class ResilientExecutor:
    async def execute(self, task: Task) -> Result:
        # Layer 1: ãƒ—ãƒ©ã‚¤ãƒãƒªå®Ÿè¡Œ
        try:
            return await self.primary_agent.query(task)
        except TimeoutError:
            logger.warning("ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ")

        # Layer 2: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
        try:
            return await self.fallback_agent.query(task)
        except Exception as e:
            logger.error(f"ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¤±æ•—: {e}")

        # Layer 3: åˆ†å‰²å®Ÿè¡Œ
        try:
            subtasks = await self.decompose_task(task)
            results = []
            for subtask in subtasks:
                result = await self.execute(subtask)  # å†å¸°
                results.append(result)
            return self.aggregate_results(results)
        except Exception:
            # Layer 4: äººé–“ã¸ã®ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            return await self.escalate_to_human(task)
```

## ğŸ“ å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `docs/miyabi-ccg-cg-coordination-ja.pdf` - æœ¬ã‚¬ã‚¤ãƒ‰ã®å…ƒã¨ãªã‚‹åŒ…æ‹¬çš„ä»•æ§˜æ›¸ï¼ˆ34ãƒšãƒ¼ã‚¸ï¼‰
- `docs/examples/orchestrator_example.py` - å®Ÿè£…ã‚µãƒ³ãƒ—ãƒ«

### é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- `.claude/agents/` - CCGã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©
- `~/.codex/agents.toml` - CGã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
- `miyabi-mcp-server` - A2Aãƒ—ãƒ­ãƒˆã‚³ãƒ«å®Ÿè£…

## âš¡ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã«ç§»å‹•
cd ~/Dev/01-miyabi/_core/miyabi-private

# 2. ã‚µãƒ³ãƒ—ãƒ«å®Ÿè¡Œ
python3 docs/examples/orchestrator_example.py

# 3. çµ±è¨ˆæƒ…å ±ç¢ºèª
# æˆåŠŸç‡: 100.0%
# ç·ã‚¿ã‚¹ã‚¯æ•°: 6
```

## ğŸ”— æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **å®Ÿè£…ã‚’è©¦ã™**: `orchestrator_example.py`ã‚’å®Ÿè¡Œ
2. **ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**: ç‹¬è‡ªã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’è¿½åŠ 
3. **çµ±åˆ**: Miyabiãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«çµ„ã¿è¾¼ã‚€
4. **æœ€é©åŒ–**: ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥ã‚’èª¿æ•´

---

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**æœ€çµ‚æ›´æ–°**: 2025-11-30
**ãƒ¡ãƒ³ãƒ†ãƒŠãƒ¼**: Miyabié–‹ç™ºãƒãƒ¼ãƒ 
