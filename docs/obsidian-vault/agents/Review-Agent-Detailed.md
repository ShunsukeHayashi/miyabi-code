---
title: "Review Agent (ã‚ã ã¾ã‚“) - Complete Specification"
created: 2025-11-20
updated: 2025-11-20
author: "Claude Code"
category: "agents"
tags: ["miyabi", "agents", "agent-coding", "review", "quality", "security"]
status: "published"
aliases: ["ReviewAgent", "ã‚ã ã¾ã‚“", "Review"]
authority: "ğŸŸ¢ Execution"
parallel: "âœ… Parallel OK"
---

# Review Agent (ã‚ã ã¾ã‚“) - ã‚³ãƒ¼ãƒ‰å“è³ªåˆ¤å®šAgent

> é™çš„è§£æãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ãƒ»å“è³ªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚° - 80ç‚¹åˆæ ¼ãƒ©ã‚¤ãƒ³

---

## ğŸ­ æ¦‚è¦

**æ­£å¼åç§°**: ReviewAgent
**æ„›ç§°**: ã‚ã ã¾ã‚“
**å½¹å‰²**: ğŸŸ¢ å®Ÿè¡Œ - å“è³ªã‚’å®ˆã‚‹
**ä¸¦åˆ—å®Ÿè¡Œ**: âœ… å¯èƒ½ï¼ˆWorktreeåˆ†é›¢ã«ã‚ˆã‚Šä¸¦è¡Œå®Ÿè¡ŒOKï¼‰
**æ¨©é™**: ğŸ”µ å®Ÿè¡Œæ¨©é™ï¼ˆåˆå¦åˆ¤å®šã®æœ€çµ‚æ±ºå®šæ¨©ï¼‰

**é–¢é€£**: [[2025-11-20-agents-system-guide#3 ã‚ã ã¾ã‚“ï¼ˆReviewAgentï¼‰ ğŸŸ¢|Agents System ã‚¬ã‚¤ãƒ‰]]

---

## ğŸ“š å®Œå…¨ãªä»•æ§˜æ›¸

ã“ã® Agent ã®å®Œå…¨ãªæŠ€è¡“ä»•æ§˜ã€æ¤œæŸ»é …ç›®ã€ä¿®æ­£ææ¡ˆä¾‹ã«ã¤ã„ã¦ã¯ã€å…ƒã®ä»•æ§˜æ›¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„:

**ğŸ“ è©³ç´°ä»•æ§˜**: `.claude/agents/specs/coding/review-agent.md`

**ä¸»ãªå†…å®¹**:
- âœ… å“è³ªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- âœ… 32 Clippy lintsè©³ç´°
- âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆSecretæ¤œå‡ºãƒ»è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
- âœ… ä¿®æ­£ææ¡ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- âœ… ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¡ä»¶

---

## ğŸ”‘ ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ

### 1. å“è³ªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 

```yaml
Base Score: 100ç‚¹
åˆæ ¼ãƒ©ã‚¤ãƒ³: 80ç‚¹ä»¥ä¸Š

æ¸›ç‚¹ãƒ«ãƒ¼ãƒ«:
  - Criticalè„†å¼±æ€§: -40ç‚¹/ä»¶
  - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼: -30ç‚¹/ä»¶
  - Clippy Error: -20ç‚¹/ä»¶
  - Highè„†å¼±æ€§: -20ç‚¹/ä»¶
  - Clippy Warning: -10ç‚¹/ä»¶
  - Mediumè„†å¼±æ€§: -10ç‚¹/ä»¶
```

**ã‚¹ã‚³ã‚¢ç®—å‡ºä¾‹**:
```
100ç‚¹
- Clippy Warning x2: -20ç‚¹
- Mediumè„†å¼±æ€§ x1: -10ç‚¹
= 70ç‚¹ â†’ âŒ ä¸åˆæ ¼ï¼ˆ80ç‚¹æœªæº€ï¼‰
```

---

### 2. æ¤œæŸ»é …ç›®ï¼ˆ5ã‚«ãƒ†ã‚´ãƒªï¼‰

| ã‚«ãƒ†ã‚´ãƒª | æ¤œæŸ»å†…å®¹ | ãƒ„ãƒ¼ãƒ« |
|---------|----------|--------|
| **Clippy** | 32 lintsï¼ˆunwrapç¦æ­¢ãªã©ï¼‰ | `cargo clippy` |
| **Cargo Check** | å‹ãƒã‚§ãƒƒã‚¯ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« | `cargo check/build` |
| **Secretæ¤œå‡º** | APIã‚­ãƒ¼ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³æ¼æ´© | Regex patterns |
| **è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³** | unsafe, unwrap, printç­‰ | Custom scanner |
| **cargo audit** | ä¾å­˜é–¢ä¿‚ã®æ—¢çŸ¥è„†å¼±æ€§ | `cargo audit` |

**é–¢é€£**: [[security-audit-guide|ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚¬ã‚¤ãƒ‰]]

---

### 3. Auto-Loop Patternï¼ˆNacho's Approachï¼‰

```
ã‚ã ã¾ã‚“èµ·å‹•
  â†“
å“è³ªã‚¹ã‚³ã‚¢ç®—å‡º
  â†“
80ç‚¹æœªæº€? â”€â”€YESâ†’ ã¤ãã‚‹ã‚“ã¸ä¿®æ­£è¦æ±‚
  â†“               â†“
  NO            ä¿®æ­£å®Ÿè£…
  â†“               â†“
åˆæ ¼ï¼          å†è©•ä¾¡ï¼ˆæœ€å¤§3å›ï¼‰
```

**é–¢é€£**: [[auto-loop-pattern|Auto-Loopãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´°]]

---

### 4. è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | ãƒªã‚¹ã‚¯ | Severity | æ¸›ç‚¹ |
|---------|-------|----------|-----|
| `.unwrap()` | ãƒ‘ãƒ‹ãƒƒã‚¯ | Critical | -40ç‚¹ |
| `.expect()` | ãƒ‘ãƒ‹ãƒƒã‚¯ | Critical | -40ç‚¹ |
| `unsafe { }` | ãƒ¡ãƒ¢ãƒªå®‰å…¨æ€§ | Critical | -40ç‚¹ |
| `print!()`/`println!()` | stdoutæ±šæŸ“ | High | -20ç‚¹ |
| `std::process::Command` | Injection | High | -20ç‚¹ |

---

## ğŸ”„ å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### Standard Flow

```mermaid
graph TD
    A[ã¤ãã‚‹ã‚“å®Œäº†] --> B[ã‚ã ã¾ã‚“èµ·å‹•]
    B --> C1[Clippyå®Ÿè¡Œ]
    B --> C2[cargo check/build]
    B --> C3[Secretæ¤œå‡º]
    B --> C4[è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³]
    B --> C5[cargo audit]

    C1 --> D[å“è³ªã‚¹ã‚³ã‚¢ç®—å‡º]
    C2 --> D
    C3 --> D
    C4 --> D
    C5 --> D

    D --> E{80ç‚¹ä»¥ä¸Š?}
    E -->|YES| F[âœ… åˆæ ¼ â†’ ã¾ã¨ã‚ã‚‹ã‚“ã¸]
    E -->|NO| G[âŒ ä¸åˆæ ¼ â†’ ã¤ãã‚‹ã‚“ã¸]

    G --> H{å†è©¦è¡Œå›æ•°<3?}
    H -->|YES| I[ä¿®æ­£è¦æ±‚]
    H -->|NO| J[TechLeadã¸ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³]
```

**å®Ÿè¡Œæ™‚é–“**: é€šå¸¸15-30ç§’

---

### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# 1. ReviewAgentå˜ä½“å®Ÿè¡Œ
cargo run --bin miyabi-cli -- agent review --files="crates/**/*.rs"

# 2. CodeGenAgentå¾Œã«è‡ªå‹•å®Ÿè¡Œ
cargo run --bin miyabi-cli -- agent execute --issue 270
# â†’ ã¤ãã‚‹ã‚“ â†’ ã‚ã ã¾ã‚“ ã®é †ã§è‡ªå‹•å®Ÿè¡Œ

# 3. Auto-Loopãƒ¢ãƒ¼ãƒ‰ï¼ˆè‡ªå‹•ä¿®æ­£ï¼‰
cargo run --bin miyabi-cli -- agent execute --issue 270 --auto-fix
```

---

## ğŸš¨ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### â†’ CISO (Sev.1-Critical)

- Criticalè„†å¼±æ€§æ¤œå‡ºï¼ˆAPIã‚­ãƒ¼æ¼æ´©ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ç­‰ï¼‰
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼é•å
- ãƒ‡ãƒ¼ã‚¿æ¼æ´©ãƒªã‚¹ã‚¯

### â†’ TechLead (Sev.2-High)

- Clippyè­¦å‘Šå¤šæ•°ï¼ˆ10ä»¶ä»¥ä¸Šï¼‰
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ•´åˆæ€§é•å
- å“è³ªã‚¹ã‚³ã‚¢50ç‚¹æœªæº€ï¼ˆé‡å¤§å“è³ªå•é¡Œï¼‰

**é–¢é€£**: [[escalation-protocol|ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ãƒˆã‚³ãƒ«]]

---

## ğŸ“Š ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆå‡ºåŠ›

### GitHub PR ã‚³ãƒ¡ãƒ³ãƒˆå½¢å¼

```markdown
## ğŸ” ReviewAgent å“è³ªãƒ¬ãƒãƒ¼ãƒˆ

### å“è³ªã‚¹ã‚³ã‚¢: 85/100 âœ… **åˆæ ¼**

### ã‚¹ã‚³ã‚¢å†…è¨³
- **Clippy**: 90ç‚¹ (2 warnings)
- **Cargo Check/Build**: 100ç‚¹ (0 errors)
- **Security**: 80ç‚¹ (1 medium issue)
- **Test Coverage**: 85ç‚¹

### æ¤œå‡ºã•ã‚ŒãŸå•é¡Œ

#### crates/miyabi-core/src/validator.rs:102
**[SECURITY]** Use of unwrap() detected
- Severity: high
- Suggestion: Replace unwrap() with proper error handling

### æ¨å¥¨äº‹é …
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’85% â†’ 90%ã«æ”¹å–„æ¨å¥¨
- Highè„†å¼±æ€§ã‚’ä¿®æ­£ã—ã¦ãã ã•ã„
```

---

## ğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹

| æŒ‡æ¨™ | ç›®æ¨™ | å®Ÿç¸¾ |
|------|------|------|
| å®Ÿè¡Œæ™‚é–“ | 15-30ç§’ | 22ç§’ |
| ã‚¹ã‚­ãƒ£ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«æ•° | 10-50 | 28 |
| False Positiveç‡ | <5% | 3.2% |
| åˆæ ¼ç‡ | 85% | 87% |

---

## ğŸ”— é–¢é€£Agent

### é€£æºãƒ•ãƒ­ãƒ¼

```
[[CoordinatorAgent|ã—ãã‚‹ã‚“]]ï¼ˆã‚¿ã‚¹ã‚¯åˆ†è§£ï¼‰
  â†“
[[CodeGenAgent|ã¤ãã‚‹ã‚“]]ï¼ˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼‰
  â†“
ã‚ã ã¾ã‚“ï¼ˆå“è³ªæ¤œè¨¼ï¼‰â† ã“ã®Agent
  â†“ (Auto-Loop)
ã¤ãã‚‹ã‚“ï¼ˆä¿®æ­£å®Ÿè£…ï¼‰
  â†“
ã‚ã ã¾ã‚“ï¼ˆå†è©•ä¾¡ï¼‰
  â†“
[[PRAgent|ã¾ã¨ã‚ã‚‹ã‚“]]ï¼ˆPRä½œæˆï¼‰
```

---

## ğŸ“ é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [[2025-11-20-agents-system-guide|Agents Systemå®Œå…¨ã‚¬ã‚¤ãƒ‰]]
- [[auto-loop-pattern|Auto-Loopãƒ‘ã‚¿ãƒ¼ãƒ³]]
- [[security-audit-guide|ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚¬ã‚¤ãƒ‰]]
- [[quality-scoring-system|å“è³ªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ]]

---

**è©³ç´°ä»•æ§˜**: `/Users/shunsuke/Dev/01-miyabi/_core/miyabi-private/.claude/agents/specs/coding/review-agent.md`

---

#miyabi #agents #agent-coding #review #quality #security

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
