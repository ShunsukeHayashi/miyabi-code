@startuml industry_facility_経理部
!theme cerulean-outline

title 設備工事業 経理部 業務フロー

skinparam swimlaneWidth 250
skinpaker swimlaneHeight 80

swimlane 経理課長 {
  :案件情報受領（営業から）;
  -> 原価情報収集;
  -> 見積原価計算;
  -> 利益率設定;
  :見積金額決定;
}

swimlane 経理事務 {
  start
  :見積依頼受領;
  -> 顧客情報確認;
  -> 過去案件参照;
  -> 材料費見積;
  note right
    材料見積先
    - 配管メーカー
    - 電線メーカー
    - ダクトメーカー
    - 保温材メーカー
  end note
}

swimlane 仕入先 {
  :見積依頼受領;
  -> 品目確認;
  -> 価格確認;
  :見積金額回答;
}

swimlane 経理事務（続き） {
  :仕入先回答を集約;
  -> 最安業者選定;
  -> 労務費計算;
  note right
    労務費
    - 配管工事人数/日数
    - 電気工事人数/日数
    - 仮設費
    - 管理費
  end note
  -> 機械・工具レンタル費;
  -> 運搬費計算;
}

swimlane 経理課長（見積） {
  :見積原価確認;
  -> 利益率計算;
  -> 見積金額決定;
  :営業に見積提出;
}

swimlane 営業部 {
  :見積資料受取;
  -> 顧客プレゼン;
  if (受注?) then (受注)
    -> 契約手続き;
  else (失注)
    -> 提案改善;
  endif
}

swimlane 経理課長（受注後） {
  :受注通知受領;
  -> 契約書確認;
  -> 請求内容確定;
  :工事原価管理開始;
}

swimlane 経理事務（原価管理） {
  :実績原価把握;
  -> 材料仕入実績;
  -> 労務実績（給与）;
  -> 外注費（下請け）;
  -> 機械レンタル費;
  :実績原価集計;
}

swimlane 工事部 {
  :施工完了報告;
  -> 工事報告書提出;
  -> 労務日数報告;
  -> 外注内容報告;
  :最終原価確定;
}

swimlane 経理課長（精算） {
  :実績原価確認;
  -> 利益率確認;
  -> 差異分析;
  :請求書作成;
}

swimlane 経理事務（請求） {
  :請求書発行;
  -> 工事内容記載;
  -> 金額記載;
  -> 支払期限記載;
  :顧客に送付;
}

swimlane 営業部（入金） {
  :入金確認;
  -> 顧客との入金協議;
  if (遅延?) then (あり)
    -> 催促連絡;
  else (なし)
    -> 記録;
  endif
}

swimlane 経理事務（入金管理） {
  :入金照合;
  -> 売上計上;
  -> 売掛金管理;
  :月間売上報告;
}

swimlane 経理課長（決算） {
  :月間利益集計;
  -> 原価率分析;
  -> 利益率分析;
  -> 部門別実績;
  :月報作成;
}

swimlane 経営管理層 {
  :月報確認;
  -> 利益分析;
  -> 経営判断;
  :翌月方針指示;
}

@enduml
