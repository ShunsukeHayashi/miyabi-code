# Plans for Issue #402

**Title**: üìÑ [Sub-Issue #396] Phase 5: „Éï„É´„Çπ„Ç±„Éº„É´Ë©ï‰æ°Ôºà731„Ç§„É≥„Çπ„Çø„É≥„ÇπÂÖ®Ë©ï‰æ°Ôºâ

**URL**: https://github.com/customer-cloud/miyabi-private/issues/402

---

## üìã Summary

- **Total Tasks**: 4
- **Estimated Duration**: 60 minutes
- **Execution Levels**: 4
- **Has Cycles**: ‚úÖ No

## üìù Task Breakdown

### 1. Analyze requirements for #402

- **ID**: `task-402-analysis`
- **Type**: Docs
- **Assigned Agent**: IssueAgent
- **Priority**: 0
- **Estimated Duration**: 5 min

**Description**: Analyze issue requirements and create detailed specification

### 2. Implement solution for #402

- **ID**: `task-402-impl`
- **Type**: Deployment
- **Assigned Agent**: CodeGenAgent
- **Priority**: 1
- **Estimated Duration**: 30 min
- **Dependencies**: task-402-analysis

**Description**: ## üéØ ÁõÆÁöÑ

**731„Ç§„É≥„Çπ„Çø„É≥„ÇπÂÖ®‰Ωì„ÅßË©ï‰æ°„ÇíÂÆüË°å„Åó„ÄÅ‰∏ñÁïåÊ®ôÊ∫ñ„Éó„É≠„Éà„Ç≥„É´„Å´ÂÆåÂÖ®Ê∫ñÊã†„Åó„ÅüË©ï‰æ°„ÇíÂÆå‰∫Ü„Åô„Çã**

**Ë¶™Issue**: #396 - SWE-bench ProË©ï‰æ°ÂÆüË£Ö
**‰æùÂ≠ò**: #401 (Phase 4) - „Éë„Ç§„É≠„ÉÉ„ÉàË©ï‰æ°ÂÆå‰∫Ü„ÉªÂïèÈ°å‰øÆÊ≠£Âæå„Å´ÂÆüÊñΩ

---

## üìã „Çø„Çπ„ÇØ

### 1. ‰∏¶ÂàóÂÆüË°åÊúÄÈÅ©Âåñ

```rust
// crates/miyabi-benchmark/src/evaluator.rs

pub struct ParallelConfig {
    /// ‰∏¶ÂàóÂÆüË°åÊï∞
    pub concurrency: usize,
    
    /// „ÉÅ„É£„É≥„ÇØ„Çµ„Ç§„Ç∫Ôºà‰∏ÄÂ∫¶„Å´Âá¶ÁêÜ„Åô„Çã„Ç§„É≥„Çπ„Çø„É≥„ÇπÊï∞Ôºâ
    pub chunk_size: usize,
    
    /// „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„ÉàÈñìÈöî
    pub checkpoint_interval: usize,
}

impl SWEBenchProEvaluator {
    /// ‰∏¶ÂàóÂÆüË°å„Åß„Éê„ÉÉ„ÉÅË©ï‰æ°
    pub async fn evaluate_parallel(
        &self,
        instances: &[SWEBenchInstance],
        config: ParallelConfig,
    ) -> Result<Vec<PatchOutput>> {
        let mut all_results = Vec::new();
        
        for (chunk_idx, chunk) in instances.chunks(config.chunk_size).enumerate() {
            println!("Processing chunk {}/{}", chunk_idx + 1, instances.len() / config.chunk_size);
            
            // ‰∏¶ÂàóÂÆüË°å
            let results = self.evaluate_batch(chunk).await?;
            all_results.extend(results);
            
            // „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà‰øùÂ≠ò
            if (chunk_idx + 1) % config.checkpoint_interval == 0 {
                self.save_checkpoint(&all_results, chunk_idx)?;
            }
        }
        
        Ok(all_results)
    }
    
    /// „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà‰øùÂ≠ò
    fn save_checkpoint(&self, results: &[PatchOutput], chunk_idx: usize) -> Result<()> {
        let checkpoint_path = format!("results/checkpoints/checkpoint_{}.json", chunk_idx);
        write_patches_json(results, &checkpoint_path)?;
        println!("‚úÖ Checkpoint saved: {}", checkpoint_path);
        Ok(())
    }
}
```

**Ê§úË®ºÈ†ÖÁõÆ**:
- [ ] ‰∏¶ÂàóÂ∫¶5„ÅßÂÆâÂÆöÂãï‰Ωú
- [ ] „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„ÅåÊ≠£Â∏∏„Å´‰øùÂ≠ò„Åï„Çå„Çã
- [ ] „É°„É¢„É™„É™„Éº„ÇØ„Åå„Å™„ÅÑ

---

### 2. ÈÄ≤Êçó„É¢„Éã„Çø„É™„É≥„Ç∞

```rust
// crates/miyabi-benchmark/src/progress.rs

use indicatif::{ProgressBar, ProgressStyle};

pub struct ProgressTracker {
    bar: ProgressBar,
    start_time: std::time::Instant,
}

impl ProgressTracker {
    pub fn new(total: usize) -> Self {
        let bar = ProgressBar::new(total as u64);
        bar.set_style(
            ProgressStyle::default_bar()
                .template("[{elapsed_precise}] [{bar:40.cyan/blue}] {pos}/{len} ({eta})")
                .progress_chars("#>-")
        );
        
        Self {
            bar,
            start_time: std::time::Instant::now(),
        }
    }
    
    pub fn inc(&self) {
        self.bar.inc(1);
    }
    
    pub fn finish(&self) {
        let elapsed = self.start_time.elapsed();
        println!("‚úÖ Evaluation complete in {:?}", elapsed);
        self.bar.finish();
    }
}
```

**Ê§úË®ºÈ†ÖÁõÆ**:
- [ ] „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„ÅåÊ≠£Â∏∏„Å´Ë°®Á§∫
- [ ] ÁµåÈÅéÊôÇÈñì„ÉªÊÆã„ÇäÊôÇÈñì„ÅåË°®Á§∫
- [ ] ÂÆå‰∫ÜÊôÇ„Å´Áµ±Ë®àÊÉÖÂ†±„ÅåË°®Á§∫

---

### 3. „Éï„É´„Çπ„Ç±„Éº„É´Ë©ï‰æ°ÂÆüË°å

```bash
# Step 1: Miyabi„Åß„Éë„ÉÉ„ÉÅÁîüÊàêÔºà731„Ç§„É≥„Çπ„Çø„É≥„ÇπÔºâ
cargo run --release --bin miyabi -- benchmark run \
  --dataset swebench_pro \
  --output results/full_patches.json \
  --concurrency 5 \
  --timeout 1800 \
  --checkpoint-interval 100

# ÊúüÂæÖ„Åï„Çå„ÇãÂÆüË°åÊôÇÈñì:
# - 731„Ç§„É≥„Çπ„Çø„É≥„Çπ √ó 30ÂàÜ/„Ç§„É≥„Çπ„Çø„É≥„Çπ = 365ÊôÇÈñì
# - ‰∏¶ÂàóÂ∫¶5„ÅßÁ¥Ñ73ÊôÇÈñìÔºà3Êó•ÈñìÔºâ

# Step 2: ÂÖ¨ÂºèË©ï‰æ°„Çπ„ÇØ„É™„Éó„ÉàÂÆüË°å
cd SWE-bench_Pro-os

python swe_bench_pro_eval.py \
  --raw_sample_path=external_hf_v2.csv \
  --patch_path=../results/full_patches.json \
  --output_dir=../results/full/ \
  --num_workers=50 \
  --dockerhub_username=jefzda

# ÊúüÂæÖ„Åï„Çå„ÇãÂÆüË°åÊôÇÈñì: Á¥Ñ6-12ÊôÇÈñì
```

**Ê§úË®ºÈ†ÖÁõÆ**:
- [ ] 731„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åô„Åπ„Å¶„ÅåË©ï‰æ°ÂÆå‰∫Ü
- [ ] „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„Åå100„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åî„Å®„Å´‰øùÂ≠ò
- [ ] „Ç®„É©„Éº„É≠„Ç∞„ÅåË®òÈå≤„Åï„Çå„Çã
- [ ] ÂÖ¨ÂºèË©ï‰æ°„Çπ„ÇØ„É™„Éó„Éà„Åå„Ç®„É©„Éº„Å™„ÅèÂÆüË°å

---

### 4. „Ç®„É©„Éº„É™„Ç´„Éê„É™„ÉºÂº∑Âåñ

```rust
// crates/miyabi-benchmark/src/recovery.rs

pub struct RecoveryManager {
    checkpoint_dir: String,
}

impl RecoveryManager {
    /// ÊúÄÊñ∞„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„Åã„ÇâÂÜçÈñã
    pub fn resume_from_checkpoint(&self) -> Result<(Vec<PatchOutput>, usize)> {
        // ÊúÄÊñ∞„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„ÇíÊ§úÁ¥¢
        let latest_checkpoint = self.find_latest_checkpoint()?;
        
        // „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„Åã„ÇâÁµêÊûú„Çí„É≠„Éº„Éâ
        let results = self.load_checkpoint(&latest_checkpoint)?;
        
        // ÂÜçÈñã‰ΩçÁΩÆ„ÇíËøî„Åô
        Ok((results, results.len()))
    }
    
    /// „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åü„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÇíÂÜçË©¶Ë°å
    pub async fn retry_failed(&self, instance: &SWEBenchInstance) -> Result<PatchOutput> {
        const MAX_RETRIES: usize = 3;
        
        for attempt in 1..=MAX_RETRIES {
            match self.evaluate(instance).await {
                Ok(patch) => return Ok(patch),
                Err(e) => {
                    eprintln!("Attempt {}/{} failed: {}", attempt, MAX_RETRIES, e);
                    if attempt == MAX_RETRIES {
                        return Err(e);
                    }
                }
            }
        }
        
        unreachable!()
    }
}
```

**Ê§úË®ºÈ†ÖÁõÆ**:
- [ ] „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„Åã„ÇâÂÜçÈñãÂèØËÉΩ
- [ ] Â§±Êïó„Åó„Åü„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÅÆÂÜçË©¶Ë°å
- [ ] „Ç®„É©„Éº„É≠„Ç∞„ÅåË©≥Á¥∞

---

### 5. „É™„Ç¢„É´„Çø„Ç§„É†„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ

```bash
# „É™„Ç¢„É´„Çø„Ç§„É†Áµ±Ë®àË°®Á§∫
watch -n 10 'cargo run --bin miyabi -- benchmark status'

# Âá∫Âäõ‰æã:
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# Miyabi SWE-bench Pro Evaluation Status
# ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
# Progress: 350/731 (47.9%)
# Elapsed: 36h 15m
# Estimated remaining: 39h 45m
# 
# Success: 45 (12.9%)
# Failed: 25 (7.1%)
# In Progress: 5
# 
# Last 5 completed:
# ‚úÖ repo__issue-123 (15m 23s)
# ‚ùå repo__issue-456 (timeout)
# ‚úÖ repo__issue-789 (22m 10s)
# ...
```

---

## üì¶ ÊàêÊûúÁâ©

- [ ] `results/full_patches.json` - MiyabiÁîüÊàê„Éë„ÉÉ„ÉÅÔºà731‰ª∂Ôºâ
- [ ] `results/full/evaluation_results.json` - ÂÖ¨ÂºèË©ï‰æ°ÁµêÊûú
- [ ] `results/checkpoints/checkpoint_*.json` - ‰∏≠Èñì„ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà
- [ ] `logs/benchmark_YYYY-MM-DD.log` - ÂÆüË°å„É≠„Ç∞
- [ ] `evaluation_protocol.yml` - Ë©ï‰æ°„Éó„É≠„Éà„Ç≥„É´ÂÆöÁæ©

---

## üìä Ë®àÁÆó„É™„ÇΩ„Éº„Çπ

### ÊôÇÈñì
- **MiyabiË©ï‰æ°**: 731„Ç§„É≥„Çπ„Çø„É≥„Çπ √ó 30ÂàÜ = 365ÊôÇÈñì
- **‰∏¶ÂàóÂ∫¶5**: Á¥Ñ**73ÊôÇÈñìÔºà3Êó•ÈñìÔºâ**
- **ÂÖ¨ÂºèË©ï‰æ°**: Á¥Ñ6-12ÊôÇÈñì
- **ÂêàË®à**: Á¥Ñ**79-85ÊôÇÈñì**

### „Çπ„Éà„É¨„Éº„Ç∏
- Worktree: Á¥Ñ10GBÔºà‰∏¶ÂàóÂ∫¶5 √ó 2GB/worktreeÔºâ
- „É≠„Ç∞: Á¥Ñ5GB
- Docker: Á¥Ñ5GB
- **ÂêàË®à**: Á¥Ñ**20GB**

### „É°„É¢„É™
- MiyabiÂÆüË°å: Á¥Ñ8GB
- Docker: Á¥Ñ8GB
- **ÂêàË®à**: Á¥Ñ**16GB**

### „Ç≥„Çπ„Éà
- **APIÊñôÈáë**: $0Ôºà„É≠„Éº„Ç´„É´Claude CodeÂÆüË°åÔºâ
- **Ë®àÁÆó„É™„ÇΩ„Éº„Çπ**: „É≠„Éº„Ç´„É´„Éû„Ç∑„É≥„ÅÆ„Åø
- **ÂêàË®à**: **$0**

---

## ‚úÖ ÊàêÂäüÂü∫Ê∫ñ

### ÂøÖÈÅî
- [ ] **731„Ç§„É≥„Çπ„Çø„É≥„Çπ100%Ë©ï‰æ°ÂÆå‰∫Ü**
- [ ] ÂÖ¨ÂºèË©ï‰æ°„Çπ„ÇØ„É™„Éó„Éà„Åß„Ç®„É©„Éº0‰ª∂
- [ ] **Resolve Rate ‚â• 10%**Ôºà73„Ç§„É≥„Çπ„Çø„É≥„Çπ‰ª•‰∏äÊàêÂäüÔºâ
- [ ] „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú

### Êé®Â•®
- [ ] **Resolve Rate 15-20%**Ôºà110-146„Ç§„É≥„Çπ„Çø„É≥„ÇπÊàêÂäüÔºâ
- [ ] ÂÆüË°åÊôÇÈñì„Åå‰∫àÊ∏¨ÁØÑÂõ≤ÂÜÖÔºà73¬±10ÊôÇÈñìÔºâ
- [ ] „É°„É¢„É™„É™„Éº„ÇØ„Å™„Åó

### ÁêÜÊÉ≥
- [ ] **Resolve Rate ‚â• 25%**Ôºà183„Ç§„É≥„Çπ„Çø„É≥„Çπ‰ª•‰∏äÊàêÂäüÔºâ
- [ ] ÂÆüË°åÊôÇÈñì„Åå60ÊôÇÈñì‰ª•ÂÜÖ
- [ ] „ÇØ„É©„ÉÉ„Ç∑„É•0‰ª∂

---

## ‚ö†Ô∏è „É™„Çπ„ÇØ„Å®ÂØæÁ≠ñ

### „É™„Çπ„ÇØ1: Èï∑ÊôÇÈñìÂÆüË°å„Å´„Çà„Çã‰∏çÂÆâÂÆöÊÄß
**ÂØæÁ≠ñ**:
- [ ] 100„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åî„Å®„Å´„ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„Éà
- [ ] Worktree„ÅÆÂÆöÊúü„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
- [ ] „É°„É¢„É™‰ΩøÁî®Èáè„ÅÆ„É¢„Éã„Çø„É™„É≥„Ç∞

### „É™„Çπ„ÇØ2: „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÈöúÂÆ≥
**ÂØæÁ≠ñ**:
- [ ] „É≠„Éº„Ç´„É´ÂÆüË°åÔºà„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ‰æùÂ≠òÊúÄÂ∞èÂåñÔºâ
- [ ] „Çø„Ç§„É†„Ç¢„Ç¶„Éà„ÅÆÈÅ©Âàá„Å™Ë®≠ÂÆö
- [ ] Ëá™Âãï„É™„Éà„É©„Ç§Ê©üÊßã

### „É™„Çπ„ÇØ3: „Éá„Ç£„Çπ„ÇØÂÆπÈáè‰∏çË∂≥
**ÂØæÁ≠ñ**:
- [ ] ‰∫ãÂâç„Å´30GB‰ª•‰∏ä„ÅÆÁ©∫„ÅçÂÆπÈáèÁ¢∫‰øù
- [ ] Worktree„ÅÆÂÆöÊúüÂâäÈô§
- [ ] „É≠„Ç∞„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥

---

## ‚è±Ô∏è ÊúüÈñì

**ÊúüÈñì**: 4ÈÄ±Èñì
**ÊúüÈôê**: 2025-12-24

**ÂÜÖË®≥**:
- ‰∏¶ÂàóÂÆüË°åÊúÄÈÅ©Âåñ: 1ÈÄ±Èñì
- „Éï„É´„Çπ„Ç±„Éº„É´Ë©ï‰æ°ÂÆüË°å: 3Êó•ÈñìÔºà73ÊôÇÈñìÔºâ
- ÂÖ¨ÂºèË©ï‰æ°ÂÆüË°å: 1Êó•Èñì
- ÂïèÈ°å‰øÆÊ≠£„ÉªÂÜçË©ï‰æ°: 2ÈÄ±Èñì
- ÁµêÊûúÊ§úË®º: 1ÈÄ±Èñì

---

## üè∑Ô∏è Label

- `‚ú® type:feature`
- `üöÄ phase:deployment`
- `ü§ñ agent:deployment`
- `üî• priority:P0-Critical`

---

## üìö Èñ¢ÈÄ£„É™„ÇΩ„Éº„Çπ

- **ÂÖ¨ÂºèË©ï‰æ°„Çπ„ÇØ„É™„Éó„Éà**: https://github.com/scaleapi/SWE-bench_Pro-os
- **HuggingFace„Éá„Éº„Çø„Çª„ÉÉ„Éà**: https://huggingface.co/datasets/ScaleAI/SWE-bench_Pro

---

**Ë¶™Issue**: #396 - SWE-bench ProË©ï‰æ°ÂÆüË£Ö
**‰æùÂ≠ò**: #401 (Phase 4)

**‚ö†Ô∏è Ê≥®ÊÑè**: „Åì„ÅÆPhase„ÅØ3Êó•Èñì„ÅÆÈÄ£Á∂öÂÆüË°å„ÅåÂøÖË¶Å„Åß„Åô„ÄÇÂÆüË°åÂâç„Å´ÂçÅÂàÜ„Å™Ë®àÁÆó„É™„ÇΩ„Éº„Çπ„Å®„Çπ„Éà„É¨„Éº„Ç∏„ÇíÁ¢∫‰øù„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

### 3. Add tests for #402

- **ID**: `task-402-test`
- **Type**: Test
- **Assigned Agent**: CodeGenAgent
- **Priority**: 2
- **Estimated Duration**: 15 min
- **Dependencies**: task-402-impl

**Description**: Create comprehensive test coverage

### 4. Review code quality for #402

- **ID**: `task-402-review`
- **Type**: Refactor
- **Assigned Agent**: ReviewAgent
- **Priority**: 3
- **Estimated Duration**: 10 min
- **Dependencies**: task-402-test

**Description**: Run quality checks and code review

## üîÑ Execution Plan (DAG Levels)

Tasks can be executed in parallel within each level:

### Level 0 (Parallel Execution)

- `task-402-analysis` - Analyze requirements for #402

### Level 1 (Parallel Execution)

- `task-402-impl` - Implement solution for #402

### Level 2 (Parallel Execution)

- `task-402-test` - Add tests for #402

### Level 3 (Parallel Execution)

- `task-402-review` - Review code quality for #402

## üìä Dependency Graph

```mermaid
graph TD
    task_402_analysis["Analyze requirements for #402"]
    task_402_impl["Implement solution for #402"]
    task_402_test["Add tests for #402"]
    task_402_review["Review code quality for #402"]
    task_402_analysis --> task_402_impl
    task_402_impl --> task_402_test
    task_402_test --> task_402_review
```

## ‚è±Ô∏è Timeline Estimation

- **Sequential Execution**: 60 minutes (1.0 hours)
- **Parallel Execution (Critical Path)**: 10 minutes (0.2 hours)
- **Estimated Speedup**: 6.0x

---

*Generated by CoordinatorAgent on 2025-10-30 17:46:20 UTC*
