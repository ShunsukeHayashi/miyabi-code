# Plans for Issue #399

**Title**: ğŸ“„ [Sub-Issue #396] Phase 2: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆçµ±åˆã¨Miyabiå‹å®šç¾©

**URL**: https://github.com/customer-cloud/miyabi-private/issues/399

---

## ğŸ“‹ Summary

- **Total Tasks**: 4
- **Estimated Duration**: 60 minutes
- **Execution Levels**: 4
- **Has Cycles**: âœ… No

## ğŸ“ Task Breakdown

### 1. Analyze requirements for #399

- **ID**: `task-399-analysis`
- **Type**: Docs
- **Assigned Agent**: IssueAgent
- **Priority**: 0
- **Estimated Duration**: 5 min

**Description**: Analyze issue requirements and create detailed specification

### 2. Implement solution for #399

- **ID**: `task-399-impl`
- **Type**: Feature
- **Assigned Agent**: CodeGenAgent
- **Priority**: 1
- **Estimated Duration**: 30 min
- **Dependencies**: task-399-analysis

**Description**: ## ğŸ¯ ç›®çš„

**HuggingFaceã‹ã‚‰SWE-bench Proãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å–å¾—ã—ã€Miyabiå½¢å¼ã«å¤‰æ›ã™ã‚‹**

**è¦ªIssue**: #396 - SWE-bench Proè©•ä¾¡å®Ÿè£…
**ä¾å­˜**: #398 (Phase 1) - ç’°å¢ƒæ§‹ç¯‰å®Œäº†å¾Œã«å®Ÿæ–½

---

## ğŸ“‹ ã‚¿ã‚¹ã‚¯

### 1. HuggingFace Datasets APIçµ±åˆ

```python
# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå–å¾—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
from datasets import load_dataset

# SWE-bench Proå…¬å¼ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
swebench_pro = load_dataset('ScaleAI/SWE-bench_Pro', split='test')

print(f"Total instances: {len(swebench_pro)}")  # æœŸå¾…: 731
print(f"Keys: {swebench_pro[0].keys()}")
```

**æ¤œè¨¼é …ç›®**:
- [ ] 731ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã™ã¹ã¦ã‚’ãƒ­ãƒ¼ãƒ‰å¯èƒ½
- [ ] ãƒ‡ãƒ¼ã‚¿æ¬ æ0ä»¶
- [ ] å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ­£ã—ãå–å¾—ã§ãã‚‹

---

### 2. Rustå‹å®šç¾©ä½œæˆ

```rust
// crates/miyabi-types/src/benchmark.rs

use serde::{Deserialize, Serialize};

#[derive(Serialize, Deserialize, Debug, Clone)]
pub struct SWEBenchInstance {
    /// å…¬å¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹IDï¼ˆå¤‰æ›´ç¦æ­¢ï¼‰
    pub instance_id: String,
    
    /// ãƒªãƒã‚¸ãƒˆãƒªå
    pub repo: String,
    
    /// ãƒ™ãƒ¼ã‚¹ã‚³ãƒŸãƒƒãƒˆï¼ˆ40æ–‡å­—ã®ãƒãƒƒã‚·ãƒ¥ï¼‰
    pub base_commit: String,
    
    /// å•é¡Œæ–‡ï¼ˆIssueèª¬æ˜ï¼‰
    pub problem_statement: String,
    
    /// æ­£è§£ãƒ‘ãƒƒãƒï¼ˆæ¤œè¨¼ç”¨ï¼‰
    pub patch: String,
    
    /// ãƒ†ã‚¹ãƒˆãƒ‘ãƒƒãƒ
    pub test_patch: String,
    
    /// æˆåŠŸã™ã¹ããƒ†ã‚¹ãƒˆ
    pub fail_to_pass: Vec<String>,
    
    /// ç¶­æŒã™ã¹ããƒ†ã‚¹ãƒˆ
    pub pass_to_pass: Vec<String>,
    
    /// ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
    pub repo_language: Option<String>,
    pub requirements: Option<String>,
}

#[derive(Serialize, Deserialize, Debug, Clone)]
pub struct PatchOutput {
    /// ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ID
    pub instance_id: String,
    
    /// ç”Ÿæˆã•ã‚ŒãŸãƒ‘ãƒƒãƒï¼ˆunified diffå½¢å¼ï¼‰
    pub model_patch: String,
    
    /// ãƒ¢ãƒ‡ãƒ«å
    pub model_name_or_path: String,
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå…¬å¼ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨ä¸€è‡´
- [ ] Serdeã§ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º/ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½
- [ ] å‹å®‰å…¨æ€§ãŒä¿è¨¼ã•ã‚Œã‚‹

---

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼å®Ÿè£…

```rust
// crates/miyabi-benchmark/src/dataset.rs

use miyabi_types::benchmark::SWEBenchInstance;
use anyhow::Result;

pub struct SWEBenchDataset {
    instances: Vec<SWEBenchInstance>,
}

impl SWEBenchDataset {
    /// HuggingFaceã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ­ãƒ¼ãƒ‰
    pub fn load() -> Result<Self> {
        // PythonçµŒç”±ã§HuggingFaceãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå–å¾—
        // ã¾ãŸã¯JSONå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸã‚‚ã®ã‚’ãƒ­ãƒ¼ãƒ‰
        todo!()
    }
    
    /// ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°ã‚’å–å¾—
    pub fn len(&self) -> usize {
        self.instances.len()
    }
    
    /// ç‰¹å®šã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—
    pub fn get(&self, index: usize) -> Option<&SWEBenchInstance> {
        self.instances.get(index)
    }
    
    /// instance_idã§ãƒ•ã‚£ãƒ«ã‚¿
    pub fn filter_by_ids(&self, ids: &[String]) -> Vec<&SWEBenchInstance> {
        self.instances.iter()
            .filter(|inst| ids.contains(&inst.instance_id))
            .collect()
    }
    
    /// è¨€èªã§ãƒ•ã‚£ãƒ«ã‚¿
    pub fn filter_by_language(&self, lang: &str) -> Vec<&SWEBenchInstance> {
        self.instances.iter()
            .filter(|inst| inst.repo_language.as_deref() == Some(lang))
            .collect()
    }
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] 731ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã™ã¹ã¦ã‚’ãƒ­ãƒ¼ãƒ‰å¯èƒ½
- [ ] instance_idã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯èƒ½
- [ ] è¨€èªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯èƒ½
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡

---

### 4. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ

```bash
# 10ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦æŠ½å‡º
# tests/fixtures/swebench_sample.json

# è¨€èªãƒãƒ©ãƒ³ã‚¹è€ƒæ…®:
# - Python: 5ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
# - Go: 3ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
# - JavaScript/TypeScript: 2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
```

**æ¤œè¨¼é …ç›®**:
- [ ] ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ããƒ­ãƒ¼ãƒ‰å¯èƒ½
- [ ] å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ­£ã—ãè§£æã•ã‚Œã‚‹
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆã§æ¤œè¨¼æ¸ˆã¿

---

### 5. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒãƒƒãƒ”ãƒ³ã‚°æ¤œè¨¼

| HuggingFaceãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | Miyabiå‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | æ¤œè¨¼ |
|---------------------|-------------------|------|
| `instance_id` | `instance_id` | âœ… |
| `repo` | `repo` | âœ… |
| `base_commit` | `base_commit` | âœ… |
| `problem_statement` | `problem_statement` | âœ… |
| `patch` | `patch` | âœ… |
| `test_patch` | `test_patch` | âœ… |
| `fail_to_pass` | `fail_to_pass` | âœ… |
| `pass_to_pass` | `pass_to_pass` | âœ… |

---

## ğŸ“¦ æˆæœç‰©

- [ ] `crates/miyabi-types/src/benchmark.rs` - Rustå‹å®šç¾©
- [ ] `crates/miyabi-benchmark/src/dataset.rs` - ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼
- [ ] `crates/miyabi-benchmark/Cargo.toml` - ä¾å­˜é–¢ä¿‚å®šç¾©
- [ ] `tests/fixtures/swebench_sample.json` - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
- [ ] `crates/miyabi-benchmark/tests/dataset_test.rs` - å˜ä½“ãƒ†ã‚¹ãƒˆ

---

## âœ… æˆåŠŸåŸºæº–

### å¿…é”
- [ ] 731ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã™ã¹ã¦ã‚’ãƒ­ãƒ¼ãƒ‰å¯èƒ½
- [ ] instance_idãŒå…¬å¼ã¨å®Œå…¨ä¸€è‡´
- [ ] ãƒ‡ãƒ¼ã‚¿æ¬ æ0ä»¶
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆãŒå…¨ã¦ãƒ‘ã‚¹

### æ¨å¥¨
- [ ] è¨€èªåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒå‹•ä½œ
- [ ] ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒè‰¯ã„ï¼ˆé…å»¶ãƒ­ãƒ¼ãƒ‰ç­‰ï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ˜ç¢º

---

## â±ï¸ æœŸé–“

**æœŸé–“**: 1é€±é–“
**æœŸé™**: 2025-11-05

---

## ğŸ·ï¸ Label

- `âœ¨ type:feature`
- `ğŸ—ï¸ phase:implementation`
- `ğŸ¤– agent:codegen`
- `ğŸ“Š priority:P2-Medium`

---

## ğŸ“š é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

- **HuggingFaceãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ**: https://huggingface.co/datasets/ScaleAI/SWE-bench_Pro
- **Rust Serde**: https://serde.rs/

---

**è¦ªIssue**: #396 - SWE-bench Proè©•ä¾¡å®Ÿè£…
**ä¾å­˜**: #398 (Phase 1)

### 3. Add tests for #399

- **ID**: `task-399-test`
- **Type**: Test
- **Assigned Agent**: CodeGenAgent
- **Priority**: 2
- **Estimated Duration**: 15 min
- **Dependencies**: task-399-impl

**Description**: Create comprehensive test coverage

### 4. Review code quality for #399

- **ID**: `task-399-review`
- **Type**: Refactor
- **Assigned Agent**: ReviewAgent
- **Priority**: 3
- **Estimated Duration**: 10 min
- **Dependencies**: task-399-test

**Description**: Run quality checks and code review

## ğŸ”„ Execution Plan (DAG Levels)

Tasks can be executed in parallel within each level:

### Level 0 (Parallel Execution)

- `task-399-analysis` - Analyze requirements for #399

### Level 1 (Parallel Execution)

- `task-399-impl` - Implement solution for #399

### Level 2 (Parallel Execution)

- `task-399-test` - Add tests for #399

### Level 3 (Parallel Execution)

- `task-399-review` - Review code quality for #399

## ğŸ“Š Dependency Graph

```mermaid
graph TD
    task_399_analysis["Analyze requirements for #399"]
    task_399_impl["Implement solution for #399"]
    task_399_test["Add tests for #399"]
    task_399_review["Review code quality for #399"]
    task_399_analysis --> task_399_impl
    task_399_impl --> task_399_test
    task_399_test --> task_399_review
```

## â±ï¸ Timeline Estimation

- **Sequential Execution**: 60 minutes (1.0 hours)
- **Parallel Execution (Critical Path)**: 10 minutes (0.2 hours)
- **Estimated Speedup**: 6.0x

---

*Generated by CoordinatorAgent on 2025-10-30 17:47:20 UTC*
