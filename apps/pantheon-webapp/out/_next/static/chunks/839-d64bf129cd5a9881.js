"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{7401:function(e,t,n){n.d(t,{qJ:function(){return d},z1:function(){return g},sO:function(){return u},uE:function(){return h}});var r=n(7437),o=n(2265);let s={url:"",reconnectMaxRetries:0,reconnectBaseDelay:1e3,reconnectMaxDelay:3e4,heartbeatInterval:3e4,heartbeatTimeout:1e4};class c{connect(e){console.log("[WebSocket] Disabled in production - using polling fallback"),this.setConnectionState("disconnected")}disconnect(){this.clearTimers(),this.reconnectAttempts=0,this.ws&&(this.ws.onclose=null,this.ws.close(1e3,"Client disconnect"),this.ws=null),this.setConnectionState("disconnected")}setupEventListeners(){this.ws&&(this.ws.onopen=()=>{console.log("[WebSocket] Connected"),this.reconnectAttempts=0,this.setConnectionState("connected"),this.startHeartbeat()},this.ws.onclose=e=>{console.log("[WebSocket] Closed: ".concat(e.code," - ").concat(e.reason)),this.clearTimers(),1e3!==e.code?this.scheduleReconnect():this.setConnectionState("disconnected")},this.ws.onerror=e=>{console.error("[WebSocket] Error:",e),this.setConnectionState("error")},this.ws.onmessage=e=>{this.handleMessage(e.data)})}startHeartbeat(){this.clearTimers(),this.heartbeatInterval=setInterval(()=>{var e;(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&(this.ws.send(JSON.stringify({type:"ping"})),this.heartbeatTimeout=setTimeout(()=>{var e;console.warn("[WebSocket] Heartbeat timeout - reconnecting"),null===(e=this.ws)||void 0===e||e.close(4e3,"Heartbeat timeout")},this.config.heartbeatTimeout))},this.config.heartbeatInterval)}handlePong(){this.heartbeatTimeout&&(clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=null)}scheduleReconnect(){if(this.reconnectAttempts>=this.config.reconnectMaxRetries){console.error("[WebSocket] Max reconnection attempts reached"),this.setConnectionState("error");return}this.setConnectionState("reconnecting"),this.reconnectAttempts++;let e=this.calculateReconnectDelay();console.log("[WebSocket] Reconnecting in ".concat(e,"ms (attempt ").concat(this.reconnectAttempts,"/").concat(this.config.reconnectMaxRetries,")")),this.reconnectTimeout=setTimeout(()=>{this.connect(this.authToken||void 0)},e)}calculateReconnectDelay(){return Math.min(this.config.reconnectBaseDelay*Math.pow(2,this.reconnectAttempts-1)+1e3*Math.random(),this.config.reconnectMaxDelay)}handleMessage(e){try{let t=JSON.parse(e);if("pong"===t.type){this.handlePong();return}this.lastEventTime=new Date,this.notifyEventHandlers(t)}catch(e){console.error("[WebSocket] Failed to parse message:",e)}}subscribe(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t),()=>{var n;null===(n=this.eventHandlers.get(e))||void 0===n||n.delete(t)}}onConnectionChange(e){return this.connectionHandlers.add(e),e(this.connectionState),()=>{this.connectionHandlers.delete(e)}}notifyEventHandlers(e){var t,n;null===(t=this.eventHandlers.get(e.type))||void 0===t||t.forEach(t=>{try{t(e)}catch(e){console.error("[WebSocket] Event handler error:",e)}}),null===(n=this.eventHandlers.get("all"))||void 0===n||n.forEach(t=>{try{t(e)}catch(e){console.error("[WebSocket] Event handler error:",e)}})}setConnectionState(e){this.connectionState!==e&&(this.connectionState=e,this.connectionHandlers.forEach(t=>{try{t(e)}catch(e){console.error("[WebSocket] Connection handler error:",e)}}))}getConnectionState(){return this.connectionState}getLastEventTime(){return this.lastEventTime}isConnected(){var e;return"connected"===this.connectionState&&(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}send(e){if(!this.isConnected())return console.warn("[WebSocket] Cannot send - not connected"),!1;try{return this.ws.send(JSON.stringify(e)),!0}catch(e){return console.error("[WebSocket] Send error:",e),!1}}clearTimers(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.heartbeatTimeout&&(clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=null)}destroy(){this.disconnect(),this.eventHandlers.clear(),this.connectionHandlers.clear()}constructor(e={}){this.ws=null,this.connectionState="disconnected",this.reconnectAttempts=0,this.reconnectTimeout=null,this.heartbeatInterval=null,this.heartbeatTimeout=null,this.eventHandlers=new Map,this.connectionHandlers=new Set,this.lastEventTime=null,this.authToken=null,this.config={...s,...e}}}let a=null;var l=n(9116);let i=(0,o.createContext)(null);function d(e){let{children:t,autoConnect:n=!0,fallbackPollingInterval:s=3e4}=e,[d,u]=(0,o.useState)("disconnected"),[h,g]=(0,o.useState)(null),m=(0,o.useRef)(null),x=(0,o.useRef)(null);(0,o.useEffect)(()=>{m.current=(a||(a=new c(void 0)),a);let e=m.current.onConnectionChange(e=>{u(e),"error"===e||"disconnected"===e?b():"connected"===e&&f()});if(n&&l.I8.isAuthenticated()){let e=l.I8.getAccessToken();m.current.connect(e||void 0)}return()=>{e(),f()}},[n]),(0,o.useEffect)(()=>{if(m.current)return m.current.subscribe("all",()=>{g(new Date)})},[]);let b=(0,o.useCallback)(()=>{x.current||(console.log("[WebSocket] Starting fallback polling"),x.current=setInterval(()=>{g(new Date)},s))},[s]),f=(0,o.useCallback)(()=>{x.current&&(console.log("[WebSocket] Stopping fallback polling"),clearInterval(x.current),x.current=null)},[]),v=(0,o.useCallback)(()=>{var e;let t=l.I8.getAccessToken();null===(e=m.current)||void 0===e||e.connect(t||void 0)},[]),k=(0,o.useCallback)(()=>{var e;null===(e=m.current)||void 0===e||e.disconnect()},[]),p=(0,o.useCallback)((e,t)=>m.current?m.current.subscribe(e,t):()=>{},[]),C=(0,o.useCallback)(e=>{var t,n;return null!==(n=null===(t=m.current)||void 0===t?void 0:t.send(e))&&void 0!==n&&n},[]);return(0,r.jsx)(i.Provider,{value:{connectionState:d,lastEventTime:h,isConnected:"connected"===d,connect:v,disconnect:k,subscribe:p,send:C},children:t})}function u(){let e=(0,o.useContext)(i);if(!e)throw Error("useWebSocket must be used within a WebSocketProvider");return e}function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{subscribe:r}=u();(0,o.useEffect)(()=>r(e,t),[r,e,...n])}function g(){let{connectionState:e}=u();return{state:e,isConnected:"connected"===e,isReconnecting:"reconnecting"===e,hasError:"error"===e}}},2386:function(e,t,n){n.d(t,{id:function(){return c},qr:function(){return a}});var r=n(7437),o=n(7401);function s(e){let{state:t,compact:n}=e,o={connected:{color:"text-green-700 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30",label:"LIVE",pulse:!0},connecting:{color:"text-yellow-700 dark:text-yellow-400",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",label:"Connecting",pulse:!0},reconnecting:{color:"text-orange-700 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/30",label:"Reconnecting",pulse:!0},disconnected:{color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-100 dark:bg-gray-800",label:"Offline",pulse:!1},error:{color:"text-red-700 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30",label:"Error",pulse:!1}}[t];return(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(o.bgColor," ").concat(o.color),children:[(0,r.jsx)("span",{className:"w-2 h-2 mr-1.5 rounded-full ".concat("connected"===t?"bg-green-500":"connecting"===t||"reconnecting"===t?"bg-yellow-500":"error"===t?"bg-red-500":"bg-gray-400"," ").concat(o.pulse?"animate-pulse":"")}),!n&&o.label]})}function c(e){let{showLastUpdate:t=!0,compact:n=!1,className:c=""}=e,{lastEventTime:a,connect:l}=(0,o.sO)(),{state:i,hasError:d}=(0,o.z1)();return(0,r.jsxs)("div",{className:"flex items-center space-x-3 ".concat(c),children:[(0,r.jsx)(s,{state:i,compact:n}),t&&!n&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Updated ",function(e){if(!e)return"Never";let t=Math.floor((new Date().getTime()-e.getTime())/1e3);return t<5?"Just now":t<60?"".concat(t,"s ago"):t<3600?"".concat(Math.floor(t/60),"m ago"):e.toLocaleTimeString()}(a)]}),d&&(0,r.jsx)("button",{onClick:l,className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"Retry"})]})}function a(){let{state:e,isReconnecting:t,hasError:n}=(0,o.z1)(),{connect:s}=(0,o.sO)();return"connected"===e?(0,r.jsxs)("div",{className:"flex items-center space-x-1.5 text-green-600 dark:text-green-400",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Live"})]}):t?(0,r.jsxs)("div",{className:"flex items-center space-x-1.5 text-orange-600 dark:text-orange-400",children:[(0,r.jsx)("svg",{className:"w-3 h-3 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Reconnecting"})]}):n?(0,r.jsxs)("button",{onClick:s,className:"flex items-center space-x-1.5 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Offline - Click to reconnect"})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-1.5 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-gray-400 rounded-full"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Offline"})]})}},5505:function(e,t,n){n.d(t,{VW:function(){return c},pm:function(){return a}});var r=n(7437),o=n(2265);let s=(0,o.createContext)(null);function c(e){let{children:t,maxToasts:n=5,defaultDuration:c=5e3}=e,[a,i]=(0,o.useState)([]),d=(0,o.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),u=(0,o.useCallback)(e=>{var t;let r="toast-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,9)),o={...e,id:r,duration:null!==(t=e.duration)&&void 0!==t?t:c};return i(e=>[o,...e].slice(0,n)),o.duration&&o.duration>0&&setTimeout(()=>{d(r)},o.duration),r},[c,n,d]),h=(0,o.useCallback)(()=>{i([])},[]);return(0,r.jsxs)(s.Provider,{value:{toasts:a,addToast:u,removeToast:d,clearToasts:h},children:[t,(0,r.jsx)(l,{toasts:a,onRemove:d})]})}function a(){let e=(0,o.useContext)(s);if(!e)throw Error("useToast must be used within a ToastProvider");return e}function l(e){let{toasts:t,onRemove:n}=e;return(0,r.jsx)("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col space-y-2",role:"region","aria-label":"Notifications",children:t.map(e=>(0,r.jsx)(i,{toast:e,onRemove:n},e.id))})}function i(e){let{toast:t,onRemove:n}=e,[s,c]=(0,o.useState)(!1),a=(0,o.useCallback)(()=>{c(!0),setTimeout(()=>n(t.id),200)},[n,t.id]),l={success:{bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800",iconColor:"text-green-600 dark:text-green-400",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})},error:{bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",iconColor:"text-red-600 dark:text-red-400",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},warning:{bgColor:"bg-yellow-50 dark:bg-yellow-900/20",borderColor:"border-yellow-200 dark:border-yellow-800",iconColor:"text-yellow-600 dark:text-yellow-400",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})},info:{bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800",iconColor:"text-blue-600 dark:text-blue-400",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}}[t.type];return(0,r.jsx)("div",{className:"\n        max-w-sm w-full shadow-lg rounded-lg pointer-events-auto\n        border ".concat(l.bgColor," ").concat(l.borderColor,"\n        transform transition-all duration-200 ease-out\n        ").concat(s?"opacity-0 translate-x-full":"opacity-100 translate-x-0","\n      "),role:"alert",children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0 ".concat(l.iconColor),children:l.icon}),(0,r.jsxs)("div",{className:"ml-3 w-0 flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.title}),t.message&&(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:t.message}),t.action&&(0,r.jsx)("button",{onClick:()=>{var e;null===(e=t.action)||void 0===e||e.onClick(),a()},className:"mt-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline",children:t.action.label})]}),(0,r.jsxs)("button",{onClick:a,className:"ml-4 flex-shrink-0 rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]})})})}}}]);