# Miyabi Desktop UI/UX 改善タスク分解計画

**策定日**: 2025-11-04
**策定者**: しきるん (CoordinatorAgent)
**参照元**: ISSUES/desktop-ui-ux-improvement.md
**ステータス**: 提案中

---

## 📋 エグゼクティブサマリー

Miyabi Desktop の UI/UX 改善を、**5つの実装単位**に分解しました。各タスクは、以下の課題に対処します：

1. **Panel Overload** - サイドバーナビゲーションの改善
2. **Context Switching Costs** - エージェント実行とログの統合
3. **Status Visibility** - ステータス可視性の向上
4. **Accessibility Gaps** - アクセシビリティの改善
5. **Design System Consistency** - デザインシステムの統一

**優先度**: P1（高）3タスク、P2（中）2タスク
**推奨実装順序**: タスク5 → タスク1, 2, 4（並行） → タスク3

---

## 🎯 タスク一覧

### タスク1: ナビゲーション・情報設計の改善

**優先度**: **P1 - High**
**対処課題**: Panel Overload

#### 📝 概要

サイドバーのナビゲーション体験を改善し、ユーザーが各パネルの目的をすぐに理解できるようにします。

#### 🛠️ 実装内容

1. **サイドバーアイコンの強化**
   - ツールチップの拡充（現在の簡素なラベル → 機能説明+ショートカット表示）
   - ホバー時のアニメーションを追加（subtle scale + border highlight）
   - アクティブ状態の視認性向上（`bg-gray-900` + `text-white`）

2. **パネルヘッダーの統一**
   - 全パネルに統一されたヘッダーレイアウトを適用
   - パネルタイトル + 説明文 + アクションボタンの3層構造
   - パンくずナビゲーション追加（例: "Home > エージェント実行 > CoordinatorAgent"）

3. **コマンドパレット（⌘K）の拡充**
   - パネル説明文の追加
   - 最近使用したパネルの履歴表示
   - ヘルプコマンド追加（"help: エージェント実行" → 使い方ガイド表示）

#### 📊 期待効果

- **新規ユーザーのオンボーディング時間**: 30%短縮
- **パネル間移動の速度**: 20%向上
- **ユーザー満足度**: +15 NPS（Net Promoter Score）

#### 🔗 依存関係

- **前提**: タスク5（デザインシステム統一）の完了
- **並行可能**: タスク2, 4

#### ⏱️ 推定工数

- **設計**: 0.5日
- **実装**: 1.5日
- **テスト**: 0.5日
- **合計**: 2.5日

---

### タスク2: コンテキストスイッチング・フィードバック改善

**優先度**: **P1 - High**
**対処課題**: Context Switching Costs

#### 📝 概要

エージェント実行とログ監視のコンテキストスイッチングコストを削減し、アクションと出力の関連性を明確にします。

#### 🛠️ 実装内容

1. **統合実行ビューの設計**
   - エージェント選択パネル（左）とログ出力パネル（右）の2カラムレイアウト維持
   - ログパネルに「実行中のタスク」ミニカード追加（Issue #, Agent名, 経過時間）
   - ログ行にタイムスタンプとエージェント名を付与（例: `[12:34:56] [CoordinatorAgent] Starting...`）

2. **アクション→出力のビジュアルリンク強化**
   - "Execute Agent" ボタンクリック時、ログパネルへの視覚的フォーカス移動（subtle scroll + highlight）
   - ログ出力の最初の行に実行コマンド表示（例: `$ miyabi agent run coordinator --issue 270`）
   - エラー発生時、該当ログ行を自動ハイライト（`bg-red-50 border-l-4 border-red-400`）

3. **リアルタイムフィードバックのプログレスインジケーター改善**
   - 実行ステータスバー追加（Starting → Running → Success/Failed）
   - 進捗推定機能（過去の実行時間平均から残り時間を予測）
   - ログストリーミングの視覚化（新しいログ行が追加されるアニメーション）

#### 📊 期待効果

- **タスク完了時間**: 15%短縮（頻繁なタブ切り替えの削減）
- **エラー発見速度**: 40%向上（エラー行の自動ハイライト）
- **認知負荷**: 25%削減（実行コンテキストの常時表示）

#### 🔗 依存関係

- **前提**: タスク5（デザインシステム統一）の完了
- **並行可能**: タスク1, 4
- **後続**: タスク3（ステータス可視性改善と連携）

#### ⏱️ 推定工数

- **設計**: 1日
- **実装**: 2.5日
- **テスト**: 1日
- **合計**: 4.5日

---

### タスク3: ステータス可視性・二次アクション改善

**優先度**: **P2 - Medium**
**対処課題**: Status Visibility

#### 📝 概要

成功/エラー状態の視認性を向上させ、二次アクション（詳細ログ、Issue #）の発見可能性を改善します。

#### 🛠️ 実装内容

1. **ステータスビジュアル階層の改善**
   - 成功状態: `bg-green-50 border-green-400` + CheckCircle アイコン（24px）
   - エラー状態: `bg-red-50 border-red-400` + AlertCircle アイコン（24px）
   - 実行時間表示の視認性向上（`text-lg font-light` → `text-xl font-normal`）
   - Exit code表示の追加（失敗時のみ、例: "Exit code: 101"）

2. **二次アクションのプロミネンス向上**
   - アクションボタンのレイアウト変更（縦並び → 横並び + アイコン付き）
   - "詳細ログ" ボタンにバッジ追加（例: "詳細ログ (125 lines)"）
   - "Issue #XXX" ボタンの視覚的強調（`bg-blue-400 text-white` + ExternalLink アイコン）
   - ホバー時のツールチップ追加（例: "GitHubでIssue #270を開く"）

3. **Empty/Loading/Error状態の統一デザイン**
   - Empty状態: イラスト + メッセージ + アクション提案（例: "エージェントを選択して開始"）
   - Loading状態: スピナー + メッセージ + 推定残り時間
   - Error状態: エラーアイコン + エラーメッセージ + リトライボタン + サポートリンク

#### 📊 期待効果

- **二次アクション利用率**: 60%向上（"詳細ログ"、"Issue #"のクリック率）
- **エラー解決速度**: 30%向上（エラー情報の視認性向上）
- **ユーザー満足度**: +10 NPS

#### 🔗 依存関係

- **前提**: タスク2（コンテキストスイッチング改善）の完了推奨
- **並行可能**: なし（タスク2の成果物を活用）

#### ⏱️ 推定工数

- **設計**: 0.5日
- **実装**: 1.5日
- **テスト**: 0.5日
- **合計**: 2.5日

---

### タスク4: アクセシビリティ改善

**優先度**: **P1 - High**
**対処課題**: Accessibility Gaps

#### 📝 概要

WCAG 2.1 AA準拠のアクセシビリティを実現し、キーボード操作、スクリーンリーダー対応を強化します。

#### 🛠️ 実装内容

1. **キーボードフォーカスアウトラインの追加**
   - 全ての対話要素に`:focus-visible`スタイル追加
   - フォーカスリング: `outline: 2px solid var(--gray-900); outline-offset: 2px`
   - タブ順序の最適化（視覚的階層と一致）

2. **スキップリンクの実装**
   - ページ最上部に "Skip to main content" リンク追加
   - キーボードフォーカス時のみ表示（`sr-only`クラス使用）
   - メインコンテンツエリアに`id="main-content"`追加

3. **ARIAラベルの追加**
   - サイドバーボタン: `aria-label="Navigate to Agent Execution Panel (⌘1)"`
   - ステータスインジケーター: `aria-live="polite"` + `role="status"`
   - モーダル: `role="dialog"` + `aria-modal="true"`
   - ログ出力エリア: `role="log"` + `aria-live="polite"`

4. **コントラスト比チェックと修正**
   - 全てのテキストがWCAG AA基準（4.5:1）を満たすことを確認
   - `gray-400`（現在3.2:1）を`gray-500`（4.6:1）に変更
   - ステータスカラーのコントラスト比検証（`blue-400`, `green-400`, `red-400`）

5. **スクリーンリーダー対応**
   - ページタイトルの動的更新（例: "Agent Execution - Miyabi Desktop"）
   - 状態変化の通知（例: "Agent execution started" → スクリーンリーダーが読み上げ）
   - 画像に`alt`属性追加（エージェントアバターなど）

#### 📊 期待効果

- **WCAG 2.1 AA準拠**: 100%達成
- **キーボード操作ユーザー**: 操作速度50%向上
- **スクリーンリーダーユーザー**: 完全な機能アクセス可能
- **アクセシビリティスコア（Lighthouse）**: 90 → 100

#### 🔗 依存関係

- **前提**: タスク5（デザインシステム統一）の完了
- **並行可能**: タスク1, 2

#### ⏱️ 推定工数

- **設計**: 0.5日
- **実装**: 2日
- **テスト**: 1日（スクリーンリーダーテスト含む）
- **合計**: 3.5日

---

### タスク5: デザインシステム統一・ドキュメント整備

**優先度**: **P2 - Medium** (ただし、最優先で実施)
**対処課題**: Design System Consistency

#### 📝 概要

既存の `docs/UI_UX_DESIGN_SYSTEM.md` と Jonathan Ive Design Principles を統合し、Miyabi Desktop全体で一貫したデザイン言語を確立します。

#### 🛠️ 実装内容

1. **デザイントークンの定義**
   - CSS Custom Propertiesとして全てのデザイン値を定義
   - カラーパレット、タイポグラフィ、スペーシング、ボーダー半径、シャドウ
   - `index.css`に`@layer base`で追加

2. **コンポーネントライブラリの整備**
   - `components/ui/`配下に基本コンポーネント追加
     - `button.tsx` - 3種類（Primary, Secondary, Icon）
     - `card.tsx` - 2種類（Default, Active）
     - `badge.tsx` - ステータスバッジ、ラベルバッジ
     - `input.tsx` - テキスト入力、ドロップダウン
   - Storybookの導入検討（将来的なコンポーネントカタログ）

3. **Jonathan Ive Design Principlesの適用**
   - 全てのグラデーションを削除（Solid colors only）
   - ホバーエフェクトの抑制（`scale(1.08)` → `scale(1.02)`以下）
   - シャドウの最小化（Borders over shadows）
   - タイポグラフィの洗練（`font-light (300)`をデフォルトに）

4. **デザインドキュメントの更新**
   - `docs/UI_UX_DESIGN_SYSTEM.md`に実装ガイド追加
   - デザインチェックリスト作成（新規コンポーネント作成時の確認項目）
   - Figmaデザインファイルの作成（将来的な拡張）

#### 📊 期待効果

- **デザイン一貫性**: 100%達成（全パネルで統一されたビジュアル言語）
- **開発速度**: 30%向上（コンポーネント再利用による）
- **UI品質**: Jonathan Ive Design Score 95/100 → 100/100
- **保守性**: 50%向上（デザイントークンの一元管理）

#### 🔗 依存関係

- **前提**: なし（最初に実施すべきタスク）
- **後続**: 全タスク（タスク1, 2, 3, 4の基盤となる）

#### ⏱️ 推定工数

- **設計**: 1.5日
- **実装**: 2日
- **ドキュメント**: 1日
- **合計**: 4.5日

---

## 🔄 実装シーケンス

### フェーズ1: 基盤整備（Week 1）

```
タスク5: デザインシステム統一・ドキュメント整備
├── デザイントークン定義 (Day 1-2)
├── コンポーネントライブラリ整備 (Day 3-4)
└── ドキュメント更新 (Day 5)
```

### フェーズ2: P1タスク並行実施（Week 2-3）

```
タスク1: ナビゲーション改善 (Day 6-8)
├── サイドバー強化
├── パネルヘッダー統一
└── コマンドパレット拡充

タスク2: コンテキストスイッチング改善 (Day 6-10)
├── 統合実行ビュー設計
├── ビジュアルリンク強化
└── プログレスインジケーター改善

タスク4: アクセシビリティ改善 (Day 6-9)
├── フォーカスアウトライン追加
├── ARIAラベル追加
└── コントラスト比修正
```

### フェーズ3: P2タスク実施（Week 3-4）

```
タスク3: ステータス可視性改善 (Day 11-13)
├── ステータスビジュアル階層改善
├── 二次アクションのプロミネンス向上
└── Empty/Loading/Error状態の統一
```

### 総工数

| フェーズ | タスク | 工数 | 期間 |
|---------|-------|------|-----|
| フェーズ1 | タスク5 | 4.5日 | Week 1 |
| フェーズ2 | タスク1, 2, 4 | 10.5日（並行） | Week 2-3 |
| フェーズ3 | タスク3 | 2.5日 | Week 3-4 |
| **合計** | **全タスク** | **17.5日** | **3-4週間** |

---

## 📊 成功指標（KPI）

### 定量的指標

| 指標 | 現状 | 目標 | 測定方法 |
|-----|------|------|---------|
| **新規ユーザーオンボーディング時間** | 10分 | 7分 | ユーザーテスト（5名） |
| **パネル間移動速度** | 3秒 | 2.4秒 | アナリティクス測定 |
| **二次アクション利用率** | 15% | 24% | クリック率測定 |
| **キーボード操作速度** | - | +50% | タスク完了時間測定 |
| **Lighthouse アクセシビリティスコア** | 90 | 100 | Lighthouse CI |
| **Jonathan Ive Design Score** | 95 | 100 | デザインレビュー |

### 定性的指標

- [ ] ユーザー満足度調査（NPS +25以上）
- [ ] デザインレビュー承認（Jonathan Ive Design Principles準拠）
- [ ] アクセシビリティ監査合格（WCAG 2.1 AA準拠）
- [ ] 社内デザイナーレビュー承認

---

## 🎯 優先度マトリックス

```
      High Impact              Low Impact
    ┌─────────────────┬─────────────────┐
    │                 │                 │
H   │  タスク1, 2, 4  │                 │
i   │  (P1 - High)    │                 │
g   │                 │                 │
h   ├─────────────────┼─────────────────┤
    │                 │                 │
E   │  タスク5        │  タスク3        │
f   │  (基盤)         │  (P2 - Medium)  │
f   │                 │                 │
o   │                 │                 │
r   └─────────────────┴─────────────────┘
t        Low Effort          High Effort
```

---

## 🚀 次のステップ

### 即座に実行すべきアクション

1. **タスク5を最優先で開始**
   - デザイントークン定義（CSS Custom Properties）
   - `components/ui/`コンポーネントライブラリ作成

2. **フェーズ2の準備**
   - タスク1, 2, 4の詳細設計ドキュメント作成
   - 並行実施のための担当者割り当て（可能であれば）

3. **ユーザーテスト計画**
   - テストシナリオ作成（タスク完了後の検証用）
   - 5名のパワーユーザーをリクルート

### レビュー・承認

- [ ] 本提案を ProductDesignAgent（つくるん2号）にレビュー依頼
- [ ] Jonathan Ive Design Principlesとの整合性確認
- [ ] 実装チームとの合意形成

---

## 📚 参考資料

- **ISSUES/desktop-ui-ux-improvement.md** - 元Issue
- **docs/DESIGN_AUDIT_2025.md** - Jonathan Ive Design Principles
- **docs/UI_UX_DESIGN_SYSTEM.md** - 既存デザインシステム
- **miyabi-desktop/test-ux-scenario.md** - UXテストシナリオ
- **miyabi-desktop/README.md** - Miyabi Desktop概要

---

**策定者**: しきるん (CoordinatorAgent)
**レビュー依頼先**: ProductDesignAgent, ReviewAgent
**承認者**: Miyabi Team Lead
**ステータス**: 提案中 → レビュー待ち
