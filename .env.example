# ==============================================================================
# Miyabi - Environment Configuration (Rust Edition)
# ==============================================================================
# Purpose: Environment variable template for Docker and local development
# Usage: Copy this file to .env and fill in your actual values
# Version: 2.0 (Rust Edition + Docker support)
# ==============================================================================

# -----------------------------------------------------------------------------
# Required: API Keys
# -----------------------------------------------------------------------------

# GitHub Personal Access Token
# ⚠️ RECOMMENDED: Use 'gh auth login' instead of storing token in .env
# The application will automatically use 'gh auth token' if available
#
# Only use this environment variable for:
# - Docker environments
# - CI/CD environments (GitHub Actions, etc.)
# - When gh CLI is not available
#
# Scopes required: repo, workflow, write:packages, issues:write
# Generate at: https://github.com/settings/tokens
#
# GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# -----------------------------------------------------------------------------
# Repository Configuration
# -----------------------------------------------------------------------------

# GitHub Repository (owner/repo)
# Example: myorg/my-project
GITHUB_REPOSITORY=owner/repo
GITHUB_REPOSITORY_OWNER=owner

# Device Identifier (for logs and monitoring)
# Default: hostname
# Docker: set to 'mac-mini-docker' or similar
DEVICE_IDENTIFIER=MacBook Pro 16-inch

# -----------------------------------------------------------------------------
# Rust Configuration
# -----------------------------------------------------------------------------

# Rust logging level
# Options: trace, debug, info, warn, error
# Default: info
RUST_LOG=info

# Rust backtrace
# Options: 0 (disabled), 1 (enabled), full (full backtrace)
# Default: 0 (disabled in production)
RUST_BACKTRACE=0

# -----------------------------------------------------------------------------
# Docker Configuration
# -----------------------------------------------------------------------------

# Runner type (for GitHub Actions workflows)
# Options: 'ubuntu-latest', 'self-hosted', '[self-hosted, macOS, ARM64]'
# Used by RefresherAgent and other workflows
# RUNNER_TYPE=self-hosted

# Docker Compose profile
# Options: with-database, with-cache, monitoring, development
# Multiple profiles: with-database,with-cache
# COMPOSE_PROFILES=with-database,with-cache

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------

# PostgreSQL password
# ⚠️ CHANGE THIS IN PRODUCTION
POSTGRES_PASSWORD=miyabi_secure_password_change_me

# PostgreSQL connection URL (for Rust applications)
# DATABASE_URL=postgresql://miyabi:${POSTGRES_PASSWORD}@postgres:5432/miyabi

# -----------------------------------------------------------------------------
# Cache Configuration (Redis)
# -----------------------------------------------------------------------------

# Redis password
# ⚠️ CHANGE THIS IN PRODUCTION
REDIS_PASSWORD=miyabi_redis_password_change_me

# Redis connection URL (for Rust applications)
# REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# -----------------------------------------------------------------------------
# Monitoring Configuration (Prometheus + Grafana)
# -----------------------------------------------------------------------------

# Grafana admin password
# ⚠️ CHANGE THIS IN PRODUCTION
GRAFANA_PASSWORD=admin

# Prometheus retention period
# Default: 15d
# PROMETHEUS_RETENTION=15d

# -----------------------------------------------------------------------------
# Firebase Deployment (Optional)
# -----------------------------------------------------------------------------

# Firebase Projects
FIREBASE_STAGING_PROJECT=my-app-staging
FIREBASE_PROD_PROJECT=my-app-prod

# Deployment URLs
STAGING_URL=https://staging.my-app.com
PRODUCTION_URL=https://my-app.com

# -----------------------------------------------------------------------------
# Team Configuration (Optional)
# -----------------------------------------------------------------------------

# GitHub usernames for escalation
TECH_LEAD_GITHUB=techlead-username
CISO_GITHUB=ciso-username
PO_GITHUB=po-username

# -----------------------------------------------------------------------------
# Agent Configuration
# -----------------------------------------------------------------------------

# Log directory
LOG_DIRECTORY=.ai/logs

# Report directory
REPORT_DIRECTORY=.ai/parallel-reports

# Default concurrency for parallel execution
# Recommended: Number of CPU cores - 1
DEFAULT_CONCURRENCY=2

# Agent execution parameters (optional)
# AGENT_TYPE=coordinator
# ISSUE_NUMBER=123
# CONCURRENCY=3

# -----------------------------------------------------------------------------
# Worktree Configuration
# -----------------------------------------------------------------------------

# Enable Worktree-based parallel execution
# Default: true (Rust edition fully supports Worktree)
USE_WORKTREE=true

# Worktree base directory
# Default: .worktrees
WORKTREE_BASE_DIR=.worktrees

# -----------------------------------------------------------------------------
# SSH Configuration (Mac mini remote execution)
# -----------------------------------------------------------------------------

# SSH host for Docker remote execution
# Example: user@mac-mini.local
# SSH_DOCKER_HOST=user@mac-mini.local

# SSH Docker context name
# Example: mac-mini-docker
# DOCKER_CONTEXT=mac-mini-docker

# -----------------------------------------------------------------------------
# GitHub Actions (Auto-set by workflow)
# -----------------------------------------------------------------------------

# These are automatically set when running in GitHub Actions
# Do not manually set these unless testing locally

# ISSUE_NUMBER=123
# GITHUB_ACTOR=username
# GITHUB_RUN_ID=1234567890
# GITHUB_RUN_NUMBER=42

# ==============================================================================
# Docker Usage Example:
#
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Edit .env with your values:
#    vim .env
#
# 3. Run Docker Compose:
#    docker-compose up -d
#
# 4. SSH remote execution:
#    ssh user@mac-mini "cd /path/to/miyabi && docker-compose up -d"
#
# ==============================================================================

# ==============================================================================
# Local Development (without Docker):
#
# 1. Setup gh CLI authentication:
#    gh auth login
#
# 2. Run miyabi CLI:
#    cargo run --bin miyabi -- status
#
# 3. Run specific agent:
#    cargo run --bin miyabi -- agent run coordinator --issue 270
#
# ==============================================================================

# ==============================================================================
# Lark OpenAPI MCP Enhanced - Integration
# ==============================================================================
# Purpose: Feishu/Lark integration for collaboration, documents, and Bitables
# Submodule: integrations/lark-mcp
# Documentation: integrations/lark-mcp/README.md
# ==============================================================================

# -----------------------------------------------------------------------------
# Lark App Credentials (REQUIRED for Lark integration)
# -----------------------------------------------------------------------------

# Get credentials from Lark Developer Console: https://open.larksuite.com/
# LARK_APP_ID=cli_xxxxxxxxxx
# LARK_APP_SECRET=xxxxxxxxxxxxxxxx

# Lark API Domain
# LARK_DOMAIN=https://open.feishu.cn
# Alternative for international: https://open.larksuite.com

# Lark Language Preference
# LARK_LANGUAGE=en
# Options: en, zh, ja

# Lark Token Mode
# LARK_TOKEN_MODE=auto
# Options: auto, tenant, user

# -----------------------------------------------------------------------------
# MCP Server Configuration (Optional - for Claude Desktop integration)
# -----------------------------------------------------------------------------

# MCP Server Mode
# MCP_MODE=stdio
# Options: stdio (for Claude Desktop), sse (for HTTP access)

# MCP Server Port (for SSE mode only)
# MCP_PORT=3000

# Rate Limiting
# LARK_RATE_LIMIT_ENABLED=true
# LARK_RATE_LIMIT_REQUESTS_PER_MINUTE=200

# -----------------------------------------------------------------------------
# Lark Genesis AI System (Optional - AI-powered Base creation)
# -----------------------------------------------------------------------------

# Genesis Features
# LARK_GENESIS_ENABLED=true
# LARK_GENESIS_MODEL=gpt-4
# LARK_GENESIS_REQUIRE_CONFIRMATION=true

# ==============================================================================
# Lark MCP Usage Example:
#
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Edit .env with your Lark credentials:
#    vim .env
#
# 3. Configure Claude Desktop MCP:
#    See .claude/mcp-config.json for configuration example
#
# 4. Start using Lark tools in Claude:
#    - Create documents
#    - Manage bitables
#    - Send messages
#    - Create calendar events
#
# ==============================================================================
