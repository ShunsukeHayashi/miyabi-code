name: ğŸ¬ Demo Self-Hosted Runner

on:
  workflow_dispatch:
    inputs:
      message:
        description: 'Demo message'
        required: false
        default: 'Hello from Self-Hosted Runner!'

jobs:
  demo:
    name: ğŸš€ Self-Hosted Runner Demo
    runs-on: [self-hosted, macOS, arm64, rust]

    steps:
      - name: ğŸ“‹ Demo Start
        run: |
          echo "================================"
          echo "ğŸ¬ Self-Hosted Runner Demo"
          echo "================================"
          echo ""
          echo "ğŸ“… Date: $(date)"
          echo "ğŸ’» Hostname: $(hostname)"
          echo "ğŸ”§ Architecture: $(uname -m)"
          echo "ğŸ OS: $(sw_vers -productName) $(sw_vers -productVersion)"
          echo ""

      - name: ğŸ“¦ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ¦€ Check Rust Installation
        run: |
          echo "================================"
          echo "ğŸ¦€ Rust Environment"
          echo "================================"
          rustc --version
          cargo --version
          echo ""

      - name: ğŸ“Š System Information
        run: |
          echo "================================"
          echo "ğŸ“Š System Resources"
          echo "================================"
          echo "ğŸ”¢ CPU Cores: $(sysctl -n hw.ncpu)"
          echo "ğŸ’¾ Memory: $(sysctl -n hw.memsize | awk '{print $0/1024/1024/1024 " GB"}')"
          echo "ğŸ’¿ Disk Usage:"
          df -h | grep -E "^/dev" | head -3
          echo ""

      - name: ğŸ—ï¸ Quick Rust Build Test
        run: |
          echo "================================"
          echo "ğŸ—ï¸ Building a simple Rust project"
          echo "================================"
          cargo --version
          echo ""
          echo "ğŸ“¦ Running cargo check..."
          time cargo check --workspace --quiet
          echo "âœ… Build check completed!"
          echo ""

      - name: ğŸ¯ Custom Message
        run: |
          echo "================================"
          echo "ğŸ¯ Custom Message"
          echo "================================"
          echo "${{ github.event.inputs.message }}"
          echo ""

      - name: ğŸ‰ Demo Complete
        run: |
          echo "================================"
          echo "ğŸ‰ Demo Completed Successfully!"
          echo "================================"
          echo "âœ… Runner Name: ${{ runner.name }}"
          echo "âœ… Runner OS: ${{ runner.os }}"
          echo "âœ… Workflow: ${{ github.workflow }}"
          echo "âœ… Run Number: ${{ github.run_number }}"
          echo ""
          echo "ğŸš€ Self-hosted runner is working perfectly!"
