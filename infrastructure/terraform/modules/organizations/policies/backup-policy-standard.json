{
  "plans": {
    "MiyabiDailyBackup": {
      "regions": {
        "@@assign": [
          "ap-northeast-1"
        ]
      },
      "rules": {
        "DailyBackup": {
          "schedule_expression": {
            "@@assign": "cron(0 5 ? * * *)"
          },
          "start_backup_window_minutes": {
            "@@assign": "60"
          },
          "complete_backup_window_minutes": {
            "@@assign": "120"
          },
          "lifecycle": {
            "delete_after_days": {
              "@@assign": "35"
            },
            "move_to_cold_storage_after_days": {
              "@@assign": "7"
            }
          },
          "target_backup_vault_name": {
            "@@assign": "MiyabiBackupVault"
          },
          "recovery_point_tags": {
            "Environment": {
              "tag_key": {
                "@@assign": "Environment"
              },
              "tag_value": {
                "@@assign": "production"
              }
            }
          },
          "copy_actions": {
            "arn:aws:backup:ap-northeast-3:$account:backup-vault:MiyabiBackupVaultDR": {
              "target_backup_vault_arn": {
                "@@assign": "arn:aws:backup:ap-northeast-3:$account:backup-vault:MiyabiBackupVaultDR"
              },
              "lifecycle": {
                "delete_after_days": {
                  "@@assign": "90"
                }
              }
            }
          }
        }
      },
      "selections": {
        "tags": {
          "BackupEnabled": {
            "iam_role_arn": {
              "@@assign": "arn:aws:iam::$account:role/MiyabiBackupRole"
            },
            "tag_key": {
              "@@assign": "Backup"
            },
            "tag_value": {
              "@@assign": [
                "true",
                "daily"
              ]
            }
          }
        }
      },
      "advanced_backup_settings": {
        "ec2": {
          "windows_vss": {
            "@@assign": "disabled"
          }
        }
      }
    },
    "MiyabiWeeklyBackup": {
      "regions": {
        "@@assign": [
          "ap-northeast-1"
        ]
      },
      "rules": {
        "WeeklyBackup": {
          "schedule_expression": {
            "@@assign": "cron(0 5 ? * SUN *)"
          },
          "start_backup_window_minutes": {
            "@@assign": "120"
          },
          "complete_backup_window_minutes": {
            "@@assign": "180"
          },
          "lifecycle": {
            "delete_after_days": {
              "@@assign": "90"
            }
          },
          "target_backup_vault_name": {
            "@@assign": "MiyabiBackupVault"
          }
        }
      },
      "selections": {
        "tags": {
          "WeeklyBackupEnabled": {
            "iam_role_arn": {
              "@@assign": "arn:aws:iam::$account:role/MiyabiBackupRole"
            },
            "tag_key": {
              "@@assign": "Backup"
            },
            "tag_value": {
              "@@assign": [
                "weekly"
              ]
            }
          }
        }
      }
    }
  }
}
