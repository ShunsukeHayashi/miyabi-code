{
  "$schema": "https://docs.claude.com/schemas/settings.json",
  "hooks": {
    "UserPromptSubmit": [
      {
        "command": ".claude/hooks/log-commands.sh \"$PROMPT\"",
        "description": "Log user prompts to .ai/logs/ for LDD (Log-Driven Development)"
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Edit|Write",
        "command": ".claude/hooks/auto-format.sh",
        "description": "Auto-format code before editing/writing files"
      },
      {
        "matcher": "Bash",
        "command": "echo \"‚ö†Ô∏è  About to execute: $TOOL_INPUT\" >&2",
        "description": "Warn before executing bash commands"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "command": ".claude/hooks/validate-rust.sh",
        "description": "Validate Rust code after editing/writing files"
      },
      {
        "matcher": "Bash",
        "command": ".claude/hooks/agent-event.sh progress $AGENT_ID $ISSUE_NUMBER 50 \"Command executed: $TOOL_INPUT\"",
        "description": "Send agent progress event after bash execution"
      }
    ],
    "Stop": [
      {
        "command": ".claude/hooks/session-continue.sh",
        "description": "Prompt to continue or save session state"
      }
    ],
    "SessionStart": [
      {
        "command": "echo \"üöÄ Miyabi Project Session Started\" && echo \"üìç Working directory: $CLAUDE_PROJECT_DIR\" && git status --short",
        "description": "Display project status on session start"
      },
      {
        "command": ".claude/hooks/autocompact-manager.sh check",
        "description": "Display auto-compact optimization tips"
      },
      {
        "command": ".claude/hooks/session-keepalive.sh start",
        "description": "Start session keep-alive mechanism to prevent timeout"
      }
    ],
    "SessionEnd": [
      {
        "command": ".claude/hooks/session-keepalive.sh stop",
        "description": "Stop session keep-alive mechanism"
      },
      {
        "command": "echo \"üìä Session Statistics:\" && echo \"Duration: $(date)\" && git status --short",
        "description": "Display session summary on exit"
      }
    ],
    "Notification": [
      {
        "command": "echo \"üîî Notification: $NOTIFICATION_MESSAGE\"",
        "description": "Log Claude Code notifications"
      }
    ],
    "PreCompact": [
      {
        "command": "echo \"üóúÔ∏è  Context window compacting...\" && echo \"Current size: $CONTEXT_SIZE tokens\"",
        "description": "Warn before context compaction"
      }
    ]
  },
  "timeout": {
    "default": 1800000,
    "perCommand": {
      ".claude/hooks/auto-format.sh": 300000,
      ".claude/hooks/validate-typescript.sh": 600000
    },
    "mcp": {
      "connectionTimeout": 300000,
      "requestTimeout": 1800000,
      "idleTimeout": 7200000
    },
    "session": {
      "inactivityTimeout": 14400000,
      "maxSessionDuration": 28800000,
      "keepAliveInterval": 60000,
      "reconnectAttempts": 10,
      "reconnectDelay": 5000
    }
  },
  "security": {
    "blockedPaths": [
      ".env",
      ".env.local",
      ".git/",
      "*.key",
      "*.pem",
      "**/node_modules/**",
      "**/.worktrees/**"
    ],
    "allowedCommands": [
      "echo",
      "git",
      "npm",
      "cargo",
      "rustc",
      ".claude/hooks/*.sh"
    ]
  },
  "plugins": [],
  "allow": [
    "Read(/Users/shunsuke/Dev/miyabi-private/**)",
    "Write(/Users/shunsuke/Dev/miyabi-private/**)",
    "Edit(/Users/shunsuke/Dev/miyabi-private/**)",
    "Glob(/Users/shunsuke/Dev/miyabi-private/**)",
    "Grep(/Users/shunsuke/Dev/miyabi-private/**)",
    "Bash(git *)",
    "Bash(cargo *)",
    "Bash(rustc *)",
    "Bash(npm *)",
    "Bash(gh *)",
    "Bash(echo *)",
    "Bash(cat *)",
    "Bash(ls *)",
    "Bash(mkdir *)",
    "Bash(rm *)",
    "Bash(mv *)",
    "Bash(cp *)",
    "Bash(.claude/hooks/*.sh *)",
    "Task(*)",
    "SlashCommand(*)",
    "Skill(*)",
    "NotebookEdit(/Users/shunsuke/Dev/miyabi-private/**)",
    "WebFetch(*)",
    "WebSearch(*)"
  ],
  "sandbox": {
    "enabled": true,
    "autoAllowBashIfSandboxed": true
  },
  "enableAllProjectMcpServers": true,
  "mcpServers": {}
}
