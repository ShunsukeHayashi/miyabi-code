# cargo-nextest configuration
# Documentation: https://nexte.st/book/configuration.html

[store]
# Store test results for analysis
dir = "target/nextest"

[profile.default]
# Default profile for local development
retries = 0
test-threads = "num-cpus"
status-level = "pass"
final-status-level = "flaky"

[profile.ci]
# CI-optimized profile for GitHub Actions
# Maximize parallelism and provide detailed output

# Run tests in parallel (uses all available CPUs)
test-threads = "num-cpus"

# Retry flaky tests automatically (max 2 retries)
retries = 2

# Show output for failed tests immediately
failure-output = "immediate"

# Show output for tests that passed after retry
success-output = "final"

# Detailed status reporting
status-level = "retry"
final-status-level = "all"

# Slow test detection (warn if test takes > 60s)
slow-timeout = { period = "60s", terminate-after = 3 }

# Test timeout configuration
[profile.ci.junit]
# Export JUnit XML for test reporting
path = "target/nextest/ci/junit.xml"

[profile.ci.over ride]
# Override settings for specific tests
# Example: Increase timeout for integration tests
# pattern = "tests::integration::*"
# slow-timeout = { period = "120s" }

[test-groups]
# Define test groups for targeted execution
# unit = { default-filter = "test(unit)" }
# integration = { default-filter = "test(integration)" }
# e2e = { default-filter = "test(e2e)" }
