# Miyabi Backups Directory

This directory contains automated database backups for the Miyabi project.

## Quick Links

- **Quick Start**: [../docs/BACKUP_QUICKSTART.md](../docs/BACKUP_QUICKSTART.md)
- **Full Documentation**: [../docs/BACKUP_STRATEGY.md](../docs/BACKUP_STRATEGY.md)

## Directory Structure

```
backups/
├── postgres/
│   ├── daily/    # Last 7 days of daily backups
│   ├── weekly/   # Last 4 weeks of weekly backups
│   └── monthly/  # Last 6 months of monthly backups
├── sqlite/
│   ├── daily/
│   ├── weekly/
│   └── monthly/
└── README.md     # This file
```

## Backup Schedule

| Type | Frequency | Retention |
|------|-----------|-----------|
| Daily | 3:00 AM every day | 7 days |
| Weekly | 3:00 AM every Monday | 28 days |
| Monthly | 3:00 AM on 1st of month | 180 days |

## Quick Commands

```bash
# Run manual backup
../scripts/backup-all.sh

# List recent backups
ls -lht postgres/daily/ | head -5
ls -lht sqlite/daily/ | head -5

# Check total backup size
du -sh .

# Restore from backup
../scripts/restore-database.sh --help
```

## Important Notes

- **DO NOT manually delete files** from this directory
- Automatic rotation removes old backups based on retention policy
- Backups are compressed with gzip (`.gz` extension)
- Each backup includes a metadata file (`.meta` or `manifest-*.json`)

## Backup File Naming

**PostgreSQL**:
```
postgres-miyabi-YYYYMMDD-HHMMSS.sql.gz
postgres-miyabi-YYYYMMDD-HHMMSS.sql.gz.meta
```

**SQLite**:
```
sqlite-<dbname>-YYYYMMDD-HHMMSS.db.gz
manifest-YYYYMMDD-HHMMSS.json
```

## Support

For issues or questions:

1. Check [BACKUP_QUICKSTART.md](../docs/BACKUP_QUICKSTART.md)
2. Read [BACKUP_STRATEGY.md](../docs/BACKUP_STRATEGY.md)
3. Create GitHub issue: https://github.com/customer-cloud/miyabi-private/issues

---

**Generated by**: Miyabi Backup System v1.0.0
**Last Updated**: 2025-11-29
