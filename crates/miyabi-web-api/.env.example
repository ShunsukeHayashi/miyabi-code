# Miyabi Web API - Environment Configuration Template
#
# Copy this file to .env and update with your actual values
# DO NOT commit .env to version control

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================

# PostgreSQL connection URL
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://miyabi_admin:your_password@localhost:5432/miyabi

# Database Connection Pool Settings (Optional - defaults based on ENVIRONMENT)
#
# Production defaults:  max=100, min=10, acquire_timeout=30s
# Development defaults: max=20,  min=5,  acquire_timeout=10s
# Test defaults:        max=5,   min=1,  acquire_timeout=5s

# DB_MAX_CONNECTIONS=100              # Maximum number of connections in pool
# DB_MIN_CONNECTIONS=10               # Minimum number of idle connections to maintain
# DB_ACQUIRE_TIMEOUT_SECS=30          # Timeout (seconds) for acquiring connection
# DB_IDLE_TIMEOUT_SECS=600            # Max idle time (seconds) before connection closed (10 min)
# DB_MAX_LIFETIME_SECS=1800           # Max lifetime (seconds) of connection (30 min)
# DB_TEST_BEFORE_ACQUIRE=true         # Test connections before acquiring (production only)

# ==============================================================================
# SERVER CONFIGURATION
# ==============================================================================

# Server bind address
SERVER_ADDRESS=0.0.0.0:4000

# Environment (development | staging | production)
ENVIRONMENT=development

# ==============================================================================
# AUTHENTICATION CONFIGURATION
# ==============================================================================

# JWT Secret (MUST be at least 32 characters in production)
# Generate with: openssl rand -base64 32
JWT_SECRET=your_jwt_secret_min_32_characters_required_change_in_production

# JWT token expiration (seconds) - default: 3600 (1 hour)
# JWT_EXPIRATION=3600

# Refresh token expiration (seconds) - default: 604800 (7 days)
# REFRESH_EXPIRATION=604800

# ==============================================================================
# GITHUB OAUTH CONFIGURATION
# ==============================================================================

# GitHub OAuth Application credentials
# Create at: https://github.com/settings/developers
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_CALLBACK_URL=http://localhost:4000/api/v1/auth/github/callback

# GitHub Personal Access Token (for API access)
# Create at: https://github.com/settings/tokens
GITHUB_TOKEN=your_github_personal_access_token

# GitHub repository for issue creation
GITHUB_OWNER=customer-cloud
GITHUB_REPO=miyabi-private

# ==============================================================================
# FRONTEND CONFIGURATION
# ==============================================================================

# Frontend application URL (for CORS and redirects)
FRONTEND_URL=http://localhost:3000

# ==============================================================================
# TELEGRAM BOT CONFIGURATION (Optional)
# ==============================================================================

# Telegram Bot Token (from @BotFather)
# TELEGRAM_BOT_TOKEN=your_telegram_bot_token

# Authorized chat IDs (comma-separated)
# AUTHORIZED_CHAT_IDS=123456789,987654321

# ==============================================================================
# LARK CONFIGURATION (Optional)
# ==============================================================================

# Lark escalation contact
# LARK_ESCALATION_EMAIL=your.email@example.com
# LARK_ESCALATION_NAME=Your Name

# ==============================================================================
# OPENAI CONFIGURATION (Optional)
# ==============================================================================

# OpenAI API Key (for GPT-4 analysis)
# OPENAI_API_KEY=sk-your-openai-api-key

# ==============================================================================
# LOGGING CONFIGURATION
# ==============================================================================

# Rust logging level
# Levels: error, warn, info, debug, trace
# Format: global_level,crate_name=crate_level
RUST_LOG=info,miyabi_web_api=debug

# ==============================================================================
# AWS CONFIGURATION
# ==============================================================================

# AWS Region
AWS_REGION=ap-northeast-1

# AWS credentials (use IAM role in production, not access keys)
# AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
# AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# ==============================================================================
# DYNAMODB CONFIGURATION
# ==============================================================================

# DynamoDB Configuration
DYNAMODB_TIMEOUT=5             # Operation timeout in seconds (default: 5)
DYNAMODB_MAX_ATTEMPTS=3        # Max retry attempts (default: 3)
DYNAMODB_INITIAL_BACKOFF_MS=100  # Initial retry delay in ms (default: 100)
DYNAMODB_MAX_BACKOFF_SEC=20    # Maximum retry delay in seconds (default: 20)

# DynamoDB Local (for development/testing)
# Uncomment to use local DynamoDB
# docker run -p 8000:8000 amazon/dynamodb-local
# DYNAMODB_ENDPOINT=http://localhost:8000

# ==============================================================================
# NOTES
# ==============================================================================
#
# 1. Security:
#    - Never commit .env to version control
#    - Use strong, randomly generated secrets in production
#    - Rotate credentials regularly
#
# 2. Database Pool Tuning:
#    - For Lambda + RDS: Use production defaults (max=100)
#    - For local development: Use development defaults (max=20)
#    - For testing: Use test defaults (max=5)
#    - Adjust based on your database's max_connections setting
#
# 3. Environment-specific settings:
#    - Set ENVIRONMENT=production for production deployments
#    - This automatically applies optimized pool settings
#    - Override specific settings with DB_* variables if needed
#
