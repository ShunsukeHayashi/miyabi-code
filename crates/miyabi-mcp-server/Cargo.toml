[package]
name = "miyabi-mcp-server"
version = "0.1.0"
edition.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true
description = "MCP (Model Context Protocol) Server for Miyabi Agent execution"
keywords = ["mcp", "rpc", "protocol", "ai", "agents"]
categories = ["command-line-utilities", "development-tools"]

[[bin]]
name = "miyabi-mcp-server"
path = "src/main.rs"

[dependencies]
# Miyabi crates
miyabi-types = { version = "0.1.0", path = "../miyabi-types" }
miyabi-core = { version = "0.1.0", path = "../miyabi-core" }
miyabi-agents = { version = "0.1.0", path = "../miyabi-agents" }
miyabi-github = { version = "0.1.0", path = "../miyabi-github" }
miyabi-worktree = { version = "0.1.0", path = "../miyabi-worktree" }
# miyabi-business-agents REMOVED: Use miyabi-agents/business module instead
miyabi-knowledge = { version = "0.1.1", path = "../miyabi-knowledge" }

# GitHub API
octocrab = { workspace = true }

# MCP Protocol (JSON-RPC 2.0)
jsonrpc-core = "18.0"
jsonrpc-derive = "18.0"
jsonrpc-http-server = { version = "18.0", optional = true }
jsonrpc-stdio-server = "18.0"

# Async runtime
tokio = { workspace = true, features = ["full"] }
async-trait = { workspace = true }

# Serialization
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true }

# Logging
tracing = { workspace = true }
tracing-subscriber = { workspace = true, features = ["env-filter", "json"] }

# Error handling
anyhow = { workspace = true }
thiserror = { workspace = true }

# Caching
lru = "0.12"

# DateTime
chrono = { workspace = true }

# UUID
uuid = { version = "1.10", features = ["v4", "serde"] }

# CLI
clap = { version = "4", features = ["derive", "env"] }

[dev-dependencies]
tokio-test = "0.4"
tempfile = "3.8"

[features]
default = ["stdio"]
stdio = []
http = ["jsonrpc-http-server"]
all = ["stdio", "http"]
