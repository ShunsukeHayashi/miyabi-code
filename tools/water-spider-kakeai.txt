# Water Spider Orchestrator - ゆっくり解説動画台本
# 霊夢（おバカキャラ）× 魔理沙（しっかりもの）掛け合い形式

## オープニング

【霊夢】こんにちは、霊夢よ！今日はすごい話があるのよね〜

【魔理沙】おう、魔理沙だぜ！今日は「Water Spider Orchestrator」っていう、Miyabiの新しいシステムについて解説するんだ

【霊夢】Water Spider？なにそれ、クモ？虫が嫌いなんだけど〜

【魔理沙】違うぜ霊夢！これはAI開発を超高速化する、革命的なシステムなんだ！

【霊夢】へぇ〜、でも難しそう...

【魔理沙】大丈夫だぜ！順番に説明していくから、最後まで見てくれよな！

## 第1章：現状の問題点

【魔理沙】まず、今のMiyabiの問題点を説明するぜ

【霊夢】問題点？何か困ってるの？

【魔理沙】ああ、実は今のClaude Codeセッションは、1つのIssueを処理するのに15分から30分もかかるんだ

【霊夢】30分！？そんなにかかるの！？

【魔理沙】そうなんだぜ。しかも、並列実行も手動で3タスクまでしかできないんだ

【霊夢】3タスクって...少なすぎない？

【魔理沙】その通りだぜ霊夢！100個以上のIssueを処理しようとしたら、何時間もかかっちまうんだ

【霊夢】それは困るわね...

## 第2章：Water Spiderの目標

【魔理沙】だから、Water Spider Orchestratorが開発されたんだぜ！

【霊夢】お〜！で、何ができるの？

【魔理沙】目標は3つあるんだ。まず1つ目は、セッション時間を10秒以下にすること！

【霊夢】じゅ、10秒！？さっき30分って言ってたのに！？

【魔理沙】ああ、30分が10秒になるんだぜ！180倍の高速化なんだ！

【霊夢】すごすぎる！

【魔理沙】2つ目は、並列実行数を無制限にすること

【霊夢】むげんげん！？どういうこと？

【魔理沙】手動で3タスクだったのが、100個でも200個でも同時に実行できるようになるんだぜ！

【霊夢】そんなことできるの！？

【魔理沙】そして3つ目は、完全自動化だ

【霊夢】自動化？

【魔理沙】ああ、ユーザーが何もしなくても、全部自動でやってくれるんだぜ

【霊夢】え〜、それって私の仕事がなくなっちゃうんじゃ...

【魔理沙】違うぜ霊夢！自動化で単純作業がなくなって、もっと創造的な仕事に集中できるようになるんだ！

【霊夢】なるほど〜、それならいいわね！

## 第3章：アーキテクチャの全体像

【魔理沙】じゃあ、Water Spiderの仕組みを説明するぜ

【霊夢】仕組み...難しそう...

【魔理沙】大丈夫だぜ！3つの層で構成されてるんだ

【霊夢】3つ？

【魔理沙】ああ。1層目は、GitHub

【霊夢】ギットハブ？聞いたことある！

【魔理沙】そうだぜ。全てのIssueがGitHubに保存されて、GitHub Actionsがトリガーとして動くんだ

【霊夢】トリガー？

【魔理沙】スイッチみたいなもんだぜ。Issueが作られると、自動的に次の処理が始まるんだ

【霊夢】へぇ〜

【魔理沙】2層目は、Task Scheduler Service

【霊夢】た、タスク...スケジューラー...？

【魔理沙】これは独立した常駐サービスで、24時間365日動き続けるんだぜ

【霊夢】え！？ずっと動いてるの！？

【魔理沙】ああ、10秒ごとにGitHub APIをチェックして、新しいIssueを見つけたら、優先順位を計算して、Task Queueに入れるんだ

【霊夢】タスクキュー...順番待ちの列みたいなもの？

【魔理沙】その通りだぜ霊夢！よく分かったな！

【霊夢】えへへ〜

【魔理沙】そして3層目は、Self-hosted Runner

【霊夢】セルフホスティド...？

【魔理沙】自分のパソコンで動かすやつだぜ。Mac miniとかローカルマシンで動いて、ヘッドレスモードのClaude Codeを実行するんだ

【霊夢】ヘッドレス...頭がない？

【魔理沙】画面なしで動くってことだぜ。全部自動で処理してくれるんだ

【霊夢】すごい！

## 第4章：Task Scheduler Service

【魔理沙】Task Scheduler Serviceは、4つのコンポーネントで構成されてるんだぜ

【霊夢】4つ？覚えられるかな...

【魔理沙】大丈夫だぜ！1つずつ説明するから

【霊夢】お願い！

【魔理沙】1つ目は、Issue Collector

【霊夢】イシュー...コレクター？

【魔理沙】ああ、10秒ごとにGitHub APIをポーリングして、openのIssueを収集するんだぜ

【霊夢】10秒ごと！？忙しいわね〜

【魔理沙】そして、trigger:agent-executeラベルがついたIssueだけを集めるんだ

【霊夢】ラベル？

【魔理沙】タグみたいなもんだぜ。このラベルがついてると、「これは処理してね」って意味なんだ

【霊夢】なるほど〜

【魔理沙】2つ目は、Priority Calculator

【霊夢】プライオリティ...計算機？

【魔理沙】優先度を計算するやつだぜ。P0-Criticalラベルは1.0点、P1-Highは0.7点、P2-Mediumは0.4点、P3-Lowは0.1点

【霊夢】点数で決めるのね！

【魔理沙】ああ、それに推定時間、依存関係、Issue作成日を加味して、最終スコアを計算するんだぜ

【霊夢】依存関係？

【魔理沙】あるタスクを完了しないと、次のタスクができない、みたいな関係だぜ

【霊夢】お料理みたいね！野菜を切ってから炒めるみたいな

【魔理沙】いい例えだぜ霊夢！

【霊夢】えへへ〜

【魔理沙】3つ目は、Task Queue

【霊夢】タスクキュー！さっき出てきたやつね！

【魔理沙】そうだぜ。3種類のキューがあるんだ

【霊夢】3種類？

【魔理沙】Priority Queueは、すぐ実行できるタスク。Blocked Queueは、依存関係で待っているタスク。Running Queueは、今実行中のタスク

【霊夢】わかりやすい！

【魔理沙】そして4つ目は、Task Dispatcher

【霊夢】ディスパッチャー？

【魔理沙】配達員みたいなもんだぜ。Priority Queueから次のタスクを取り出して、GitHub Actionsに送るんだ

【霊夢】配達員！わかりやすい！

【魔理沙】最大5個まで並列実行できるように、Running Queueの容量をチェックするんだぜ

【霊夢】5個同時！すごいわね〜

## 第5章：1 Session = 1 Issue 原則

【魔理沙】Water Spiderには、とても重要な原則があるんだぜ

【霊夢】原則？ルールみたいなもの？

【魔理沙】ああ、「1つのセッションは、1つのIssueだけを処理する」という原則なんだ

【霊夢】1つだけ？なんで？

【魔理沙】複数のIssueを同時に処理すると、ごちゃごちゃになっちまうからだぜ

【霊夢】あ〜、お料理で複数の料理を同時に作ると混乱するのと同じね！

【魔理沙】その通りだぜ霊夢！各セッションは、専用のWorktreeを持つんだ

【霊夢】ワークツリー？

【魔理沙】作業場所だぜ。例えば、Issue #443なら、.worktrees/issue-443/というディレクトリが作られるんだ

【霊夢】専用の部屋みたいなものね！

【魔理沙】そして、feature/issue-443というブランチが作られるんだぜ

【霊夢】ブランチ？木の枝？

【魔理沙】Gitの枝分かれだぜ。これによって、セッション間で干渉することがなくなるんだ

【霊夢】それぞれの部屋で作業するから、ぶつからないってことね！

【魔理沙】完璧だぜ霊夢！

## 第6章：ヘッドレスモード実行

【霊夢】さっき出てきた、ヘッドレスモードって何？

【魔理沙】いい質問だぜ！ヘッドレスモードというのは、UIなしで、コマンドラインだけで実行するモードなんだ

【霊夢】UI？ユーザーインターフェース？

【魔理沙】ああ、画面のことだぜ。画面を見ないで、全部自動で動くんだ

【霊夢】すごい！人間がいなくても動くの？

【魔理沙】そうなんだぜ。実行コマンドは、こんな感じなんだ

【霊夢】コマンド？

【魔理沙】指示だぜ。claude code --headless --execute-command "/agent-run --issue 443" --cwd .worktrees/issue-443 --no-human-in-loop

【霊夢】なが〜い！覚えられない！

【魔理沙】覚えなくていいぜ霊夢！重要なのは、--no-human-in-loopオプションなんだ

【霊夢】ノーヒューマンインザループ？人間がいないループ？

【魔理沙】ああ、これによって、Claude Codeは質問や確認を一切しなくなるんだぜ

【霊夢】え、質問しないの？困ったらどうするの？

【魔理沙】それが次の話だぜ

## 第7章：ログベースコミュニケーション

【魔理沙】ヘッドレスモードでは、人間に質問できないんだ

【霊夢】じゃあどうするの？

【魔理沙】全ての進捗は、Issueコメントに記録されるんだぜ

【霊夢】コメント？メモみたいなもの？

【魔理沙】ああ、進捗報告は、こんな感じで記録されるんだ

【霊夢】どんな感じ？

【魔理沙】Phase 1/4: Issue分析・DAG構築 完了。Issue本文パース完了。依存関係解析完了。DAG構築完了

【霊夢】なるほど〜、日記みたいに書いていくのね！

【魔理沙】そうだぜ。そして、エラーが起きたら、アットマークメンションで人間に通知するんだ

【霊夢】アットマーク...SNSでよく見るやつ！

【魔理沙】ああ、例えば、「@username Issue #448の完了が必要です」みたいな感じだぜ

【霊夢】それなら、困った時だけ人間に聞けるわね！

【魔理沙】その通りだぜ！

## 第8章：実装計画

【霊夢】ねぇねぇ、このWater Spider、いつできるの？

【魔理沙】実は、6つのフェーズで実装されるんだぜ

【霊夢】6つ！？

【魔理沙】ああ。Phase 0は、設計完了！今日完了したんだぜ！

【霊夢】今日！？すごい！

【魔理沙】Phase 1は、基盤構築。Issue #443、#448、#449、#450を完了して、CI/CDパイプラインを構築するんだ。期間は1日だぜ

【霊夢】1日！早いわね〜

【魔理沙】Phase 2は、ヘッドレス実装。Session Manager、Headless Launcher、Result Parserを実装するんだ。期間は2日

【霊夢】2日...

【魔理沙】Phase 3は、DAGスケジューラ。DAG Builder、Dependency Resolver、Schedulerを実装するんだぜ。期間は3日

【霊夢】3日か〜

【魔理沙】Phase 4は、リモート実行。Remote Executor、Load Balancerを実装して、複数マシンで分散実行できるようにするんだ

【霊夢】複数のパソコンで動かすの！？

【魔理沙】ああ、Mac mini LANも活用するんだぜ。期間は2日

【霊夢】Mac miniって、小さいパソコン？

【魔理沙】そうだぜ。小さいけどパワフルなんだ

【霊夢】へぇ〜

【魔理沙】Phase 5は、Milestone統合。Result Aggregator、Milestone Integrator、Notification Systemを実装するんだぜ。期間は2日

【霊夢】マイルストーン...？

【魔理沙】目標地点だぜ。複数のIssueをまとめて管理するんだ

【霊夢】なるほど〜

【魔理沙】そしてPhase 6は、本番運用開始！100個以上のIssueを同時処理できるようになるんだぜ！

【霊夢】100個！？すごすぎる！

## 第9章：期待される効果

【魔理沙】Water Spiderが完成すると、すごいことが起きるんだぜ

【霊夢】どんなこと？

【魔理沙】セッション時間は、30分から10秒になる

【霊夢】じゅ、10秒！？

【魔理沙】ああ、180倍の高速化なんだぜ！

【霊夢】180倍！？計算したの？すごい！

【魔理沙】そして、並列実行数は、3タスクから無制限になる

【霊夢】無限...！

【魔理沙】100個でも200個でも、同時に実行できるんだぜ

【霊夢】夢みたい！

【魔理沙】依存関係は、手動から完全自動になる

【霊夢】もう、ユーザーが依存関係を考える必要はないのね！

【魔理沙】その通りだぜ！

【霊夢】すごいわね〜

【魔理沙】完了検知も、手動確認から自動通知になるんだ

【霊夢】自動通知？

【魔理沙】Discord、Slackに自動で通知が飛ぶんだぜ

【霊夢】便利〜！

【魔理沙】そして、統合時間も、手動PR作成から自動Milestone統合になる

【霊夢】全部自動なのね！

【魔理沙】ああ、全部自動だぜ！

## エンディング

【霊夢】Water Spider Orchestrator、すごかったわね〜

【魔理沙】ああ、Miyabiを次のレベルに引き上げる、革命的なシステムなんだぜ

【霊夢】セッション時間が10秒になって、100個以上のIssueを同時に処理できて...

【魔理沙】そして、ユーザーは何もしなくても、全てが自動で完了するんだぜ

【霊夢】すごすぎる！

【魔理沙】Phase 1の実装が楽しみだな！

【霊夢】うん！楽しみ！

【魔理沙】みんなも、Water Spiderの完成を楽しみに待っていてくれよな！

【霊夢】それじゃあ、またね〜！

【魔理沙】次回も見てくれよな！それじゃあまただぜ！
